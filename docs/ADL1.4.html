<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.21">
<meta name="description" content="openEHR Archetype Definition Language 1.4 (ADL1.4) (ISO 13606-2:2008)">
<meta name="keywords" content="EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr">
<title>Archetype Definition Language 1.4 (ADL1.4)</title>
<link rel="stylesheet" href="https://specifications.openehr.org/styles/openehr.css">
<link rel="stylesheet" href="https://specifications.openehr.org/styles/pygments-default.css">
</head>
<body class="book toc2 toc-left">
<div id="header">
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_archetype_definition_language_1_4_adl1_4">Archetype Definition Language 1.4 (ADL1.4)</a>
<ul class="sectlevel1">
<li><a href="#_amendment_record">Amendment Record</a></li>
<li><a href="#_acknowledgements">Acknowledgements</a>
<ul class="sectlevel2">
<li><a href="#_primary_author">Primary Author</a></li>
<li><a href="#_contributors">Contributors</a></li>
<li><a href="#_trademarks">Trademarks</a></li>
<li><a href="#_supporters">Supporters</a></li>
</ul>
</li>
<li><a href="#_preface">1. Preface</a>
<ul class="sectlevel2">
<li><a href="#_purpose">1.1. Purpose</a></li>
<li><a href="#_related_documents">1.2. Related Documents</a></li>
<li><a href="#_nomenclature">1.3. Nomenclature</a></li>
<li><a href="#_status">1.4. Status</a></li>
<li><a href="#_feedback">1.5. Feedback</a></li>
<li><a href="#_conformance">1.6. Conformance</a></li>
<li><a href="#_tools">1.7. Tools</a></li>
</ul>
</li>
<li><a href="#_overview">2. Overview</a>
<ul class="sectlevel2">
<li><a href="#_what_is_adl">2.1. What is ADL?</a>
<ul class="sectlevel3">
<li><a href="#_structure">2.1.1. Structure</a></li>
<li><a href="#_an_example">2.1.2. An Example</a></li>
<li><a href="#_semantics">2.1.3. Semantics</a></li>
</ul>
</li>
<li><a href="#_computational_context">2.2. Computational Context</a></li>
<li><a href="#_xml_form_of_archetypes">2.3. XML form of Archetypes</a></li>
<li><a href="#_changes_from_previous_versions">2.4. Changes from Previous Versions</a>
<ul class="sectlevel3">
<li><a href="#_version_1_4_from_version_1_3">2.4.1. Version 1.4 from Version 1.3</a>
<ul class="sectlevel4">
<li><a href="#_iso_8601_datetime_conformance">2.4.1.1. ISO 8601 Date/Time Conformance</a></li>
<li><a href="#_non_inclusive_two_sided_intervals">2.4.1.2. Non-inclusive Two-sided Intervals</a></li>
<li><a href="#_occurrences_for_use_node_references">2.4.1.3. Occurrences for 'use_node' References</a></li>
<li><a href="#_quoting_rules">2.4.1.4. Quoting Rules</a></li>
</ul>
</li>
<li><a href="#_version_1_3_from_version_1_2">2.4.2. Version 1.3 from Version 1.2</a>
<ul class="sectlevel4">
<li><a href="#_query_syntax_replaced_by_uri_data_type">2.4.2.1. Query syntax replaced by URI data type</a></li>
<li><a href="#_top_level_invariant_section">2.4.2.2. Top-level Invariant Section</a></li>
</ul>
</li>
<li><a href="#_version_1_2_from_version_1_1">2.4.3. Version 1.2 from Version 1.1</a>
<ul class="sectlevel4">
<li><a href="#_adl_version">2.4.3.1. ADL Version</a></li>
<li><a href="#_dadl_syntax_changes">2.4.3.2. dADL Syntax Changes</a></li>
<li><a href="#_revision_history_section">2.4.3.3. Revision History Section</a></li>
<li><a href="#_primary_language_and_languages_available_sections">2.4.3.4. Primary_language and Languages_available Sections</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_file_encoding_and_character_quoting">3. File Encoding and Character Quoting</a>
<ul class="sectlevel2">
<li><a href="#_file_encoding">3.1. File Encoding</a></li>
<li><a href="#_special_character_sequences">3.2. Special Character Sequences</a></li>
</ul>
</li>
<li><a href="#_dadl_data_adl">4. dADL - Data ADL</a>
<ul class="sectlevel2">
<li><a href="#_overview_2">4.1. Overview</a></li>
<li><a href="#_basics">4.2. Basics</a>
<ul class="sectlevel3">
<li><a href="#_scope_of_a_dadl_document">4.2.1. Scope of a dADL Document</a></li>
<li><a href="#_keywords">4.2.2. Keywords</a></li>
<li><a href="#_reserved_characters">4.2.3. Reserved Characters</a></li>
<li><a href="#_comments">4.2.4. Comments</a></li>
<li><a href="#_information_model_identifiers">4.2.5. Information Model Identifiers</a></li>
<li><a href="#_semi_colons">4.2.6. Semi-colons</a></li>
</ul>
</li>
<li><a href="#_paths">4.3. Paths</a></li>
<li><a href="#_structure_2">4.4. Structure</a>
<ul class="sectlevel3">
<li><a href="#_general_form">4.4.1. General Form</a>
<ul class="sectlevel4">
<li><a href="#_outer_delimiters">4.4.1.1. Outer Delimiters</a></li>
<li><a href="#_paths_2">4.4.1.2. Paths</a></li>
</ul>
</li>
<li><a href="#_empty_sections">4.4.2. Empty Sections</a></li>
<li><a href="#_container_objects">4.4.3. Container Objects</a>
<ul class="sectlevel4">
<li><a href="#_paths_3">4.4.3.1. Paths</a></li>
</ul>
</li>
<li><a href="#_nested_container_objects">4.4.4. Nested Container Objects</a>
<ul class="sectlevel4">
<li><a href="#_paths_4">4.4.4.1. Paths</a></li>
</ul>
</li>
<li><a href="#_adding_type_information">4.4.5. Adding Type Information</a></li>
<li><a href="#_associations_and_shared_objects">4.4.6. Associations and Shared Objects</a>
<ul class="sectlevel4">
<li><a href="#_paths_5">4.4.6.1. Paths</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_leaf_data_built_in_types">4.5. Leaf Data - Built-in Types</a>
<ul class="sectlevel3">
<li><a href="#_primitive_types">4.5.1. Primitive Types</a>
<ul class="sectlevel4">
<li><a href="#_character_data">4.5.1.1. Character Data</a></li>
<li><a href="#_string_data">4.5.1.2. String Data</a></li>
<li><a href="#_integer_data">4.5.1.3. Integer Data</a></li>
<li><a href="#_real_data">4.5.1.4. Real Data</a></li>
<li><a href="#_boolean_data">4.5.1.5. Boolean Data</a></li>
<li><a href="#_dates_and_times">4.5.1.6. Dates and Times</a></li>
</ul>
</li>
<li><a href="#_intervals_of_ordered_primitive_types">4.5.2. Intervals of Ordered Primitive Types</a></li>
<li><a href="#_other_built_in_types">4.5.3. Other Built-in Types</a>
<ul class="sectlevel4">
<li><a href="#_uris">4.5.3.1. URIs</a></li>
<li><a href="#_coded_terms">4.5.3.2. Coded Terms</a></li>
</ul>
</li>
<li><a href="#_lists_of_built_in_types">4.5.4. Lists of Built-in Types</a></li>
</ul>
</li>
<li><a href="#_plug_in_syntaxes">4.6. Plug-in Syntaxes</a></li>
<li><a href="#_expression_of_dadl_in_xml">4.7. Expression of dADL in XML</a>
<ul class="sectlevel3">
<li><a href="#_single_attributes">4.7.1. Single Attributes</a></li>
<li><a href="#_container_attributes">4.7.2. Container Attributes</a></li>
<li><a href="#_nested_container_attributes">4.7.3. Nested Container Attributes</a></li>
<li><a href="#_type_names">4.7.4. Type Names</a></li>
</ul>
</li>
<li><a href="#_syntax_specification">4.8. Syntax Specification</a>
<ul class="sectlevel3">
<li><a href="#_grammar">4.8.1. Grammar</a></li>
<li><a href="#_symbols">4.8.2. Symbols</a></li>
</ul>
</li>
<li><a href="#_syntax_alternatives">4.9. Syntax Alternatives</a>
<ul class="sectlevel3">
<li><a href="#_container_attributes_2">4.9.1. Container Attributes</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_cadl_constraint_adl">5. cADL - Constraint ADL</a>
<ul class="sectlevel2">
<li><a href="#_overview_3">5.1. Overview</a></li>
<li><a href="#_basics_2">5.2. Basics</a>
<ul class="sectlevel3">
<li><a href="#_keywords_2">5.2.1. Keywords</a></li>
<li><a href="#_comments_2">5.2.2. Comments</a>
<ul class="sectlevel4">
<li><a href="#_information_model_identifiers_2">5.2.2.1. Information Model Identifiers</a></li>
</ul>
</li>
<li><a href="#_node_identifiers">5.2.3. Node Identifiers</a></li>
<li><a href="#_natural_language">5.2.4. Natural Language</a></li>
</ul>
</li>
<li><a href="#_structure_3">5.3. Structure</a>
<ul class="sectlevel3">
<li><a href="#_complex_objects">5.3.1. Complex Objects</a></li>
<li><a href="#_attribute_constraints">5.3.2. Attribute Constraints</a>
<ul class="sectlevel4">
<li><a href="#_existence">5.3.2.1. Existence</a></li>
</ul>
</li>
<li><a href="#_single_valued_attributes">5.3.3. Single-valued Attributes</a></li>
<li><a href="#_container_attributes_3">5.3.4. Container Attributes</a>
<ul class="sectlevel4">
<li><a href="#_cardinality">5.3.4.1. Cardinality</a></li>
<li><a href="#_occurrences">5.3.4.2. Occurrences</a></li>
</ul>
</li>
<li><a href="#_any_constraints">5.3.5. "Any" Constraints</a></li>
<li><a href="#_object_node_identification_and_paths">5.3.6. Object Node Identification and Paths</a></li>
<li><a href="#_internal_references">5.3.7. Internal References</a></li>
<li><a href="#_archetype_slots">5.3.8. Archetype Slots</a>
<ul class="sectlevel4">
<li><a href="#_defining_slots_on_the_basis_of_archetype_identifiers_and_concepts">5.3.8.1. Defining Slots on the basis of Archetype Identifiers and Concepts</a></li>
<li><a href="#_using_other_constraints_in_slots">5.3.8.2. Using Other Constraints in Slots</a></li>
</ul>
</li>
<li><a href="#_placeholder_constraints">5.3.9. Placeholder Constraints</a></li>
<li><a href="#_mixed_structures">5.3.10. Mixed Structures</a></li>
</ul>
</li>
<li><a href="#_constraints_on_primitive_types">5.4. Constraints on Primitive Types</a>
<ul class="sectlevel3">
<li><a href="#_constraints_on_string">5.4.1. Constraints on String</a>
<ul class="sectlevel4">
<li><a href="#_list_of_strings">5.4.1.1. List of Strings</a></li>
<li><a href="#_regular_expression">5.4.1.2. Regular Expression</a></li>
</ul>
</li>
<li><a href="#_constraints_on_integer">5.4.2. Constraints on Integer</a>
<ul class="sectlevel4">
<li><a href="#_list_of_integers">5.4.2.1. List of Integers</a></li>
<li><a href="#_interval_of_integer">5.4.2.2. Interval of Integer</a></li>
</ul>
</li>
<li><a href="#_constraints_on_real">5.4.3. Constraints on Real</a></li>
<li><a href="#_constraints_on_boolean">5.4.4. Constraints on Boolean</a></li>
<li><a href="#_constraints_on_character">5.4.5. Constraints on Character</a>
<ul class="sectlevel4">
<li><a href="#_list_of_characters">5.4.5.1. List of Characters</a></li>
<li><a href="#_regular_expression_2">5.4.5.2. Regular Expression</a></li>
</ul>
</li>
<li><a href="#_constraints_on_dates_times_and_durations">5.4.6. Constraints on Dates, Times and Durations</a>
<ul class="sectlevel4">
<li><a href="#date_time_constraint_patterns">5.4.6.1. Date, Time and Date/Time</a></li>
<li><a href="#_duration_constraints">5.4.6.2. Duration Constraints</a></li>
</ul>
</li>
<li><a href="#_constraints_on_lists_of_primitive_types">5.4.7. Constraints on Lists of Primitive types</a></li>
<li><a href="#_assumed_values">5.4.8. Assumed Values</a></li>
</ul>
</li>
<li><a href="#_syntax_specification_2">5.5. Syntax Specification</a>
<ul class="sectlevel3">
<li><a href="#_grammar_2">5.5.1. Grammar</a></li>
<li><a href="#_symbols_2">5.5.2. Symbols</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_assertions">6. Assertions</a>
<ul class="sectlevel2">
<li><a href="#_overview_4">6.1. Overview</a></li>
<li><a href="#_keywords_3">6.2. Keywords</a></li>
<li><a href="#_operators">6.3. Operators</a>
<ul class="sectlevel3">
<li><a href="#_arithmetic_operators">6.3.1. Arithmetic Operators</a></li>
<li><a href="#_equality_operators">6.3.2. Equality Operators</a></li>
<li><a href="#_relational_operators">6.3.3. Relational Operators</a></li>
<li><a href="#_boolean_operators">6.3.4. Boolean Operators</a></li>
<li><a href="#_quantifiers">6.3.5. Quantifiers</a></li>
</ul>
</li>
<li><a href="#_operands">6.4. Operands</a></li>
<li><a href="#_precedence_and_parentheses">6.5. Precedence and Parentheses</a></li>
<li><a href="#_future">6.6. Future</a>
<ul class="sectlevel3">
<li><a href="#_variables">6.6.1. Variables</a>
<ul class="sectlevel4">
<li><a href="#_predefined_variables">6.6.1.1. Predefined Variables</a></li>
<li><a href="#_archetype_defined_variables">6.6.1.2. Archetype-defined Variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_syntax_specification_3">6.7. Syntax Specification</a>
<ul class="sectlevel3">
<li><a href="#_grammar_3">6.7.1. Grammar</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_adl_paths">7. ADL Paths</a>
<ul class="sectlevel2">
<li><a href="#_overview_5">7.1. Overview</a></li>
<li><a href="#_relationship_with_w3c_xpath">7.2. Relationship with W3C Xpath</a></li>
<li><a href="#_syntax_specification_4">7.3. Syntax Specification</a>
<ul class="sectlevel3">
<li><a href="#_grammar_4">7.3.1. Grammar</a></li>
<li><a href="#_symbols_3">7.3.2. Symbols</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_adl_archetype_definition_language">8. ADL - Archetype Definition Language</a>
<ul class="sectlevel2">
<li><a href="#_introduction">8.1. Introduction</a></li>
<li><a href="#_basics_3">8.2. Basics</a>
<ul class="sectlevel3">
<li><a href="#_keywords_4">8.2.1. Keywords</a></li>
<li><a href="#_node_identification">8.2.2. Node Identification</a></li>
<li><a href="#_local_constraint_codes">8.2.3. Local Constraint Codes</a></li>
</ul>
</li>
<li><a href="#_header_sections">8.3. Header Sections</a>
<ul class="sectlevel3">
<li><a href="#_archetype_section">8.3.1. Archetype Section</a></li>
<li><a href="#_controlled_indicator">8.3.2. Controlled Indicator</a></li>
<li><a href="#_specialise_section">8.3.3. Specialise Section</a></li>
<li><a href="#_concept_section">8.3.4. Concept Section</a></li>
<li><a href="#_language_section_and_language_translation">8.3.5. Language Section and Language Translation</a></li>
<li><a href="#_description_section">8.3.6. Description Section</a>
<ul class="sectlevel4">
<li><a href="#_extending_meta_data">8.3.6.1. Extending meta-data</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_definition_section">8.4. Definition Section</a>
<ul class="sectlevel3">
<li><a href="#_design_time_and_run_time_paths">8.4.1. Design-time and Run-time paths</a></li>
</ul>
</li>
<li><a href="#_invariant_section">8.5. Invariant Section</a></li>
<li><a href="#_ontology_section">8.6. Ontology Section</a>
<ul class="sectlevel3">
<li><a href="#_overview_6">8.6.1. Overview</a></li>
<li><a href="#_ontology_header_statements">8.6.2. Ontology Header Statements</a></li>
<li><a href="#_term_definitions_section">8.6.3. Term_definitions Section</a></li>
<li><a href="#_constraint_definitions_section">8.6.4. Constraint_definitions Section</a></li>
<li><a href="#_term_bindings_section">8.6.5. Term_bindings Section</a>
<ul class="sectlevel4">
<li><a href="#_global_term_bindings">8.6.5.1. Global Term Bindings</a></li>
<li><a href="#_path_based_bindings">8.6.5.2. Path-based Bindings</a></li>
</ul>
</li>
<li><a href="#_constraint_bindings_section">8.6.6. Constraint_bindings Section</a></li>
</ul>
</li>
<li><a href="#_revision_history_section_2">8.7. Revision History Section</a></li>
<li><a href="#_validity_rules">8.8. Validity Rules</a>
<ul class="sectlevel3">
<li><a href="#_global_archetype_validity">8.8.1. Global Archetype Validity</a></li>
<li><a href="#_coded_term_validity">8.8.2. Coded Term Validity</a></li>
<li><a href="#_definition_section_2">8.8.3. Definition Section</a></li>
</ul>
</li>
<li><a href="#_syntax_specification_5">8.9. Syntax Specification</a>
<ul class="sectlevel3">
<li><a href="#_grammar_5">8.9.1. Grammar</a></li>
<li><a href="#_symbols_4">8.9.2. Symbols</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_customising_adl">9. Customising ADL</a>
<ul class="sectlevel2">
<li><a href="#_introduction_2">9.1. Introduction</a>
<ul class="sectlevel3">
<li><a href="#_custom_syntax">9.1.1. Custom Syntax</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_relationship_of_adl_to_other_formalisms">Appendix A: Relationship of ADL to Other Formalisms</a>
<ul class="sectlevel2">
<li><a href="#_overview_7">A.1. Overview</a></li>
<li><a href="#_constraint_syntaxes">A.2. Constraint Syntaxes</a>
<ul class="sectlevel3">
<li><a href="#_omg_ocl_object_constraint_language">A.2.1. OMG OCL (Object Constraint Language)</a></li>
</ul>
</li>
<li><a href="#_ontology_formalisms">A.3. Ontology Formalisms</a>
<ul class="sectlevel3">
<li><a href="#_owl_web_ontology_language">A.3.1. OWL (Web Ontology Language)</a></li>
<li><a href="#_kif_knowledge_interchange_format">A.3.2. KIF (Knowledge Interchange Format)</a></li>
</ul>
</li>
<li><a href="#_xml_based_formalisms">A.4. XML-based Formalisms</a>
<ul class="sectlevel3">
<li><a href="#_xml_schema">A.4.1. XML-schema</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_extended_meta_data_guide">Appendix B: Extended Meta-data Guide</a>
<ul class="sectlevel2">
<li><a href="#_standardised_items">B.1. Standardised Items</a></li>
<li><a href="#_other_items">B.2. Other Items</a></li>
</ul>
</li>
<li><a href="#_syntax_specification_6">Appendix C: Syntax Specification</a>
<ul class="sectlevel2">
<li><a href="#_adl_outer_syntax">C.1. ADL Outer Syntax</a></li>
<li><a href="#_cadl_syntax">C.2. cADL Syntax</a></li>
<li><a href="#_cadl_primitives_syntax">C.3. cADL Primitives Syntax</a></li>
<li><a href="#_rules_syntax">C.4. Rules Syntax</a></li>
<li><a href="#_odin_structures">C.5. ODIN structures</a></li>
<li><a href="#_odin_value_types">C.6. ODIN value types</a></li>
<li><a href="#_base_lexer">C.7. Base Lexer</a></li>
</ul>
</li>
<li><a href="#_references">References</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="imageblock text-center">
<div class="content">
<img src="https://specifications.openehr.org/images/openEHR_logo_RGB.svg" alt="openEHR logo">
</div>
</div>
</div>
</div>
<h1 id="_archetype_definition_language_1_4_adl1_4" class="sect0"><a class="anchor" href="#_archetype_definition_language_1_4_adl1_4"></a>Archetype Definition Language 1.4 (ADL1.4)</h1>
<div class="openblock partintro">
<div class="content">
<table class="tableblock frame-all grid-all fit-content spread">
<colgroup>
<col>
<col>
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2"><strong>Issuer</strong>: <a href="https://www.openehr.org/programs/specification" target="_blank" rel="noopener">openEHR Specification Program</a></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Release</strong>: AM latest</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Status</strong>: STABLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Revision</strong>: <a href="#latest_issue">[latest_issue]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Date</strong>: <a href="#latest_issue_date">[latest_issue_date]</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><strong>Keywords</strong>: EHR, ADL, AOM, health records, archetypes, constraint language, ISO 13606, openehr</p></td>
</tr>
</tbody>
</table>
<div class="imageblock text-center">
<div class="content">
<object type="image/svg+xml" data="openehr_block_diagram.svg" width="60%"><span class="alt">openEHR components</span></object>
</div>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="2">&#169; 2003 - 2024 The openEHR Foundation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-center valign-top" colspan="2"><p class="tableblock"><a href="https://www.openehr.org" target="_blank" rel="noopener">The openEHR Foundation</a> is an independent, non-profit foundation, facilitating the sharing of health records by consumers and clinicians via open specifications, clinical models and open platform implementations.</p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Licence</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><span class="image"><img src="https://specifications.openehr.org/images/cc-by-nd-88x31.png" alt="image"></span> Creative Commons Attribution-NoDerivs 3.0 Unported. <a href="https://creativecommons.org/licenses/by-nd/3.0/" class="bare">https://creativecommons.org/licenses/by-nd/3.0/</a></p></td>
</tr>
<tr>
<td class="tableblock halign-center valign-top"><p class="tableblock"><strong>Support</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Issues: <a href="https://specifications.openehr.org/components/AM/open_issues" target="_blank" rel="noopener">Problem Reports</a><br>
 Web: <a href="https://specifications.openehr.org" target="_blank" rel="noopener">specifications.openEHR.org</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_amendment_record"><a class="anchor" href="#_amendment_record"></a>Amendment Record</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 9.0909%;">
<col style="width: 54.5454%;">
<col style="width: 18.1818%;">
<col style="width: 18.1819%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Issue</th>
<th class="tableblock halign-left valign-top">Details</th>
<th class="tableblock halign-left valign-top">Raiser, Implementer</th>
<th class="tableblock halign-left valign-top">Completed</th>
</tr>
</thead>
<tbody>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.3.?</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue"></a>1.4.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-84" target="_blank" rel="noopener">SPECAM-84</a>. Fix typos in AOM, ADL 1.4.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R Kavanagh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a id="latest_issue_date"></a>03 Apr 2023</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-75" target="_blank" rel="noopener">SPECAM-75</a>. Improve specification of constraint patterns (addresses problem <a href="https://specifications.openehr.org/tickets/SPECPR-374" target="_blank" rel="noopener">SPECPR-374</a>). Modified <a href="#date_time_constraint_patterns">Section 5.4.6.1</a> to include timezone constraints.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Pazos,<br>
T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">20 Dec 2022</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.4</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-69" target="_blank" rel="noopener">SPECAM-69</a>. Support negative durations (see also <a href="https://specifications.openehr.org/tickets/SPECRM-96" target="_blank" rel="noopener">SPECRM-96</a>); add examples in <a href="#_duration_constraints">Section 5.4.6.2</a>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Bos,<br>
 S Garde</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2020</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.3</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECPUB-7" target="_blank" rel="noopener">SPECPUB-7</a>: Convert citations to bibtex form.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Dec 2019</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.2.0</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.1.0</strong></p></th>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>AM Release 2.0.6</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPECAM-24" target="_blank" rel="noopener">SPECAM-24</a>: Standardise structure for recording governance meta-data in 1.4 archetypes.<br>
 Added appendix describing extension meta-data.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Garde,<br>
 H Leslie,<br>
 I McNicoll,<br>
 S Ljosland Bakke,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">22 May 2016</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.2</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-268" target="_blank" rel="noopener">SPEC-268</a>: Correct missing parentheses in dADL type identifiers. dADL grammar and cADL scanner rules updated.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">R Chen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">12 Dec 2008</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-284" target="_blank" rel="noopener">SPEC-284</a>: Correct inconsistencies in naming of <code>term_definitions</code>, <code>constraint_definitions</code>, <code>term_bindings</code>, <code>constraint_bindings</code> attributes in XML-schema and specifications.<br>
 Improved explanatory text for composite identifiers, including statement on case-sensitivity. Warning on <code>.v1draft</code> non-conformance</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Torrisi</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-260" target="_blank" rel="noopener">SPEC-260</a>: Correct the regex published for the ARCHETYPE_ID type. Update ADL grammar <code>ARCHEYTPE_ID</code> definition.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P Gummer,<br>
 J Arnett,<br>
 E Browne</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0.1</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.4.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-203" target="_blank" rel="noopener">SPEC-203</a>: Release 1.0 explanatory text improvements. Improve Archetype slot explanation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">13 Mar 2007</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-208" target="_blank" rel="noopener">SPEC-208</a>: Improve ADL grammar for assertion expressions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-160" target="_blank" rel="noopener">SPEC-160</a>: Duration constraints. Added ISO 8601 patterns for duration in cADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-213" target="_blank" rel="noopener">SPEC-213</a>: Correct ADL grammar for date/times to be properly ISO8601-compliant. Include 'T' in cADL patterns and dADL and cADL Date/time, Time and Duration values.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-216" target="_blank" rel="noopener">SPEC-216</a>: Allow mixture of W, D etc in ISO8601 Duration (deviation from standard).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-200" target="_blank" rel="noopener">SPEC-200</a>: Correct Release 1.0 typographical errors.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Patterson<br>
 R Chen<br>
 S Garde<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-225" target="_blank" rel="noopener">SPEC-225</a>: Allow generic type names in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">M Forss</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-226" target="_blank" rel="noopener">SPEC-226</a>: Rename <code>C_CODED_TEXT</code> to <code>C_CODE_PHRASE</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-233" target="_blank" rel="noopener">SPEC-233</a>: Define semantics for <code>occurrences</code> on <code>ARCHETYPE_INTERNAL_REF</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K Atalag</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-241" target="_blank" rel="noopener">SPEC-241</a>: Correct cADL grammar for archeype slot match expressions</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-223" target="_blank" rel="noopener">SPEC-223</a>: Clarify quoting rules in ADL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Patterson</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-242" target="_blank" rel="noopener">SPEC-242</a>: Allow non-inclusive two-sided ranges in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-245" target="_blank" rel="noopener">SPEC-245</a>: Allow term bindings to paths in archetypes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 1.0</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-136" target="_blank" rel="noopener">SPEC-136</a>. Add validity rules to ADL document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Jan 2006</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-171" target="_blank" rel="noopener">SPEC-171</a>. Add validity check for cardinality &amp; occurrences</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Maldondo</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.3.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-141" target="_blank" rel="noopener">SPEC-141</a>. Allow point intervals in ADL. Updated atomic types part of cADL section and dADL grammar section.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">18 Jun 2005</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-142" target="_blank" rel="noopener">SPEC-142</a>. Update dADL grammar to support assumed values.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-143" target="_blank" rel="noopener">SPEC-143</a>. Add partial date/time values to dADL syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-149" target="_blank" rel="noopener">SPEC-149</a>. Add URIs to dADL and remove query() syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-153" target="_blank" rel="noopener">SPEC-153</a>. Synchronise ADL and AOM for language attributes<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-156" target="_blank" rel="noopener">SPEC-156</a>. Update documentation of container types.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-138" target="_blank" rel="noopener">SPEC-138</a>. Archetype-level assertions.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 0.95</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-125" target="_blank" rel="noopener">SPEC-125</a>. <code>C_QUANTITY</code> example in ADL manual uses old dADL syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-115" target="_blank" rel="noopener">SPEC-115</a>. Correct "/[xxx]" path grammar error in ADL.<br>
 Create new section describing ADL path syntax.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-127" target="_blank" rel="noopener">SPEC-127</a>. Restructure archetype specifications. Remove clinical constraint types section of document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">11 Feb 2005</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-110" target="_blank" rel="noopener">SPEC-110</a>. Update ADL document and create AOM document.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 Nov 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added explanatory material; added domain type support; rewrote of most dADL sections. Added section on assumed values, "controlled" flag, nested container structures. Change language handling.<br>
 Rewrote OWL section based on input from: University of Manchester, UK; University Seville, Spain.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Rector<br>
 R Qamar<br>
 I Román Martínez</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Various changes to assertions due to input from the DSTC.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A Goodchild<br>
 Z Z Tun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed review from Clinical Information Project, Australia.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E Browne</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><strong>Remove UML models to "Archetype Object Model" document.</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Detailed review from CHIME, UCL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Austin</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-103" target="_blank" rel="noopener">SPEC-103</a>. Redevelop archetype UML model, add new keywords: <code>allow_archetype</code>, <code>include</code>, <code>exclude</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-104" target="_blank" rel="noopener">SPEC-104</a>. Fix ordering bug when <code>use_node</code> used. Required parser rules for identifiers to make class and attribute identifiers distinct.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">K Atalag</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added grammars for all parts of ADL, as well as new UML diagrams.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="4"><p class="tableblock"><strong>Release 0.9</strong></p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-79" target="_blank" rel="noopener">SPEC-79</a>. Change interval syntax in ADL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">24 Jan 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">1.0</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-77" target="_blank" rel="noopener">SPEC-77</a>. Add cADL date/time pattern constraints.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-78" target="_blank" rel="noopener">SPEC-78</a>. Add predefined clinical types.
 Better explanation of cardinality, occurrences and existence.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">S Heard,<br>
 T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">14 Jan 2004</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-73" target="_blank" rel="noopener">SPEC-73</a>. Allow lists of Reals and Integers in cADL.<br>
 <a href="https://specifications.openehr.org/tickets/SPEC-75" target="_blank" rel="noopener">SPEC-75</a>. Add predefined clinical types library to ADL.<br>
 Added cADL and dADL object models.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 Dec 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/tickets/SPEC-70" target="_blank" rel="noopener">SPEC-70</a>. Create Archetype System Description.
 Moved Archetype Identification Section to new Archetype System document.  Copyright Assgined by Ocean Informatics P/L Australia to The openEHR Foundation.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale,<br>
 S Heard</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">29 Nov 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.7</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added simple value list continuation (",&#8230;&#8203;"). Changed path syntax so that trailing '/' required for object paths.<br>
 Remove ranges with excluded limits.<br>
 Added terms and term lists to dADL leaf types.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">01 Nov 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Additions during HL7 WGM Memphis Sept 2003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">09 Sep 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9.5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added comparison to other formalisms. Renamed CDL to cADL and dDL to dADL. Changed path syntax to conform (nearly) to Xpath. Numerous small changes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">03 Sep 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.9</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Rewritten with sections on cADL and dDL.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">28 July 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Added basic type constraints, re-arranged sections.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">15 July 2003</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">0.8</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initial Writing</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">T Beale</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">10 July 2003</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_acknowledgements"><a class="anchor" href="#_acknowledgements"></a>Acknowledgements</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_primary_author"><a class="anchor" href="#_primary_author"></a>Primary Author</h3>
<div class="ulist">
<ul>
<li>
<p>Thomas Beale, Ocean Informatics UK; openEHR Architecture Review Board (ARB)</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_contributors"><a class="anchor" href="#_contributors"></a>Contributors</h3>
<div class="paragraph">
<p>Thanks to Sebastian Garde, Central Qld University, Australia, for German translations.</p>
</div>
</div>
<div class="sect2">
<h3 id="_trademarks"><a class="anchor" href="#_trademarks"></a>Trademarks</h3>
<div class="ulist">
<ul>
<li>
<p>'Microsoft' and '.Net' are registered trademarks of the Microsoft Corporation.</p>
</li>
<li>
<p>'Java' is a registered trademark of Oracle Corporation</p>
</li>
<li>
<p>'Linux' is a registered trademark of Linus Torvalds.</p>
</li>
<li>
<p>'openEHR' is a registered trademark of The openEHR Foundation</p>
</li>
<li>
<p>'SNOMED CT' is a registered trademark of IHTSDO</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_supporters"><a class="anchor" href="#_supporters"></a>Supporters</h3>
<div class="paragraph">
<p>The work reported in this paper has been funded by the following organisations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>UCL (University College London) - Centre for Health Informatics and Multiprofessional Education (CHIME);</p>
</li>
<li>
<p>Ocean Informatics.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Special thanks to Prof David Ingram, founding Director of CHIME, UCL, who provided a vision and collegial working environment ever since the days of GEHR (1992).</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_preface"><a class="anchor" href="#_preface"></a>1. Preface</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_purpose"><a class="anchor" href="#_purpose"></a>1.1. Purpose</h3>
<div class="paragraph">
<p>This document describes the design basis and syntax of the Archetype Definition Language 1.4 (ADL 1.4). It is intended for software developers, technically-oriented domain specialists and subject matter experts (SMEs). ADL is designed as an abstract human-readable and computer-processible syntax. ADL archetypes can be hand-edited using a normal text editor.</p>
</div>
<div class="paragraph">
<p>The intended audience includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Standards bodies producing health informatics standards;</p>
</li>
<li>
<p>Academic groups using openEHR;</p>
</li>
<li>
<p>The open source healthcare community;</p>
</li>
<li>
<p>Solution vendors;</p>
</li>
<li>
<p>Medical informaticians and clinicians interested in health information.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_related_documents"><a class="anchor" href="#_related_documents"></a>1.2. Related Documents</h3>
<div class="paragraph">
<p>Prerequisite documents for reading this document include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/BASE/latest/architecture_overview.html" target="_blank" rel="noopener">openEHR Architecture Overview</a>;</p>
</li>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/Overview.html" target="_blank" rel="noopener">openEHR Archetype Technical Overview</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Related documents include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The <a href="https://specifications.openehr.org/releases/AM/latest/AOM1.4.html" target="_blank" rel="noopener">openEHR Archetype Object Model (AOM14)</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_nomenclature"><a class="anchor" href="#_nomenclature"></a>1.3. Nomenclature</h3>
<div class="paragraph">
<p>In this document, the term 'attribute' denotes any stored property of a type defined in an object model, including primitive attributes and any kind of relationship such as an association or aggregation. XML 'attributes' are always referred to explicitly as 'XML attributes'.</p>
</div>
</div>
<div class="sect2">
<h3 id="_status"><a class="anchor" href="#_status"></a>1.4. Status</h3>
<div class="paragraph">
<p>This specification is in the STABLE state. The development version of this document can be found at <a href="https://specifications.openehr.org/releases/AM/latest/ADL1.4.html" target="_blank" rel="noopener">https://specifications.openehr.org/releases/AM/latest/ADL1.4.html</a>.</p>
</div>
<div class="paragraph">
<p>Known omissions or questions are indicated in the text with a 'to be determined' paragraph, as follows:</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: (example To Be Determined paragraph)</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
this specification is a re-formatted issue of the <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/adl.pdf" target="_blank" rel="noopener">original ADL 1.4 Specification from openEHR Release 1.0.2</a>. There are slight changes in formatting, citations and other references, corrections to typographical errors and changed syntax colourisation due to the use of more modern language-based syntax colourisers in the publishing tools.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
for users requiring the most recent form of ADL and archteype technology in general, the <a href="https://specifications.openehr.org/releases/AM/latest/index" target="_blank" rel="noopener">Archetype Definition Language 2 (ADL2) specifications should be used</a>. In particular, the <a href="https://specifications.openehr.org/releases/AM/latest/Overview.html" target="_blank" rel="noopener">Archetype Technology Overview</a> should be referred to for the most current description of Archetype Technology.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_feedback"><a class="anchor" href="#_feedback"></a>1.5. Feedback</h3>
<div class="paragraph">
<p>Feedback may be provided on the <a href="https://discourse.openehr.org/c/specifications/adl" target="_blank" rel="noopener">openEHR ADL forum</a>.</p>
</div>
<div class="paragraph">
<p>Issues may be raised on the <a href="https://specifications.openehr.org/components/AM/open_issues" target="_blank" rel="noopener">specifications Problem Report tracker</a>.</p>
</div>
<div class="paragraph">
<p>To see changes made due to previously reported issues, see the <a href="https://specifications.openehr.org/components/AM/history" target="_blank" rel="noopener">AM component Change Request tracker</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_conformance"><a class="anchor" href="#_conformance"></a>1.6. Conformance</h3>
<div class="paragraph">
<p>Conformance of a data or software artifact to an openEHR specification is determined by a formal test of that artifact against the relevant <a href="https://specifications.openehr.org/releases/ITS/latest/index" target="_blank" rel="noopener">openEHR Implementation Technology Specification(s) (ITSs)</a>, such as an IDL interface or an XML-schema. Since ITSs are formal derivations from underlying models, ITS conformance indicates model conformance.</p>
</div>
</div>
<div class="sect2">
<h3 id="_tools"><a class="anchor" href="#_tools"></a>1.7. Tools</h3>
<div class="paragraph">
<p>Various tools exist for creating and processing archetypes. The <a href="https://www.openehr.org/downloads/ADLworkbench" target="_blank" rel="noopener">ADL Workbench</a> is a reference compiler, visualiser and editor. The openEHR tools can be <a href="https://www.openehr.org/downloads/modellingtools" target="_blank" rel="noopener">downloaded from the website</a> .</p>
</div>
<div class="paragraph">
<p>Source projects can be found at the <a href="https://github.com/openEHR" target="_blank" rel="noopener">openEHR Github project</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_overview"><a class="anchor" href="#_overview"></a>2. Overview</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_what_is_adl"><a class="anchor" href="#_what_is_adl"></a>2.1. What is ADL?</h3>
<div class="paragraph">
<p>Archetype Definition Language (ADL) is a formal language for expressing archetypes, which are constraint-based models of domain entities, or what some might call 'structured business rules'. The archetype concept is described by <span class="citation"><a href="#Beale2000">Beale (2000)</a></span>, <span class="citation"><a href="#Beale2002">Beale (2002)</a></span>. The <a href="https://specifications.openehr.org/releases/AM/latest/ADL1.4.html" target="_blank" rel="noopener">openEHR Archetype Object Model 1.4</a> describes the definitive semantic model of archetypes, in the form of an object model. The ADL syntax is one possible serialisation of an archetype.</p>
</div>
<div class="paragraph">
<p>The openEHR archetype framework is described in terms of <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/archetype_principles.pdf" target="_blank" rel="noopener">Archetype Definitions and Principles</a> and an <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/archetype_system.pdf" target="_blank" rel="noopener">Archetype System</a>. Other semantic formalisms considered in the course of the development of ADL, and some which remain relevant are described in detailed in <a href="#_relationship_of_adl_to_other_formalisms">Appendix A</a>.</p>
</div>
<div class="paragraph">
<p>ADL uses three other syntaxes, cADL (constraint form of ADL), dADL (data definition form of ADL), and a version of first-order predicate logic (FOPL), to describe constraints on data which are instances of some information model (e.g. expressed in UML). It is most useful when very generic information models are used for describing the data in a system, for example, where the logical concepts <code>PATIENT</code>, <code>DOCTOR</code> and <code>HOSPITAL</code> might all be represented using a small number of classes such as <code>PARTY</code> and <code>ADDRESS</code>. In such cases, archetypes are used to constrain the valid structures of instances of these generic classes to represent the desired domain concepts. In this way future-proof information systems can be built - relatively simple information models and database schemas can be defined, and archetypes supply the semantic modelling, completely outside the software. ADL can thus be used to write archetypes for any domain where formal object model(s) exist which describe data instances.</p>
</div>
<div class="paragraph">
<p>When archetypes are used at runtime in particular contexts, they are <em>composed</em> into larger constraint structures, with local or specialist constraints added, via the use of <em>templates</em>. The formalism of templates is dADL. Archetypes can be <em>specialised</em> by creating an archetypes that reference existing archetypes as parents; such archetypes can only make certain changes while remaining compatible with the parent.</p>
</div>
<div class="paragraph">
<p>Another major function of archetypes is to connect information structures to formal terminologies. Archetypes are language-neutral, and can be authored in and translated into any language.</p>
</div>
<div class="paragraph">
<p>Finally, archetypes are completely path-addressable in a manner similar to XML data, using path expressions that are directly convertible to Xpath expressions.</p>
</div>
<div class="sect3">
<h4 id="_structure"><a class="anchor" href="#_structure"></a>2.1.1. Structure</h4>
<div class="paragraph">
<p>Archetypes expressed in ADL resemble programming language files, and have a defined syntax. ADL itself is a very simple 'glue' syntax, which uses two other syntaxes for expressing structured constraints and data, respectively. The cADL syntax is used to express the archetype <code>definition</code> section, while the ODIN syntax is used to express data which appears in the <code>language</code>, <code>description</code>, <code>terminology</code>, and `revision_history' sections of an ADL archetype. The top-level structure of an ADL archetype is shown in the figure below.</p>
</div>
<div class="paragraph">
<p>This main part of this document describes cADL and ADL path syntax, before going on to describe the combined ADL syntax, archetypes and domain-specific type libraries.</p>
</div>
<div id="archetype_structure" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/adl_text_overview.svg" alt="adl text overview" width="50%">
</div>
<div class="title">Figure 1. ADL Archetype Structure</div>
</div>
</div>
<div class="sect3">
<h4 id="_an_example"><a class="anchor" href="#_an_example"></a>2.1.2. An Example</h4>
<div class="paragraph">
<p>The following is an example of a very simple archetype, giving a feel for the syntax. The main point to glean from the following is that the notion of 'guitar' is defined in terms of <em>constraints</em> on a <em>generic</em> model of the concept "INSTRUMENT". The names mentioned down the left-hand side of the definition section (<code>INSTRUMENT</code>, <code>size</code> etc) are alternately class and attribute names from an object model.  Each block of braces encloses a specification for some particular set of instances that conform to a specific concept, such as 'guitar' or 'neck', defined in terms of constraints on types from a generic class model. The leaf pairs of braces enclose constraints on primitive types such as <code>Integer</code>, <code>String</code>, <code>Boolean</code> and so on. </p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">1.4</span><span class="tok-p">)</span>
<span class="tok-err">    adl-test-instrument.guitar.draft.v1</span>

<span class="tok-err">concept</span>
<span class="tok-err">    [at0000]</span>

<span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>

<span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">INSTRUMENT</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">size</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">60</span><span class="tok-p">..</span><span class="tok-mi">120</span><span class="tok-p">|}</span><span class="tok-w">                            </span><span class="tok-c">-- size in cm</span>
<span class="tok-w">        </span><span class="tok-nc">date_of_manufacture</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-ld">yyyy-mm-??</span><span class="tok-p">}</span><span class="tok-w">            </span><span class="tok-c">-- year &amp; month ok</span>
<span class="tok-w">        </span><span class="tok-nc">parts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- neck</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at0003</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nd">at0004</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- timber or nickel alloy</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PART</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- body</span>
<span class="tok-w">                </span><span class="tok-nc">material</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">local</span><span class="tok-p">::</span><span class="tok-nd">at0003</span><span class="tok-p">]}</span><span class="tok-w">          </span><span class="tok-c">-- timber</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>

<span class="tok-gh">ontology</span>
<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;guitar&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;stringed instrument&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;neck of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;body of guitar&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0003&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;timber&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;straight, seasoned timber&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nickel alloy&quot;</span><span class="tok-p">&gt;;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;frets&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_semantics"><a class="anchor" href="#_semantics"></a>2.1.3. Semantics</h4>
<div class="paragraph">
<p>As a parsable syntax, ADL has a formal relationship with structural models such as those expressed in UML, according to the scheme of the following figure. Here we can see that ADL documents are parsed into a network of objects (often known as a ‘parse tree’) which are themselves defined by a formal, abstract object model (see The <a href="https://specifications.openehr.org/releases/AM/latest/ADL1.4.html" target="_blank" rel="noopener">openEHR Archetype Object Model 1.4</a>. Such a model can in turn be re-expressed as any number of concrete models, such as in a programming language, XML-schema or OMG IDL.</p>
</div>
<div class="paragraph">
<p>While ADL syntax remains the primary abstract formalism for expressing archetypes, the AOM defines the semantics of an archetype, in particular relationships which must hold true between the parts of an archetype for it to be valid as a whole.</p>
</div>
<div id="relationship_with_models" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/relationship_with_models.png" alt="relationship with models" width="80%">
</div>
<div class="title">Figure 2. Relationship of ADL with Object Models</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_computational_context"><a class="anchor" href="#_computational_context"></a>2.2. Computational Context</h3>
<div class="paragraph">
<p>Archetypes are distinct, structured models of domain content, such as 'data captured for a blood pressure observation'. They sit between lower layers of knowledge resources in a computing environment, such as clinical terminologies and ontologies, and actual data in production systems. Their primary purpose is to provide a reusable, interoperable way of managing generic data so that it conforms to particular structures and semantic constraints. Consequently, they bind terminology and ontology concepts to information model semantics, in order to make statements about what valid data structures look like. ADL provides a solid formalism for expressing, building and using these entities computationally. Every ADL archetype is written with respect to a particular information model, often known as a 'reference model', if it is a shared, public specification.</p>
</div>
<div class="paragraph">
<p>Archetypes are applied to data via the use of <em>templates</em>, which are defined at a local level. Templates generally correspond closely to screen forms, and may be re-usable at a local or regional level. Templates do not introduce any new semantics to archetypes, they simply specify the use of particular archetypes, further compatible constraints, and default data values.</p>
</div>
<div class="paragraph">
<p>A third artifact governing the functioning of archetypes and templates at runtime is the local palette, which specifies which natural language(s) and terminologies are in use in the locale. The use of a palette removes irrelevant languages and terminology bindings from archetypes, retaining only those relevant to actual use. The following figure illustrates the overall environment in which archetypes, templates, and a locale palette exist.</p>
</div>
</div>
<div class="sect2">
<h3 id="_xml_form_of_archetypes"><a class="anchor" href="#_xml_form_of_archetypes"></a>2.3. XML form of Archetypes</h3>
<div class="paragraph">
<p>With ADL parsing tools it is possible to convert ADL to any number of forms, including various XML formats. XML instance can be generated from the object form of an archetype in memory. An XML-schema corresponding to the ADL Object Model is <a href="http://www.openehr.org/releases/trunk/its/XML-schema" target="_blank" rel="noopener">published at openEHR.org</a>.</p>
</div>
<div id="archetypes_templates_palette" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/archetypes_templates_palette.png" alt="archetypes templates palette" width="80%">
</div>
<div class="title">Figure 3. Archetypes, Templates and Palette</div>
</div>
</div>
<div class="sect2">
<h3 id="_changes_from_previous_versions"><a class="anchor" href="#_changes_from_previous_versions"></a>2.4. Changes from Previous Versions</h3>
<div class="paragraph">
<p>For existing users of ADL or archetype development tools, the following provides a guide to the changes in the syntax.</p>
</div>
<div class="sect3">
<h4 id="_version_1_4_from_version_1_3"><a class="anchor" href="#_version_1_4_from_version_1_3"></a>2.4.1. Version 1.4 from Version 1.3</h4>
<div class="paragraph">
<p>A number of small changes were made in this version, along with significant tightening up of the explanatory text and examples.</p>
</div>
<div class="sect4">
<h5 id="_iso_8601_datetime_conformance"><a class="anchor" href="#_iso_8601_datetime_conformance"></a>2.4.1.1. ISO 8601 Date/Time Conformance</h5>
<div class="paragraph">
<p>All <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a> date, time, date/time and duration values in dADL are now conformant (previously the usage of the 'T' separator was not correct). Constraint patterns in cADL for dates, times and date/times are also corrected, with a new constraint pattern for ISO 8601 durations being added. The latter allows a deviation from the standard to include the 'W' specifier, since durations with a mixture of weeks, days etc is often used in medicine.</p>
</div>
</div>
<div class="sect4">
<h5 id="_non_inclusive_two_sided_intervals"><a class="anchor" href="#_non_inclusive_two_sided_intervals"></a>2.4.1.2. Non-inclusive Two-sided Intervals</h5>
<div class="paragraph">
<p>It is now possible to define an interval of any ordered amount (integer, real, date, time, date/time, duration) where one or both of the limits is not included, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    |0..&lt;1000|    -- 0 &gt;= x &lt; 1000
    |&gt;0.5..4.0|   -- 0.5 &gt; x &lt;= 4.0
    |&gt;P2d..&lt;P10d| -- 2 days &gt; x &lt; 10 days</code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_occurrences_for_use_node_references"><a class="anchor" href="#_occurrences_for_use_node_references"></a>2.4.1.3. Occurrences for 'use_node' References</h5>
<div class="paragraph">
<p>Occurrences can now be stated for <code>use_node</code> references, overriding the occurrences of the target node.  If no occurrences is stated, the target node occurrences value is used.</p>
</div>
</div>
<div class="sect4">
<h5 id="_quoting_rules"><a class="anchor" href="#_quoting_rules"></a>2.4.1.4. Quoting Rules</h5>
<div class="paragraph">
<p>The old quoting rules based on XML/ISO mnemonic patterns (<code>&ohmgr;</code> etc) are replaced by specifying ADL to be UTF-8 based, and any exceptions to this requiring ASCII encoding should use the <code>\Uhhhh</code> style of quoting unicode used in various programming languages.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_1_3_from_version_1_2"><a class="anchor" href="#_version_1_3_from_version_1_2"></a>2.4.2. Version 1.3 from Version 1.2</h4>
<div class="paragraph">
<p>The specific changes made in version 1.3 of ADL are as follows.</p>
</div>
<div class="sect4">
<h5 id="_query_syntax_replaced_by_uri_data_type"><a class="anchor" href="#_query_syntax_replaced_by_uri_data_type"></a>2.4.2.1. Query syntax replaced by URI data type</h5>
<div class="paragraph">
<p>In version 1.2 of ADL, it was possible to include an external query, using syntax of the form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    attr_name = &lt;query(&quot;some_service&quot;, &quot;some_query_string&quot;)&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is now replaced by the use of URIs, which can express queries, for example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    attr_name = &lt;http://some.service.org?some%20query%20etc&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>No assumption is made about the URI; it need not be in the form of a query - it may be any kind of URI.</p>
</div>
</div>
<div class="sect4">
<h5 id="_top_level_invariant_section"><a class="anchor" href="#_top_level_invariant_section"></a>2.4.2.2. Top-level Invariant Section</h5>
<div class="paragraph">
<p>In this version, invariants can only be defined in a top level block, in a way similar to object-oriented class definitions, rather than on every block in the definition section, as is the case in version 1.2 of ADL. This simplifies ADL and the Archetype Object Model, and makes an archetype more comprehensible as a <code>type</code> definition.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_version_1_2_from_version_1_1"><a class="anchor" href="#_version_1_2_from_version_1_1"></a>2.4.3. Version 1.2 from Version 1.1</h4>
<div class="sect4">
<h5 id="_adl_version"><a class="anchor" href="#_adl_version"></a>2.4.3.1. ADL Version</h5>
<div class="paragraph">
<p>The ADL version is now optionally (for the moment) included in the first line of the archetype, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>    archetype (adl_version=1.2)</code></pre>
</div>
</div>
<div class="paragraph">
<p>It is strongly recommended that all tool implementors include this information when archetypes are saved, enabling archetypes to gradually become imprinted with their correct version, for more reliable later processing. The adl_version indicator is likely to become mandatory in future versions of ADL.</p>
</div>
</div>
<div class="sect4">
<h5 id="_dadl_syntax_changes"><a class="anchor" href="#_dadl_syntax_changes"></a>2.4.3.2. dADL Syntax Changes</h5>
<div class="paragraph">
<p>The dADL syntax for container attributes has been altered to allow paths and typing to be expressed more clearly, as part of enabling the use of Xpath-style paths. ADL 1.1 dADL had the following appearance:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = &lt;
		locations(1) = &lt;...&gt;
		locations(2) = &lt;...&gt;
		locations(3) = &lt;...&gt;
		subjects(&quot;philosophy:plato&quot;) = &lt;...&gt;
		subjects(&quot;philosophy:kant&quot;) = &lt;...&gt;
		subjects(&quot;art&quot;) = &lt;...&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>This has been changed to look like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = &lt;
		locations = &lt;
			[1] = &lt;...&gt;
			[2] = &lt;...&gt;
			[3] = &lt;...&gt;
		&gt;
		subjects = &lt;
			[&quot;philosophy:plato&quot;] = &lt;...&gt;
			[&quot;philosophy:kant&quot;] = &lt;...&gt;
			[&quot;art&quot;] = &lt;...&gt;
		&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>The new appearance both corresponds more directly to the actual object structure of container types,
and has the property that paths can be constructed by directly reading identifiers down the backbone
of any subtree in the structure. It also allows the optional addition of typing information anywhere in
the structure, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>	school_schedule = SCHEDULE &lt;
		locations = LOCATION &lt;
			[1] = &lt;...&gt;
			[2] = &lt;...&gt;
			[3] = ARTS_PAVILLION &lt;...&gt;
		&gt;
		subjects = &lt;
			[&quot;philosophy:plato&quot;] = ELECTIVE_SUBJECT &lt;...&gt;
			[&quot;philosophy:kant&quot;] = ELECTIVE_SUBJECT &lt;...&gt;
			[&quot;art&quot;] = MANDATORY_SUBJECT &lt;...&gt;
		&gt;
	&gt;</code></pre>
</div>
</div>
<div class="paragraph">
<p>These changes will affect the parsing of container structures and keys in the description and terminology parts of the archetype.</p>
</div>
</div>
<div class="sect4">
<h5 id="_revision_history_section"><a class="anchor" href="#_revision_history_section"></a>2.4.3.3. Revision History Section</h5>
<div class="paragraph">
<p>Revision history is now recorded in a separate section of the archetype, both to logically separate it from the archetype descriptive details, and to facilitate automatic processing by version control systems in which archetypes may be stored. This section is included at the end of the archetype because it is in general a monotonically growing section.</p>
</div>
</div>
<div class="sect4">
<h5 id="_primary_language_and_languages_available_sections"><a class="anchor" href="#_primary_language_and_languages_available_sections"></a>2.4.3.4. Primary_language and Languages_available Sections</h5>
<div class="paragraph">
<p>An attribute previously called <code><em>primary_language</em></code> was required in the <code>ontology</code> section of an ADL 1.1 archetype. This is renamed to <code><em>original_language</em></code> and is now moved to a new top level section in the archetype called <code>language</code>. Its value is still expressed as a dADL String attribute. The <code><em>languages_available</em></code> attribute previously required in the <code>ontology</code> section of the archetype is renamed to <code><em>translations</em></code>, no longer includes the original languages, and is also moved to this new top level section.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_file_encoding_and_character_quoting"><a class="anchor" href="#_file_encoding_and_character_quoting"></a>3. File Encoding and Character Quoting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_file_encoding"><a class="anchor" href="#_file_encoding"></a>3.1. File Encoding</h3>
<div class="paragraph">
<p>Because ADL files are inherently likely to contain multiple languages due to internationalised authoring and translation, they must be capable of accommodating characters from any language. ADL files do not explicitly indicate an encoding because they are assumed to be in UTF-8 encoding of unicode.  For ideographic and script-oriented languages, this is a necessity.</p>
</div>
<div class="paragraph">
<p>There are three places in ADL files where non-ASCII characters can occur:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>in string values, demarcated by double quotes, e.g. "xxxx";</p>
</li>
<li>
<p>in regular expression patterns, demarcated by either <code>//</code> or <code>^^</code>;</p>
</li>
<li>
<p>in character values, demarcated by single quotes, e.g. 'x'.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>URIs (a data type in ODIN) are assumed to be 'percent-encoded' according to <a href="https://tools.ietf.org/html/rfc3986" target="_blank" rel="noopener">IETF RFC 3986</a>, which applies to all characters outside the 'unreserved set'. The unreserved set is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>unreserved = ALPHA / DIGIT / &quot;-&quot; / &quot;.&quot; / &quot;_&quot; / &quot;~&quot;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In actual fact, ADL files encoded in latin 1 (ISO-8859-1) or another variant of ISO-8859 - both containing accented characters with unicode codes outside the ASCII 0-127 range - may work perfectly well, for various reasons:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the contain nothing but ASCII, i.e. unicode code-points 0 - 127; this will be the case in English- language authored archetypes containing no foreign words;</p>
</li>
<li>
<p>some layer of the operating system is smart enough to do an on-the-fly conversion of characters above 127 into UTF-8, even if the archetype tool being used is designed for pure UTF-8 only;</p>
</li>
<li>
<p>the archetype tool (or the string-processing libraries it uses) might support UTF-8 and ISO- 8859 variants.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For situations where binary UTF-8 (and presumably other UTF-* encodings) cannot be supported, ASCII encoding of unicode characters above code-point 127 should only be done using the system supported by many programming languages today, namely <code>\u</code> escaped UTF-16. In this system, unicode codepoints are mapped to either:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>\uHHHH</code> - 4 hex digits which will be the same (possibly 0-filled on the left) as the unicode code-point number expressed in hexadecimal; this applies to unicode codepoints in the range <code>U+0000</code> - <code>U+FFFF</code> (the 'base multi-lingual plane', BMP);</p>
</li>
<li>
<p><code>\uHHHHHHHH</code> - 8 hex digits to encode unicode code-points in the range <code>U+10000</code> through <code>U+10FFFF</code> (non-BMP planes); the algorithm is described in <a href="https://tools.ietf.org/html/rfc2781" target="_blank" rel="noopener">IETF RFC 2781</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It is not expected that the above approach will be commonly needed, and it may not be needed at all; it is preferable to find ways to ensure that native UTF-8 can be supported, since this reduces the burden for ADL parser and tool implementers. The above guidance is therefore provided only to ensure a standard approach is used for ASCII-encoded unicode, if it becomes unavoidable.</p>
</div>
<div class="paragraph">
<p>Thus, while <strong>the only officially designated encoding for ADL and its constituent syntaxes is UTF-8</strong>, real software systems may be more tolerant. This document therefore specifies that any tool designed to process ADL files need only support UTF-8; supporting other encodings is an optional extra. This could change in the future, if required by the ADL or openEHR user community.</p>
</div>
</div>
<div class="sect2">
<h3 id="_special_character_sequences"><a class="anchor" href="#_special_character_sequences"></a>3.2. Special Character Sequences</h3>
<div class="paragraph">
<p>In strings and characters, characters not in the lower ASCII (0-127) range should be UTF-8 encoded, with the exception of quoted single- and double-quotes, and some non-printing characters, for which the following customary quoted forms are allowed (but not required):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>\r</code> - carriage return</p>
</li>
<li>
<p><code>\n</code> - linefeed</p>
</li>
<li>
<p><code>\t</code> - tab</p>
</li>
<li>
<p><code>\\</code> - backslash</p>
</li>
<li>
<p><code>\"</code> - literal double quote</p>
</li>
<li>
<p><code>\'</code> - literal single quote</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Any other character combination starting with a backslash is illegal; to get the effect of a literal backslash, the <code>\\</code> sequence should always be used.</p>
</div>
<div class="paragraph">
<p>Typically in a normal string, including multi-line paragraphs as used in ODIN, only <code>\\</code> and <code>\"</code> are likely to be necessary, since all of the others can be accommodated in their literal forms; the same goes for single characters - only <code>\\</code> and <code>\'</code> are likely to commonly occur. However, some authors may prefer to use <code>\n</code> and <code>\t</code> to make intended formatting clearer, or to allow for text editors that do not react properly to such characters. Parsers should therefore support the above list.</p>
</div>
<div class="paragraph">
<p>In regular expressions (only used in cADL string constraints), there will typically be backslash-escaped characters from the above list as well as other patterns like <code>\s</code> (whitespace) and <code>\d</code> (decimal digit), according to the <a href="https://perldoc.perl.org/perlre.html" target="_blank" rel="noopener">PERL regular expression specification</a>. These should not be treated as anything other than literal strings, since they are processed by a regular expression parser.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_dadl_data_adl"><a class="anchor" href="#_dadl_data_adl"></a>4. dADL - Data ADL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_2"><a class="anchor" href="#_overview_2"></a>4.1. Overview</h3>
<div class="paragraph">
<p>The dADL syntax provides a formal means of expressing instance data based on an underlying object-oriented or relational information model, which is readable both by humans and machines. The general appearance is exemplified by the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">person</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">List&lt;PERSON&gt;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">01234</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w"> </span><span class="tok-c">-- person&#39;s name</span>
<span class="tok-w">            </span><span class="tok-nc">forenames</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Sherlock&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">family_name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Holmes&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">salutation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Mr&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">address</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w"> </span><span class="tok-c">-- person&#39;s address</span>
<span class="tok-w">            </span><span class="tok-nc">habitation_number</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;221B&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">street_name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Baker St&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">city</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;London&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">country</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;England&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">01235</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w"> </span><span class="tok-c">-- etc &gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above the attribute names <code>person</code> , <code>name</code> , <code>address</code> etc, and the type <code>List&lt;PERSON&gt;</code> are all assumed to come from an information model. The <code>[01234]</code> and <code>[01235]</code> tags identify container items.</p>
</div>
<div class="paragraph">
<p>The basic design principle of dADL is to be able to represent data in a way that is both machine-processable and human readable, while making the fewest assumptions possible about the information model to which the data conforms. To this end, type names are optional; often, only attribute names and values are explicitly shown. No syntactical assumptions are made about whether the underlying model is relational, object-oriented or what it actually looks like. More than one information model can be compatible with the same dADL-expressed data. The UML semantics of composition/aggregation and association are expressible, as are shared objects. Literal leaf values are only of 'standard' widely recognised types, i.e. Integer, Real, Boolean, String, Character and a range of Date/time types. In standard dADL, all complex types are expressed structurally.</p>
</div>
<div class="paragraph">
<p>A common question about dADL is why it is needed, when there is already XML? To start with, this question highlights the widespread misconception about XML, namely that because it can be read by a text editor, it is intended for humans. In fact, XML is designed for machine processing, and is textual to guarantee its interoperability. Realistic examples of XML (e.g. XML-schema instance, OWL-RDF ontologies) are generally unreadable for humans. dADL is on the other hand designed as a human-writable and readable formalism that is also machine processable; it may be thought of as an <em>abstract syntax for object-oriented data</em>. dADL also differs from XML by:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>providing a more comprehensive set of leaf data types, including intervals of numerics and date/time types, and lists of all primitive types;</p>
</li>
<li>
<p>adhering to object-oriented semantics, particularly for container types, which XML schema languages generally do not;</p>
</li>
<li>
<p>not using the confusing XML notion of ‘attributes’ and ‘elements’ to represent what are essentially object properties;</p>
</li>
<li>
<p>requiring half the space of the equivalent XML.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Of course, this does not prevent XML exchange syntaxes being used for dADL, and indeed the conversion to XML instance is rather straightforward. Details on the XML expression of dADL and use of Xpath expressions is described in <a href="#_expression_of_dadl_in_xml">Section 4.7</a>.</p>
</div>
<div class="paragraph">
<p>The dADL syntax as described above has a number of useful characteristics that enable the extensive use of paths to navigate it, and express references. These include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>each <code>&lt;&gt;</code> block corresponds to an object (i.e. an instance of some type in an information model);</p>
</li>
<li>
<p>the name before an '=' is always an attribute name or else a container element key, which attaches to the attribute of the enclosing block;</p>
</li>
<li>
<p>paths can be formed by navigating down a tree branch and concatenating attribute name, container keys (where they are encountered) and '/' characters;</p>
</li>
<li>
<p>every node is reachable by a path;</p>
</li>
<li>
<p>shared objects can be referred to by path references.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_basics"><a class="anchor" href="#_basics"></a>4.2. Basics</h3>
<div class="sect3">
<h4 id="_scope_of_a_dadl_document"><a class="anchor" href="#_scope_of_a_dadl_document"></a>4.2.1. Scope of a dADL Document</h4>
<div class="paragraph">
<p>A dADL document may contain one or more objects from the same object model.</p>
</div>
</div>
<div class="sect3">
<h4 id="_keywords"><a class="anchor" href="#_keywords"></a>4.2.2. Keywords</h4>
<div class="paragraph">
<p>dADL has no keywords of its own: all identifiers are assumed to come from an information model.</p>
</div>
</div>
<div class="sect3">
<h4 id="_reserved_characters"><a class="anchor" href="#_reserved_characters"></a>4.2.3. Reserved Characters</h4>
<div class="paragraph">
<p>In dADL, a small number of characters are reserved and have the following meanings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;</code>: open an object block;</p>
</li>
<li>
<p><code>&gt;</code>: close an object block;</p>
</li>
<li>
<p><code>=</code>: indicate attribute value = object block;</p>
</li>
<li>
<p><code>(</code>, <code>)</code>: type name or plug-in syntax type delimiters;</p>
</li>
<li>
<p><code>&lt;#</code>: open an object block expressed in a plug-in syntax;</p>
</li>
<li>
<p><code>#&gt;</code>: close an object block expressed in a plug-in syntax.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Within &lt;&gt; delimiters, various characters are used as follows to indicate primitive values:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"</code>: double quote characters are used to delimit string values;</p>
</li>
<li>
<p><code>'</code>: single quote characters are used to delimit single character values;</p>
</li>
<li>
<p><code>|</code>: bar characters are used to delimit intervals;</p>
</li>
<li>
<p><code>[]</code>: brackets are used to delimit coded terms.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_comments"><a class="anchor" href="#_comments"></a>4.2.4. Comments</h4>
<div class="paragraph">
<p>In a dADL text, comments satisfy the following rule.</p>
</div>
<div class="paragraph principle">
<p><strong>Comments</strong> are indicated by the characters "--". Multi-line comments are achieved using the "--" leader on each line where the comment continues.</p>
</div>
<div class="paragraph">
<p>In this document, dADL comments are shown in brown.</p>
</div>
</div>
<div class="sect3">
<h4 id="_information_model_identifiers"><a class="anchor" href="#_information_model_identifiers"></a>4.2.5. Information Model Identifiers</h4>
<div class="paragraph">
<p>Two types of identifiers from information models are used in dADL: type names and attribute names.</p>
</div>
<div class="paragraph principle">
<p>A <strong>type name</strong> is any identifier with an initial upper case letter, followed by any combination of letters, digits and underscores. A <strong>generic type name</strong> (including nested forms) additionally may include commas and angle brackets, and must be syntactically correct as per the UML. An <strong>attribute name</strong> is any identifier with an initial lower case letter, followed by any combination of letters, digits and underscores. Any convention that obeys this rule is allowed.</p>
</div>
<div class="paragraph">
<p>At least two well-known conventions that are ubiquitous in information models obey the above rule. One of these is the following convention:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type names are in all uppercase, e.g. <code>PERSON</code> , except for 'built-in' types, such as primitive types (` Integer` , <code>String</code> , <code>Boolean</code> , <code>Real</code> , <code>Double</code> ) and assumed container types (<code>List&lt;T&gt;</code> , <code>Set&lt;T&gt;</code> , <code>Hash&lt;T, U&gt;</code> ), which are in mixed case, in order to provide easy differentiation of built-in types from constructed types defined in the reference model. Built-in types are the same types assumed by UML, OCL, IDL and other similar object-oriented formalisms.</p>
</li>
<li>
<p>attribute names are shown in all lowercase, e.g. <code>home_address</code> .</p>
</li>
<li>
<p>in both type names and attribute names, underscores are used to represent word breaks. This convention is used to maximise the readability of this document.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The other common style is the programmer&#8217;s mixed-case or "camel case" convention exemplified by <code>Person</code> and <code>homeAddress</code> , as long as they obey the rule above. The convention chosen for any particular dADL document should be based on the convention used in the underlying information model. Identifiers are shown in green in this document.</p>
</div>
</div>
<div class="sect3">
<h4 id="_semi_colons"><a class="anchor" href="#_semi_colons"></a>4.2.6. Semi-colons</h4>
<div class="paragraph">
<p>Semi-colons can be used to separate dADL blocks, for example when it is preferable to include multiple attribute/value pairs on one line. Semi-colons make no semantic difference at all, and are included only as a matter of taste. The following examples are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">term</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;;</span><span class="tok-w"> </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s advice&quot;</span><span class="tok-p">&gt;&gt;</span>
<span class="tok-nc">term</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span><span class="tok-w"> </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s advice&quot;</span><span class="tok-p">&gt;&gt;</span>

<span class="tok-nc">term</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph principle">
<p>Semi-colons are completely optional in dADL.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_paths"><a class="anchor" href="#_paths"></a>4.3. Paths</h3>
<div class="paragraph">
<p>Because dADL data is hierarchical, and all nodes are uniquely identified, a reliable path can be determined for every node in a dADL text. The syntax of paths in dADL is the standard ADL path syntax, described in detail in <a href="#_adl_paths">Section 7</a>. Paths are directly convertible to XPath expressions for use in XML-encoded data.</p>
</div>
<div class="paragraph">
<p>A typical ADL path used to refer to a node in a dADL text is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code><span></span>/term_definitions[&quot;en&quot;]/items[&quot;at0001&quot;]/text</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the following sections, paths are shown for all the dADL data examples.</p>
</div>
</div>
<div class="sect2">
<h3 id="_structure_2"><a class="anchor" href="#_structure_2"></a>4.4. Structure</h3>
<div class="sect3">
<h4 id="_general_form"><a class="anchor" href="#_general_form"></a>4.4.1. General Form</h4>
<div class="paragraph">
<p>A dADL document expresses serialised instances of one or more complex objects. Each such instance is a hierarchy of attribute names and object values. In its simplest form, a dADL text consists of repetitions of the following pattern:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attribute_name '=' '&lt;' value '&gt;' ;</pre>
</div>
</div>
<div class="paragraph">
<p>Each attribute name is the name of an attribute in an implied or actual object or relational model. Each "value" is either a literal value of a primitive type (see <a href="#_primitive_types">Section 4.5.1</a>) or a further nesting of attribute names and values, terminating in leaf nodes of primitive type values. Where sibling attribute nodes occur, the attribute identifiers must be unique, just as in a standard object or relational model.</p>
</div>
<div class="paragraph principle">
<p>Sibling attribute names must be unique.</p>
</div>
<div class="paragraph">
<p>The following shows a typical structure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">attr_1</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-nc">attr_2</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">attr_3</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">leaf_value</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">attr_4</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">leaf_value</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">attr_5</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">attr_3</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">attr_6</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">leaf_value</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">attr_7</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">leaf_value</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span>
<span class="tok-nc">attr_8</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above structure, each "&lt;&gt;" encloses an instance of some type. The hierarchical structure corresponds to the part-of relationship between objects, otherwise known as <em>composition</em> and <em>aggregation</em> relationships in object-oriented formalisms such as UML (the difference between the two is usually described as being "sub-objects related by aggregation can have independent lifetimes, whereas sub-objects related by composition have co-terminal lifetimes and are always destroyed with the parent"; dADL does not differentiate between the two, since it is the business of a model, not the data, to express such semantics). Associations between instances in dADL are also representable by references, and are described in <a href="#_associations_and_shared_objects">Section 4.4.6</a>.</p>
</div>
<div class="sect4">
<h5 id="_outer_delimiters"><a class="anchor" href="#_outer_delimiters"></a>4.4.1.1. Outer Delimiters</h5>
<div class="paragraph">
<p>To be completely regular, an outer level of delimiters should be used, because the totality of a dADL text is an object, not a collection of disembodied attribute/object pairs. However, the outermost delimiters can be left out in order to improve readability, and without complicating the parsing process. The completely regular form would appear as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>&lt;
    attr_1 = &lt;
    &gt;
    attr_8 = &lt;&gt;
&gt;</pre>
</div>
</div>
<div class="paragraph principle">
<p>Outer '&lt;&gt;' delimiters in a dADL text are optional.</p>
</div>
</div>
<div class="sect4">
<h5 id="_paths_2"><a class="anchor" href="#_paths_2"></a>4.4.1.2. Paths</h5>
<div class="paragraph">
<p>The complete set of paths for the above example is as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_2</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_2</span><span class="tok-p">/</span><span class="tok-nc">attr_3</span><span class="tok-w">           </span><span class="tok-c">-- path to a leaf value</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_2</span><span class="tok-p">/</span><span class="tok-nc">attr_4</span><span class="tok-w">           </span><span class="tok-c">-- path to a leaf value</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_5</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_5</span><span class="tok-p">/</span><span class="tok-nc">attr_3</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_5</span><span class="tok-p">/</span><span class="tok-nc">attr_3</span><span class="tok-p">/</span><span class="tok-nc">attr_6</span><span class="tok-w">    </span><span class="tok-c">-- path to a leaf value</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_1</span><span class="tok-p">/</span><span class="tok-nc">attr_5</span><span class="tok-p">/</span><span class="tok-nc">attr_7</span><span class="tok-w">           </span><span class="tok-c">-- path to a leaf value</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">attr_8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The path syntax used with dADL maps trivially to W3C Xpath and Xquery paths, and is described in <a href="#_paths">Section 4.3</a>.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_empty_sections"><a class="anchor" href="#_empty_sections"></a>4.4.2. Empty Sections</h4>
<div class="paragraph">
<p>Empty sections are allowed at both internal and leaf node levels, enabling the author to express the fact that there is in some particular instance, no data for an attribute, while still showing that the attribute itself is expected to exist in the underlying information model. An empty section looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">address</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w">    </span><span class="tok-c">-- person&#39;s address</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Nested empty sections can be used.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
within this document, empty sections are shown in many places to represent fully populated data, which would of course require much more space.
</td>
</tr>
</table>
</div>
<div class="paragraph principle">
<p>Empty sections can appear anywhere.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_objects"><a class="anchor" href="#_container_objects"></a>4.4.3. Container Objects</h4>
<div class="paragraph">
<p>The syntax described so far allows an instance of an arbitrarily large object to be expressed, but does not support attributes of container types such as lists, sets and hash tables, i.e. items whose type in an underlying reference model is something like <code>attr:List&lt;Type&gt;</code> , <code>attr:Set&lt;Type&gt;</code> or <code>attr: Hash&lt;ValueType, KeyType&gt;</code> . There are two ways instance data of such container objects can be expressed in dADL. The first applies to leaf values and is to use a list style literal value for , where the "list nature" of the data is expressed within the manifest value itself, as in the following examples.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">fruits</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;pear&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;cumquat&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;peach&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-nc">some_primes</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-mi">1</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">2</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">3</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">5</span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>See <a href="#_lists_of_built_in_types">Section 4.5.4</a> for the complete description of list leaf types. This approach is fine for leaf data.  However for containers holding non-primitive values, including more container objects, a different syntax is needed. Consider by way of example that an instance of the container <code>List&lt;Person&gt;</code> could in theory be expressed as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-c">-- WARNING: THIS IS NOT VALID dADL</span>

<span class="tok-nc">people</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">sex</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">date_of_birth</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">sex</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-c">-- etc</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, 'anonymous' blocks of data are repeated inside the outer block. However, this makes the data hard to read, and does not provide an easy way of constructing paths to the contained items. A better syntax becomes more obvious when we consider that members of container objects in their computable form are nearly always accessed by a method such as <code>member(i)</code> , <code>item[i]</code> or just plain <code>[i]</code> , in the case of array access in the C-based languages.</p>
</div>
<div class="paragraph">
<p>dADL opts for the array-style syntax, known in dADL as container member <em>keys</em>. No attribute name is explicitly given; any primitive comparable value is allowed as the key, rather than just integers used in C-style array access. Further, if integers are used, it is not assumed that they dictate ordinal indexing, i.e. it is possible to use a series of keys <code>[2]</code> , <code>[4]</code> , <code>[8]</code> etc. The following example shows one version of the above container in valid dADL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">people</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Strings and dates may also be used. Keys are coloured blue in the this specification in order to distinguish the run-time status of key values from the design-time status of class and attribute names. The following example shows the use of string values as keys for the contained items.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">people</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;akmal:1975-04-22&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;akmal:1962-02-11&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;gianni:1978-11-30&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">birth_date</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-nc">interests</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span><span class="tok-w"> </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The syntax for primitive values used as keys follows exactly the same syntax described below for data of primitive types. It is convenient in some cases to construct key values from one or more of the values of the contained items, in the same way as relational database keys are constructed from sufficient field values to guarantee uniqueness. However, they need not be - they may be independent of the contained data, as in the case of hash tables, where the keys are part of the hash table structure, or equally, they may simply be integer index values, as in the 'locations' attribute in the 'school_schedule' structure shown below.</p>
</div>
<div class="paragraph">
<p>Container structures can appear anywhere in an overall instance structure, allowing complex data such as the following to be expressed in a readable way.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">school_schedule</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-nc">lesson_times</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">08:30:00</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-ld">09:30:00</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-ld">10:30:00</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">locations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;under the big plane tree&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;under the north arch&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;in a garden&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">subjects</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;philosophy:plato&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-w"> </span><span class="tok-c">-- note construction of key</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;philosophy&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">teacher</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plato&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">topics</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;meta-physics&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;natural science&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">weighting</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-mi">76%</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;philosophy:kant&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;philosophy&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">teacher</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;kant&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">topics</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;meaning and reason&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;meta-physics&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;ethics&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">weighting</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-mi">80%</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;art&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;art&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">teacher</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;goya&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">topics</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;technique&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;portraiture&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;satire&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">weighting</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-mi">78%</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph principle">
<p><strong>Container instances</strong> are expressed using repetitions of a block introduced by a key, in the form of a primitive value in brackets i.e. '[]'.</p>
</div>
<div class="paragraph">
<p>The example above conforms directly to the object-oriented type specification (given in a pascal-like syntax):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="idl"><span></span>class<span class="tok-w"> </span>SCHEDULE
<span class="tok-w">    </span>lesson_times<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">List</span><span class="tok-o">&lt;</span>Time<span class="tok-o">&gt;</span>
<span class="tok-w">    </span>locations<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">List</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span>
<span class="tok-w">    </span>subjects<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">List</span><span class="tok-o">&lt;</span>SUBJECT<span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-o">--</span><span class="tok-w"> </span><span class="tok-k">or</span><span class="tok-w"> </span>it<span class="tok-w"> </span>could<span class="tok-w"> </span>be<span class="tok-w"> </span><span class="tok-nb">Hash</span><span class="tok-o">&lt;</span>SUBJECT<span class="tok-o">&gt;</span>
<span class="tok-k">end</span>

class<span class="tok-w"> </span>SUBJECT
<span class="tok-w">    </span>name<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">String</span>
<span class="tok-w">    </span>teacher<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">String</span>
<span class="tok-w">    </span>topics<span class="tok-o">:</span><span class="tok-w"> </span><span class="tok-nb">List</span><span class="tok-o">&lt;</span><span class="tok-nb">String</span><span class="tok-o">&gt;</span>
<span class="tok-w">    </span>weighting<span class="tok-o">:</span><span class="tok-w"> </span>Real
<span class="tok-k">end</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Other class specifications corresponding to the same data are possible, but will all be isomorphic to the above.</p>
</div>
<div class="paragraph">
<p>How key values relate to a particular object structure depends on the object model being used during the dADL parsing process. It is possible to write a parser which makes reasonable inferences from an information model whose instances are represented as dADL text; it is also possible to include explicit typing information in the dADL itself (see <a href="#_adding_type_information">Section 4.4.5</a> below).</p>
</div>
<div class="sect4">
<h5 id="_paths_3"><a class="anchor" href="#_paths_3"></a>4.4.3.1. Paths</h5>
<div class="paragraph">
<p>Paths through container objects are formed in the same way as paths in other structured data, with the addition of the key, to ensure uniqueness. The key is included syntactically enclosed in brackets, in a similar way to Xpath predicates. Paths through containers in the above example include the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-p">/</span><span class="tok-nc">school_schedule</span><span class="tok-p">/</span><span class="tok-nc">locations</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w">                   </span><span class="tok-c">-- path to &quot;under the big...&quot;</span>
<span class="tok-p">/</span><span class="tok-nc">school_schedule</span><span class="tok-p">/</span><span class="tok-nc">subjects</span><span class="tok-p">[</span><span class="tok-s">&quot;philosophy:kant&quot;</span><span class="tok-p">]</span><span class="tok-w">    </span><span class="tok-c">-- path to &quot;kant&quot;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_nested_container_objects"><a class="anchor" href="#_nested_container_objects"></a>4.4.4. Nested Container Objects</h4>
<div class="paragraph">
<p>In some cases the data of interest are instances of nested container types, such as <code>List&lt;List&lt;Message&gt;&gt;</code> (a list of Message lists) or <code>Hash&lt;List&lt;Integer&gt;, String&gt;</code> (a hash of integer lists keyed by strings). The dADL syntax for such structures follows directly from the syntax for a single container object. The following example shows an instance of the type <code>List&lt;List&lt;String&gt;&gt;</code> expressed in dADL syntax.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">list_of_string_lists</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;first string in first list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;second string in first list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;first string in second list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;second string in second list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;third string in second list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-mi">3</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;only string in third list&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_paths_4"><a class="anchor" href="#_paths_4"></a>4.4.4.1. Paths</h5>
<div class="paragraph">
<p>The paths of the above example are as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-p">/</span><span class="tok-nc">list_of_string_lists</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]/[</span><span class="tok-mi">1</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">list_of_string_lists</span><span class="tok-p">[</span><span class="tok-mi">1</span><span class="tok-p">]/[</span><span class="tok-mi">2</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">list_of_string_lists</span><span class="tok-p">[</span><span class="tok-mi">2</span><span class="tok-p">]/[</span><span class="tok-mi">1</span><span class="tok-p">]</span>
<span class="tok-nc">etc</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_adding_type_information"><a class="anchor" href="#_adding_type_information"></a>4.4.5. Adding Type Information</h4>
<div class="paragraph">
<p>In many cases, dADL data is of a simple structure, very regular, and highly repetitive, such as the expression of simple demographic data. In such cases, it is preferable to express as little as possible about the implied reference model of the data (i.e. the object or relational model to which it conforms), since various software components want to use the data, and use it in different ways. However, there are also cases where the data is highly complex, and more model information is needed to help software parse it,. Examples include large design databases such as for aircraft, and health records. Typing information is added to instance data using a syntactical addition inspired by the <code>(type)</code> casting operator of the C language, whose meaning is approximately: force the type of the result of the following expression to be <code>type</code>. In dADL typing is therefore done by including the type name in parentheses after the '=' sign, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">destinations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">TOURIST_DESTINATION</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">profile</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DESTINATION_PROFILE</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">hotels</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">HISTORIC_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">LUXURY_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">PENSION</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">attractions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;la corrida&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">SPORT_VENUE</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;Alcázar&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">HISTORIC_SITE</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that in the above, no type identifiers are included after the "hotels" and "attractions" attributes, and it is up to the processing software to infer the correct types (usually easy - it will be pre-determined by an information model). However, the complete typing information can be included, as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">hotels</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">List&lt;HOTEL&gt;</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">HISTORIC_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This illustrates the use of generic, i.e. template types, expressed in the standard UML syntax, using angle brackets. Any number of template arguments and any level of nesting is allowed, as in the UML. At first view, there may appear to be a risk of confusion between template type '&lt;&gt;' delimiters and the standard dADL block delimiters. However the parsing rules are easy to state; essentially the difference is that a dADL data block is always preceded by an '=' symbol.</p>
</div>
<div class="paragraph">
<p>Type identifiers can also include namespace information, which is necessary when same-named types appear in different packages of a model. Namespaces are included by prepending package names, separated by the '.' character, in the same way as in most programming languages, as in the qualified type names <code>org.openehr.rm.ehr.content.ENTRY</code> and <code>Core.Abstractions.Relationships.Relationship</code>.</p>
</div>
<div class="paragraph principle">
<p><strong>Type Information</strong> can be included optionally on any node immediately before the opening '&lt;' of any block, in the form of a UML-style type identifier in parentheses. Dot-separated namespace identifiers and template parameters may be used.</p>
</div>
</div>
<div class="sect3">
<h4 id="_associations_and_shared_objects"><a class="anchor" href="#_associations_and_shared_objects"></a>4.4.6. Associations and Shared Objects</h4>
<div class="paragraph">
<p>All of the facilities described so far allow any object-oriented data to be faithfully expressed in a formal, systematic way which is both machine- and human-readable, and allow any node in the data to be addressed using an Xpath-style path. The availability of reliable paths allows not only the representation of single 'business objects', which are the equivalent of UML <em>aggregation</em> (and <em>composition</em>) hierarchies, but also the representation of associations between objects, and by extension, shared objects.</p>
</div>
<div class="paragraph">
<p>Consider that in the example above, 'hotel' objects may be shared objects, referred to by association. This can be expressed as follows.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">destinations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">hotels</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span>
<span class="tok-nc">bookings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;seville:0134&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">customer_id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;0134&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">period</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">hotel</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span>
<span class="tok-nc">hotels</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">HISTORIC_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">LUXURY_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">PENSION</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Associations are expressed via the use of fully qualified paths as the data for an attribute. In this example, there are references from a list of destinations, and from a booking list, to the same hotel object. If type information is included, it should go in the declarations of the relevant objects; type declarations can also be used before path references, which might be useful if the association type is an ancestor type (i.e. more general type) of the type of the actual object being referred to.</p>
</div>
<div class="paragraph">
<p>Data in other dADL documents can be referred to using the URI syntax to locate the document, with the internal path included as described above.</p>
</div>
<div class="paragraph principle">
<p><strong>Shared objects</strong> are referenced using paths. Objects in other dADL documents can be referred to using normal URIs whose path section conforms to dADL path syntax.</p>
</div>
<div class="sect4">
<h5 id="_paths_5"><a class="anchor" href="#_paths_5"></a>4.4.6.1. Paths</h5>
<div class="paragraph">
<p>The path set from the above example is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-p">/</span><span class="tok-nc">destinations</span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">destinations</span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">destinations</span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">bookings</span><span class="tok-p">[</span><span class="tok-s">&quot;seville:0134&quot;</span><span class="tok-p">]/</span><span class="tok-nc">customer_id</span>
<span class="tok-p">/</span><span class="tok-nc">bookings</span><span class="tok-p">[</span><span class="tok-s">&quot;seville:0134&quot;</span><span class="tok-p">]/</span><span class="tok-nc">period</span>
<span class="tok-p">/</span><span class="tok-nc">bookings</span><span class="tok-p">[</span><span class="tok-s">&quot;seville:0134&quot;</span><span class="tok-p">]/</span><span class="tok-nc">hotel</span>
<span class="tok-p">/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;sofitel&quot;</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;hotel real&quot;</span><span class="tok-p">]</span>
<span class="tok-p">/</span><span class="tok-nc">hotels</span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_leaf_data_built_in_types"><a class="anchor" href="#_leaf_data_built_in_types"></a>4.5. Leaf Data - Built-in Types</h3>
<div class="paragraph">
<p>All dADL data eventually devolve to instances of the primitive types <code>String</code>, <code>Integer</code>, <code>Real</code>, <code>Double</code>, <code>String</code>, <code>Character</code>, various date/time types, lists or intervals of these types, and a few special types. dADL does not use type or attribute names for instances of primitive types, only manifest values, making it possible to assume as little as possible about type names and structures of the primitive types. In all the following examples, the manifest data values are assumed to appear immediately inside a leaf pair of angle brackets, i.e.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>some_attribute = &lt;manifest value here&gt;</pre>
</div>
</div>
<div class="sect3">
<h4 id="_primitive_types"><a class="anchor" href="#_primitive_types"></a>4.5.1. Primitive Types</h4>
<div class="sect4">
<h5 id="_character_data"><a class="anchor" href="#_character_data"></a>4.5.1.1. Character Data</h5>
<div class="paragraph">
<p>Characters are shown in a number of ways. In the literal form, a character is shown in single quotes,
as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>'a'</pre>
</div>
</div>
<div class="paragraph">
<p>Characters outside the low ASCII (0-127) range must be UTF-8 encoded, with a small number of backslash-quoted ASCII characters allowed, as described in <a href="#_file_encoding_and_character_quoting">Section 3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_string_data"><a class="anchor" href="#_string_data"></a>4.5.1.2. String Data</h5>
<div class="paragraph">
<p>All strings are enclosed in double quotes, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"this is a string"</pre>
</div>
</div>
<div class="paragraph">
<p>Quotes are encoded using ISO/IEC 10646 codes, e.g. :</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"this is a much longer string, what one might call a &amp;quot;phrase&amp;quot;."</pre>
</div>
</div>
<div class="paragraph">
<p>Line extension of strings is done simply by including returns in the string. The exact contents of the string are computed as being the characters between the double quote characters, with the removal of white space leaders up to the left-most character of the first line of the string. This has the effect of allowing the inclusion of multi-line strings in dADL texts, in their most natural human-readable form, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;And now the STORM-BLAST came, and he</span>
<span class="tok-s">        Was tyrannous and strong :</span>
<span class="tok-s">        He struck with his o&#39;ertaking wings,</span>
<span class="tok-s">        And chased us south along.&quot;</span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>String data can be used to contain almost any other kind of data, which is intended to be parsed as some other formalism. Characters outside the low ASCII (0-127) range must be UTF-8 encoded, with a small number of backslash-quoted ASCII characters allowed, as described in <a href="#_file_encoding_and_character_quoting">Section 3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_integer_data"><a class="anchor" href="#_integer_data"></a>4.5.1.3. Integer Data</h5>
<div class="paragraph">
<p>Integers are represented simply as numbers, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>25
300000
29e6</pre>
</div>
</div>
<div class="paragraph">
<p>Commas or periods for breaking long numbers are not allowed, since they confuse the use of commas used to denote list items (see <a href="#_lists_of_built_in_types">Section 4.5.4</a> below).</p>
</div>
</div>
<div class="sect4">
<h5 id="_real_data"><a class="anchor" href="#_real_data"></a>4.5.1.4. Real Data</h5>
<div class="paragraph">
<p>Real numbers are assumed whenever a decimal is detected in a number, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>25.0
3.1415926
6.023e23</pre>
</div>
</div>
<div class="paragraph">
<p>Commas or periods for breaking long numbers are not allowed. Only periods may be used to separate the decimal part of a number; unfortunately, the European use of the comma for this purpose conflicts with the use of the comma to distinguish list items (see <a href="#_lists_of_built_in_types">Section 4.5.4</a> below).</p>
</div>
</div>
<div class="sect4">
<h5 id="_boolean_data"><a class="anchor" href="#_boolean_data"></a>4.5.1.5. Boolean Data</h5>
<div class="paragraph">
<p>Boolean values can be indicated by the following values (case-insensitive):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>True
False</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_dates_and_times"><a class="anchor" href="#_dates_and_times"></a>4.5.1.6. Dates and Times</h5>
<div class="sect5">
<h6 id="_complete_datetimes"><a class="anchor" href="#_complete_datetimes"></a>Complete Date/Times</h6>
<div class="paragraph">
<p>In dADL, full and partial dates, times and durations can be expressed. All full dates, times and durations are expressed using a subset of <a href="https://en.wikipedia.org/wiki/ISO_8601">ISO 8601</a>. The Support IM provides a full explanation of the ISO 8601 semantics supported in openEHR.</p>
</div>
<div class="paragraph">
<p>In dADL, the use of ISO 8601 allows extended form only (i.e. ':' and '-' must be used). The ISO 8601 method of representing partial dates consisting of a single year number, and partial times consisting of hours only are not supported, since they are ambiguous. See below for partial forms. Patterns for complete dates and times in dADL include the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yyyy-MM-dd                      -- a date
hh:mm:ss[,sss][Z|+/-hhmm]       -- a time with optional seconds
yyyy-MM-ddThh:mm:ss[,sss][Z]    -- a date/time</pre>
</div>
</div>
<div class="paragraph">
<p>where:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yyyy = four-digit year
MM = month in year
dd = day in month
hh = hour in 24 hour clock
mm = minutes
ss,sss = seconds, incuding fractional part
Z = the timezone in the form of a '+' or '-' followed by 4 digits indicating the hour offset, e.g. +0930, or else the literal 'Z' indicating +0000 (the Greenwich meridian).</pre>
</div>
</div>
<div class="paragraph">
<p>Durations are expressed using a string which starts with 'P', and is followed by a list of periods, each appended by a single letter designator: 'Y' for years, "M' for months, 'W' for weeks, 'D' for days, 'H' for hours, 'M' for minutes, and 'S' for seconds. The literal 'T' separates the YMWD part from the HMS part, ensuring that months and minutes can be distinguished. Examples of date/time data include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1919-01-23                  -- birthdate of Django Reinhardt
16:35:04,5                  -- rise of Venus in Sydney on 24 Jul 2003
2001-05-12T07:35:20+1000    -- timestamp on an email received from Australia
P22D4TH15M0S                -- period of 22 days, 4 hours, 15 minutes</pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_partial_datetimes"><a class="anchor" href="#_partial_datetimes"></a>Partial Date/Times</h6>
<div class="paragraph">
<p>Two ways of expressing partial (i.e. incomplete) date/times are supported in dADL. The ISO 8601 incomplete formats are supported in extended form only (i.e. with '-' and ':' separators) for all patterns that are unambiguous on their own. Dates consisting of only the year, and times consisting of only the hour are not supported, since both of these syntactically look like integers. The supported ISO 8601 patterns are as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yyyy-MM             -- a date with no days
hh:mm               -- a time with no seconds
yyyy-MM-ddThh:mm    -- a date/time with no seconds
yyyy-MM-ddThh       -- a date/time, no minutes or seconds</pre>
</div>
</div>
<div class="paragraph">
<p>To deal with the limitations of ISO 8601 partial patterns in a context-free parsing environment, a second form of pattern is supported in dADL, based on ISO 8601. In this form, '?' characters are substituted for missing digits. Valid partial dates follow the patterns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yyyy-MM-??  -- date with unknown day in month
yyyy-??-??  -- date with unknown month and day</pre>
</div>
</div>
<div class="paragraph">
<p>Valid partial times follow the patterns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>hh:mm:?? -- time with unknown seconds
hh:??:?? -- time with unknown minutes and seconds</pre>
</div>
</div>
<div class="paragraph">
<p>Valid date/times follow the patterns:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>yyyy-MM-ddThh:mm:?? -- date/time with unknown seconds
yyyy-MM-ddThh:??:?? -- date/time with unknown minutes and seconds
yyyy-MM-ddT??:??:?? -- date/time with unknown time
yyyy-MM-??T??:??:?? -- date/time with unknown day and time
yyyy-??-??T??:??:?? -- date/time with unknown month, day and time</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_intervals_of_ordered_primitive_types"><a class="anchor" href="#_intervals_of_ordered_primitive_types"></a>4.5.2. Intervals of Ordered Primitive Types</h4>
<div class="paragraph">
<p>Intervals of any ordered primitive type, i.e., <code>Integer</code>, <code>Real</code>, <code>Date</code>, <code>Time</code>, <code>Date_time</code> and <code>Duration</code>, can be stated using the following uniform syntax, where <code>N</code>, <code>M</code> are instances of any of the ordered types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>|N..M|      -- the two-sided range N &gt;= x &lt;= M
|N&gt;..M|     -- the two-sided range N &gt; x &lt;= M
|N..&lt;M|     -- the two-sided range N &gt;= x &lt;M
|N&gt;..&lt;M|    -- the two-sided range N &gt; x &lt;M
|&lt;N|        -- the one-sided range x &lt; N
|&gt;N|        -- the one-sided range x &gt; N
|&gt;=N|       -- the one-sided range x &gt;= N
|&lt;=N|       -- the one-sided range x &lt;= N
|N +/-M|    -- interval of N ± M</pre>
</div>
</div>
<div class="paragraph">
<p>The allowable values for <code>N</code> and <code>M</code> include any value in the range of the relevant type, as well as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>infinity
-infinity
* equivalent to infinity</pre>
</div>
</div>
<div class="paragraph">
<p>Examples of this syntax include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>|0..5|          -- integer interval
|0.0..1000.0|   -- real interval
|0.0..&lt;1000.0|  -- real interval 0.0 &gt;= x &lt; 1000.0
|08:02..09:10|  -- interval of time
|&gt;= 1939-02-01| -- open-ended interval of dates
|5.0 +/-0.5|    -- 4.5 - 5.5
|&gt;=0|           -- &gt;= 0
|0..infinity|   -- 0 - infinity (i.e. &gt;= 0)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_other_built_in_types"><a class="anchor" href="#_other_built_in_types"></a>4.5.3. Other Built-in Types</h4>
<div class="sect4">
<h5 id="_uris"><a class="anchor" href="#_uris"></a>4.5.3.1. URIs</h5>
<div class="paragraph">
<p>URI can be expressed as dADL data in the usual way found on the web, and follow the standard syntax from <code><a href="http://www.ietf.org/rfc/rfc3986.txt" class="bare">http://www.ietf.org/rfc/rfc3986.txt</a></code>. Examples of URIs in dADL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>http://archetypes.are.us/home.html
ftp://get.this.file.com#section_5
http://www.mozilla.org/products/firefox/upgrade/?application=thunderbird</pre>
</div>
</div>
<div class="paragraph">
<p>Encoding of special characters in URIs follows the <a href="https://tools.ietf.org/html/rfc3986" target="_blank" rel="noopener">IETF RFC 3986</a>, as described under <a href="#_file_encoding_and_character_quoting">Section 3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_coded_terms"><a class="anchor" href="#_coded_terms"></a>4.5.3.2. Coded Terms</h5>
<div class="paragraph">
<p>Coded terms are ubiquitous in medical and clinical information, and are likely to become so in most other industries, as ontologically-based information systems and the 'semantic web' emerge. The logical structure of a coded term is simple: it consists of an identifier of a terminology, and an identifier of a code within that terminology. The dADL string representation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[terminology_id::code]</pre>
</div>
</div>
<div class="paragraph">
<p>Typical examples from clinical data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>[icd10AM::F60.1] -- from ICD10AM
[snomed-ct::2004950] -- from snomed-ct
[snomed-ct(3.1)::2004950] -- from snomed-ct v 3.1</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_lists_of_built_in_types"><a class="anchor" href="#_lists_of_built_in_types"></a>4.5.4. Lists of Built-in Types</h4>
<div class="paragraph">
<p>Data of any primitive type can occur singly or in lists, which are shown as comma-separated lists of item, all of the same type, such as in the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"cyan", "magenta", "yellow", "black" -- printer's colours
1, 1, 2, 3, 5 -- first 5 fibonacci numbers
08:02, 08:35, 09:10 -- set of train times</pre>
</div>
</div>
<div class="paragraph">
<p>No assumption is made in the syntax about whether a list represents a set, a list or some other kind of sequence - such semantics must be taken from an underlying information model.</p>
</div>
<div class="paragraph">
<p>Lists which happen to have only one datum are indicated by using a comma followed by a list continuation marker of three dots, i.e. "&#8230;&#8203;", e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>"en", ... -- languages
"icd10", ... -- terminologies
[at0200], ...</pre>
</div>
</div>
<div class="paragraph">
<p>White space may be freely used or avoided in lists, i.e. the following two lists are identical:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1,1,2,3
1, 1, 2,3</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_plug_in_syntaxes"><a class="anchor" href="#_plug_in_syntaxes"></a>4.6. Plug-in Syntaxes</h3>
<div class="paragraph">
<p>Using the dADL syntax, any object structure can be serialised. In some cases, the requirement is to express some part of the structure in an abstract syntax, rather than in the more literal serialised object form of dADL. dADL provides for this possibility by allowing the value of any object (i.e. what appears between any matching pair of <code>&lt;&gt;</code> delimiters) to be expressed in some other syntax, known as a "plug-in" syntax. Plug-in syntaxes are indicated in dADL in a similar way as typed objects, i.e. by the use of the syntax type in parentheses preceding the <code>&lt;&gt;</code> block. For a plug-in section, the &lt;&gt; delimiters are modified to <code>&lt;# #&gt;</code>, to allow for easier parser design, and easier recognition of such blocks by human readers. The general form is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>attr_name = (syntax) &lt;#
    ...
#&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The following example illustrates a cADL plug-in section in an archetype, which it itself a dADL document:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>definition = (cadl) &lt;#
    ENTRY[at0000] ∈ { -- blood pressure measurement
        name ∈ { -- any synonym of BP
            CODED_TEXT ∈ {
                code ∈ {
                    CODE_PHRASE ∈ {[ac0001]}
                }
            }
        }
    }
#&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Clearly, many plug-in syntaxes might one day be used within dADL data; there is no guarantee that every dADL parser will support them. The general approach to parsing should be to use plug-in parsers, i.e. to obtain a parser for a plug-in syntax that can be built into the existing parser framework.</p>
</div>
</div>
<div class="sect2">
<h3 id="_expression_of_dadl_in_xml"><a class="anchor" href="#_expression_of_dadl_in_xml"></a>4.7. Expression of dADL in XML</h3>
<div class="paragraph">
<p>The dADL syntax maps quite easily to XML instance. It is important to realise that people using XML often develop different mappings for object-oriented data, due to the fact that XML does not have systematic object-oriented semantics. This is particularly the case where containers such as lists and sets such as <code>employees: List&lt;Person&gt;</code> are mapped to XML; many implementors have to invent additional tags such as 'employee' to make the mapping appear visually correct. The particular mapping chosen here is designed to be a faithful reflection of the semantics of the object-oriented data, and does not try take into account visual aesthetics of the XML. The result is that Xpath expressions are the same for dADL and XML, and also correspond to what one would expect based on an underlying object model. The main elements of the mapping are as follows.</p>
</div>
<div class="sect3">
<h4 id="_single_attributes"><a class="anchor" href="#_single_attributes"></a>4.7.1. Single Attributes</h4>
<div class="paragraph">
<p>Single attribute nodes map to tagged nodes of the same name.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_attributes"><a class="anchor" href="#_container_attributes"></a>4.7.2. Container Attributes</h4>
<div class="paragraph">
<p>Container attribute nodes map to a series of tagged nodes of the same name, each with the XML attribute <code><em>id</em></code> set to the dADL key. For example, the dADL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">subjects</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;philosophy:plato&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;philosophy&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;philosophy:kant&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;philosophy&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>maps to the XML:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;subjects</span><span class="tok-w"> </span><span class="tok-na">id=</span><span class="tok-s">&quot;philosophy:plato&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;name&gt;</span>
<span class="tok-w">        </span>philosophy
<span class="tok-w">    </span><span class="tok-nt">&lt;/name&gt;</span>
<span class="tok-nt">&lt;/subjects&gt;</span>
<span class="tok-nt">&lt;subjects</span><span class="tok-w"> </span><span class="tok-na">id=</span><span class="tok-s">&quot;philosophy:kant&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;name&gt;</span>
<span class="tok-w">        </span>philosophy
<span class="tok-w">    </span><span class="tok-nt">&lt;/name&gt;</span>
<span class="tok-nt">&lt;/subjects&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This guarantees that the path <code>subjects[@id="philosophy:plato"]/name</code> navigates to the same element in both dADL and the XML.</p>
</div>
</div>
<div class="sect3">
<h4 id="_nested_container_attributes"><a class="anchor" href="#_nested_container_attributes"></a>4.7.3. Nested Container Attributes</h4>
<div class="paragraph">
<p>Nested container attribute nodes map to a series of tagged nodes of the same name, each with the XML attribute <code><em>id</em></code> set to the dADL key. For example, consider an object structure defined by the signature <code>countries:Hash&lt;Hash&lt;Hotel,String&gt;,String&gt;</code>. An instance of this in dADL looks as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">countries</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;spain&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;hotels&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;attractions&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;egypt&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;hotels&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;attractions&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>can be mapped to the XML in which the synthesised element tag "_items" and the attribute "key" are used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;countries</span><span class="tok-w"> </span><span class="tok-na">key=</span><span class="tok-s">&quot;spain&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;_items</span><span class="tok-w"> </span><span class="tok-na">key=</span><span class="tok-s">&quot;hotels&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/_items&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;_items</span><span class="tok-w"> </span><span class="tok-na">key=</span><span class="tok-s">&quot;attractions&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/_items&gt;</span>
<span class="tok-nt">&lt;/countries&gt;</span>
<span class="tok-nt">&lt;countries</span><span class="tok-w"> </span><span class="tok-na">key=</span><span class="tok-s">&quot;eqypt&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;_items</span><span class="tok-w"> </span><span class="tok-na">id=</span><span class="tok-s">&quot;hotels&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/_items&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;_items</span><span class="tok-w"> </span><span class="tok-na">key=</span><span class="tok-s">&quot;attractions&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/_items&gt;</span>
<span class="tok-nt">&lt;/countries&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this case, the dADL path countries["spain"]/["hotels"] will be transformed to the Xpath <code>countries[@key="spain"]/_items[@key="hotels"]</code> in order to navigate to the same element.</p>
</div>
</div>
<div class="sect3">
<h4 id="_type_names"><a class="anchor" href="#_type_names"></a>4.7.4. Type Names</h4>
<div class="paragraph">
<p>Type names map to XML 'type' attributes e.g. the dADL:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">destinations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">TOURIST_DESTINATION</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">profile</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">DESTINATION_PROFILE</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">hotels</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">HISTORIC_HOTEL</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">&lt;&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>maps to:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xml"><span></span><span class="tok-nt">&lt;destinations</span><span class="tok-w"> </span><span class="tok-na">id=</span><span class="tok-s">&quot;seville&quot;</span><span class="tok-w"> </span><span class="tok-na">adl:type=</span><span class="tok-s">&quot;TOURIST_DESTINATION&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;profile</span><span class="tok-w"> </span><span class="tok-na">adl:type=</span><span class="tok-s">&quot;DESTINATION_PROFILE&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/profile&gt;</span>
<span class="tok-w">    </span><span class="tok-nt">&lt;hotels</span><span class="tok-w"> </span><span class="tok-na">id=</span><span class="tok-s">&quot;gran sevilla&quot;</span><span class="tok-w"> </span><span class="tok-na">adl:type=</span><span class="tok-s">&quot;HISTORIC_HOTEL&quot;</span><span class="tok-nt">&gt;</span>
<span class="tok-w">        </span>...
<span class="tok-w">    </span><span class="tok-nt">&lt;/hotels&gt;</span>
<span class="tok-nt">&lt;/destinations&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_specification"><a class="anchor" href="#_syntax_specification"></a>4.8. Syntax Specification</h3>
<div class="paragraph">
<p>The grammar and lexical specification for the standard dADL syntax is shown below. This grammar is implemented using lex (.l file) and yacc (.y file) specifications for in the Eiffel programming environment. The current release of these files is available at <a href="https://github.com/openEHR/adl-tools/tree/Release-1.4/libraries/common_libs/src/structures/syntax/dadl/parser" target="_blank" rel="noopener">Tag <code>Release-1.4</code> of the adl-tools Github repository</a>. The .l and .y files can be converted for use in another yacc/lex-based programming environment. The dADL production rules are also available as an <a href="https://github.com/openEHR/adl-tools/blob/Release-1.4/libraries/common_libs/src/structures/syntax/dadl/parser/dadl2_validator.html" target="_blank" rel="noopener">HTML document</a>.</p>
</div>
<div class="sect3">
<h4 id="_grammar"><a class="anchor" href="#_grammar"></a>4.8.1. Grammar</h4>
<div class="paragraph">
<p>The following provides the <a href="https://github.com/openEHR/adl-tools/blob/Release-1.4/libraries/common_libs/src/structures/syntax/dadl/parser/dadl2_validator.y" target="_blank" rel="noopener">dADL parser production rules</a> (yacc specification).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">input</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">attr_vals</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">complex_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">attr_vals</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">attr_val</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">attr_vals</span><span class="tok-w"> </span><span class="tok-nv">attr_val</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">attr_vals</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">attr_val</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">attr_val</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">attr_id</span><span class="tok-w"> </span><span class="tok-no">SYM_EQ</span><span class="tok-w"> </span><span class="tok-nv">object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">attr_id</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">complex_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">primitive_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">plugin_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">plugin_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_PLUGIN_SYNTAX_TYPE</span><span class="tok-w"> </span><span class="tok-no">V_PLUGIN_BLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">complex_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">single_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">multiple_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">multiple_attr_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">untyped_multiple_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-nv">untyped_multiple_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">untyped_multiple_attr_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">multiple_attr_object_block_head</span><span class="tok-w"> </span><span class="tok-nv">keyed_objects</span><span class="tok-w"> </span><span class="tok-no">SYM_END_DBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">multiple_attr_object_block_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_START_DBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">keyed_objects</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">keyed_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">keyed_objects</span><span class="tok-w"> </span><span class="tok-nv">keyed_object</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">keyed_object</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">object_key</span><span class="tok-w"> </span><span class="tok-no">SYM_EQ</span><span class="tok-w"> </span><span class="tok-nv">object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">object_key</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">simple_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">single_attr_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">untyped_single_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-nv">untyped_single_attr_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">untyped_single_attr_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">single_attr_object_complex_head</span><span class="tok-w"> </span><span class="tok-no">SYM_END_DBLOCK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">single_attr_object_complex_head</span><span class="tok-w"> </span><span class="tok-nv">attr_vals</span><span class="tok-w"> </span><span class="tok-no">SYM_END_DBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">single_attr_object_complex_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_START_DBLOCK</span>

<span class="tok-nv">primitive_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">untyped_primitive_object_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-nv">untyped_primitive_object_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">untyped_primitive_object_block</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_START_DBLOCK</span><span class="tok-w"> </span><span class="tok-nv">primitive_object_value</span><span class="tok-w"> </span><span class="tok-no">SYM_END_DBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_object_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">simple_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">simple_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">simple_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_list_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">simple_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">string_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">uri_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">simple_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">string_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">simple_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">integer_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">type_identifier</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-no">V_TYPE_IDENTIFIER</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-no">V_GENERIC_TYPE_IDENTIFIER</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_TYPE_IDENTIFIER</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_GENERIC_TYPE_IDENTIFIER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">string_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_STRING</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">string_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_STRING</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">V_STRING</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">string_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">V_STRING</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_STRING</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">integer_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_INTEGER</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-no">V_INTEGER</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">V_INTEGER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">integer_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">integer_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">real_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_REAL</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-no">V_REAL</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">V_REAL</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">real_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">real_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">character_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_CHARACTER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">character_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">character_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">character_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_EXTENDED_DATE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">time_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_EXTENDED_TIME</span>

<span class="tok-nv">time_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">time_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_time_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_EXTENDED_DATE_TIME</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_time_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">date_time_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">duration_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_DURATION</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">duration_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">duration_interval_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_INTERVAL_DELIM</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">term_code</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_QUALIFIED_TERM_CODE_REF</span>

<span class="tok-nv">term_code_list_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">term_code</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">term_code</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">term_code</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">uri_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_URI</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_symbols"><a class="anchor" href="#_symbols"></a>4.8.2. Symbols</h4>
<div class="paragraph">
<p>The following provides the <a href="https://github.com/openEHR/adl-tools/blob/Release-1.4/libraries/common_libs/src/structures/syntax/dadl/parser/dadl_scanner.l">dADL lexical analyser production rules</a> (lex specification) used in the <code>Release-1.4</code> parser:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>----------/* definitions */ -----------------------------------------------
ALPHANUM [a-zA-Z0-9]
IDCHAR [a-zA-Z0-9_]
NAMECHAR [a-zA-Z0-9._\-]
NAMECHAR_SPACE [a-zA-Z0-9._\- ]
NAMECHAR_PAREN [a-zA-Z0-9._\-()]
UTF8CHAR (([\xC2-\xDF][\x80-\xBF])|(\xE0[\xA0-\xBF][\x80-\xBF])|([\xE1-\xEF][\x80-\xBF][\x80-\xBF])|(\xF0[\x90-\xBF][\x80-\xBF][\x80-\xBF])|([\xF1-\xF7][\x80-\xBF][\x80-\xBF][\x80-\xBF]))

----------/** Separators **/---------------------------------------------
[ \t\r]+            -- Ignore separators
\n+                 -- (increment line count)

----------/** comments **/-----------------------------------------------
"--".*              -- Ignore comments
"--".*\n[ \t\r]*    -- (increment line count)

----------/* symbols */ -------------------------------------------------
"-"                 -- -&gt; Minus_code
"+"                 -- -&gt; Plus_code
"*"                 -- -&gt; Star_code
"/"                 -- -&gt; Slash_code
"^"                 -- -&gt; Caret_code
"."                 -- -&gt; Dot_code
";"                 -- -&gt; Semicolon_code
","                 -- -&gt; Comma_code
":"                 -- -&gt; Colon_code
"!"                 -- -&gt; Exclamation_code
"("                 -- -&gt; Left_parenthesis_code
")"                 -- -&gt; Right_parenthesis_code
"$"                 -- -&gt; Dollar_code
"??"                -- -&gt; SYM_DT_UNKNOWN
"?"                 -- -&gt; Question_mark_code
"|"                 -- -&gt; SYM_INTERVAL_DELIM
"["                 -- -&gt; Left_bracket_code
"]"                 -- -&gt; Right_bracket_code
"="                 -- -&gt; SYM_EQ
"&gt;="                -- -&gt; SYM_GE
"&lt;="                -- -&gt; SYM_LE
"&lt;"                 -- -&gt; SYM_LT or SYM_START_DBLOCK
"&gt;"                 -- -&gt; SYM_GT or SYM_END_DBLOCK

".."                -- -&gt; SYM_ELLIPSIS
"..."               -- -&gt; SYM_LIST_CONTINUE

----------/* keywords */ ---------------------------------------------
[Tt][Rr][Uu][Ee]                    -- -&gt; SYM_TRUE
[Ff][Aa][Ll][Ss][Ee]                -- -&gt; SYM_FALSE
[Ii][Nn][Ff][Ii][Nn][Ii][Tt][Yy]    -- -&gt; SYM_INFINITY

----------/* V_URI */ -------------------------------------------------
[a-z]+:\/\/[^&lt;&gt;|\\{}^~"\[\] ]*

----------/* V_QUALIFIED_TERM_CODE_REF form [ICD10AM(1998)::F23] */ -----
\[{NAMECHAR_PAREN}+::{NAMECHAR}+\]

----------/* ERR_V_QUALIFIED_TERM_CODE_REF */ -----
\[{NAMECHAR_PAREN}+::{NAMECHAR_SPACE}+\]

----------/* V_LOCAL_TERM_CODE_REF */ ---------------------------------
\[{ALPHANUM}{NAMECHAR}*\]

----------/* V_LOCAL_CODE */ ------------------------------------------
a[ct][0-9.]+

----------/* V_ISO8601_EXTENDED_DATE_TIME YYYY-MM-DDThh:mm:ss[,sss][Z|+/-nnnn] */ ---
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](,[0-9]+)?(Z|[+-][0-9]{4})? |
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9](Z|[+-][0-9]{4})? |
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9](Z|[+-][0-9]{4})?

----------/* V_ISO8601_EXTENDED_TIME hh:mm:ss[,sss][Z|+/-nnnn] */ --------
[0-2][0-9]:[0-6][0-9]:[0-6][0-9](,[0-9]+)?(Z|[+-][0-9]{4})? |
[0-2][0-9]:[0-6][0-9](Z|[+-][0-9]{4})?

----------/* V_ISO8601_EXTENDED_DATE YYYY-MM-DD */ ------------------------
[0-9]{4}-[0-1][0-9]-[0-3][0-9] |
[0-9]{4}-[0-1][0-9]

----------/* V_ISO8601_DURATION PnYnMnWnDTnnHnnMnnS */ -------------
-- here we allow a deviation from the standard to allow weeks to be
-- mixed in with the rest since this commonly occurs in medicine
P([0-9]+[yY])?([0-9]+[mM])?([0-9]+[wW])?([0-9]+[dD])?T([0-9]+[hH])?([0-9]+[mM])?([0-9]+[sS])? |
P([0-9]+[yY])?([0-9]+[mM])?([0-9]+[wW])?([0-9]+[dD])?

----------/* V_TYPE_IDENTIFIER */ ---------------------------------------
[A-Z]{IDCHAR}*

----------/* V_GENERIC_TYPE_IDENTIFIER */ -------------------------------
[A-Z]{IDCHAR}*&lt;[a-zA-Z0-9,_&lt;&gt;]+&gt;

----------/* V_ATTRIBUTE_IDENTIFIER */ ----------------------------------
[a-z]{IDCHAR}*

----------/* CADL Blocks */ -------------------------------------------

\{[^{}]* -- beginning of CADL block
&lt;IN_CADL_BLOCK&gt;\{[^{}]* -- got an open brace
&lt;IN_CADL_BLOCK&gt;[^{}]*\} -- got a close brace

----------/* V_INTEGER */ ----------------------------------------------
[0-9]+ |
[0-9]+[eE][+-]?[0-9]+

----------/* V_REAL */ -------------------------------------------------
[0-9]+\.[0-9]+|
[0-9]+\.[0-9]+[eE][+-]?[0-9]+

----------/* V_STRING */ -----------------------------------------------
\"[^\\\n"]*\"
\"[^\\\n"]*{ -- beginning of a multi-line string
&lt;IN_STR&gt; {
\\\\ -- match escaped backslash, i.e. \\ -&gt; \
\\\" -- match escaped double quote, i.e. \" -&gt; "
{UTF8CHAR}+ -- match UTF8 chars
[^\\\n"]+ -- match any other characters
\\\n[ \t\r]* -- match LF in line
[^\\\n"]*\" -- match final end of string
.|\n |
&lt;&lt;EOF&gt;&gt; -- unclosed String -&gt; ERR_STRING
}

----------/* V_CHARACTER */ --------------------------------------------
\'[^\\\n']\' -- normal character in 0-127
\'\\n\ -- \n
\'\\r\ -- \r
\'\\t\ -- \t
\'\\'\ -- \'
\'\\\\ -- \\
\'{UTF8CHAR}\' -- UTF8 char
\'.{1,2} |
\'\\[0-9]+(\/)? -- invalid character -&gt; ERR_CHARACTER</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_alternatives"><a class="anchor" href="#_syntax_alternatives"></a>4.9. Syntax Alternatives</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
the syntax in this section is not part of dADL
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_container_attributes_2"><a class="anchor" href="#_container_attributes_2"></a>4.9.1. Container Attributes</h4>
<div class="paragraph">
<p>A reasonable alternative to the syntax described above for nested container objects would have been to use an arbitrary member attribute name, such as "items", or perhaps "_items" (in order to indicate to a parser that the attribute name cannot be assumed to correspond to a real property in an object model), as well as the key for each container member, giving syntax like the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>people = &lt;
    _items[1] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _items[2] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _items[3] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Additionally, with this alternative, it becomes more obvious how to include the values of other properties of container types, such as ordering, maximum size and so on, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>people = &lt;
    _items[1] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _items[2] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _items[3] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _is_ordered = &lt;True&gt;
    _upper = <b class="conum">(200)</b>
&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Again, since the names of such properties in any given object technology cannot be assumed, the special underscore form of attribute names is used. However, we are now led to somewhat clumsy paths, where "_items" will occur very frequently, due to the ubiquity of containers in real data:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/people/_items[1]/
/people/_items[2]/
/people/_items[3]/
/people/_is_ordered/
/people/_upper/</pre>
</div>
</div>
<div class="paragraph">
<p>A compromise which satisfies the need for correct representation of all attributes of container types and the need for brevity and comprehensibility of paths would be to make optional the "_items", but retain other container pseudo-attributes (likely to be much more rarely used), thus:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>people = &lt;
    [1] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    [2] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    [3] = &lt;name = &lt;&gt; birth_date = &lt;&gt; interests = &lt;&gt;&gt;
    _is_ordered = &lt;True&gt;
    _upper = <b class="conum">(200)</b>
&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>The above form leads to the following paths:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>/people[1]/
/people[2]/
/people[3]/
/people/_is_ordered/
/people/_upper/</pre>
</div>
</div>
<div class="paragraph">
<p>The alternative syntax in this sub-section is not currently part of dADL, but could be included in the future, if there was a need to support more precise modelling of container types in dADL. If such support were to be added, it is recommended that the names of the pseudo-attributes ("_item", "_is_ordered" etc) be based on names of appopriate container types from a recognised standard such as OMG UML, OCL or IDL.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_cadl_constraint_adl"><a class="anchor" href="#_cadl_constraint_adl"></a>5. cADL - Constraint ADL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_3"><a class="anchor" href="#_overview_3"></a>5.1. Overview</h3>
<div class="paragraph">
<p>cADL is a syntax which enables constraints on data defined by object-oriented information models tobe expressed in archetypes or other knowledge definition formalisms. It is most useful for defining the specific allowable constructions of data whose instances conform to very general object models. cADL is used both at "design time", by authors and/or tools, and at runtime, by computational systems which validate data by comparing it to the appropriate sections of cADL in an archetype. The general appearance of cADL is illustrated by the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                             </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span><span class="tok-w">                          </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">   </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Some of the textual keywords in this example can be more efficiently rendered using common mathematical logic symbols. In the following example, the <code>matches</code> keyword has been replaced by an equivalent symbol:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                         </span><span class="tok-c">-- constraint on a PERSON instance</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                               </span><span class="tok-c">-- constraint on PERSON.name</span>
<span class="tok-w">            </span><span class="tok-nc">TEXT</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/..*/</span><span class="tok-p">}</span><span class="tok-w">                     </span><span class="tok-c">-- any non-empty string</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-c">-- constraint on</span>
<span class="tok-w">            </span><span class="tok-nc">ADDRESS</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                        </span><span class="tok-c">-- PERSON.addresses</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The full set of equivalences appears below. Raw cADL is stored in the text-based form, to remove any difficulties with representation of symbols, to avoid difficulties of authoring cADL text in normal text editors which do not supply such symbols, and to aid reading in English. However, the symbolic form might be more widely used due to the use of tools, and formatting in HTML and other documentary formats, and may be more comfortable for non-English speakers and those with formal mathematical backgrounds. This document uses both conventions. The use of symbols or text is completely a matter of taste, and no meaning whatsoever is lost by completely ignoring one or other format according to one&#8217;s personal preference.</p>
</div>
<div class="paragraph">
<p>In the standard cADL documented in this section, literal leaf values (such as the regular expression <code>/..*/</code> in the above example) are always constraints on a set of 'standard' widely-accepted primitive types, as described in <a href="#_dadl_data_adl">Section 4</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_basics_2"><a class="anchor" href="#_basics_2"></a>5.2. Basics</h3>
<div class="sect3">
<h4 id="_keywords_2"><a class="anchor" href="#_keywords_2"></a>5.2.1. Keywords</h4>
<div class="paragraph">
<p>The following keywords are recognised in cADL:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>matches</code>, <code>~matches</code>, <code>is_in</code>, <code>~is_in</code></p>
</li>
<li>
<p><code>occurrences</code>, <code>existence</code>, <code>cardinality</code></p>
</li>
<li>
<p><code>ordered</code>, <code>unordered</code>, <code>unique</code></p>
</li>
<li>
<p><code>infinity</code></p>
</li>
<li>
<p><code>use_node, allow_archetype</code></p>
</li>
<li>
<p><code>include</code>, <code>exclude</code></p>
</li>
<li>
<p><code>before</code> , <code>after</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Symbol equivalents for some of the above are given in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 16.6666%;">
<col style="width: 66.6668%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Textual<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Symbolic<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">matches</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∈</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set membership, "p is in P"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not, ~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∼</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Negation, "not p"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Keywords are shown in blue in this document.</p>
</div>
<div class="paragraph">
<p>The <code>matches</code> or <code>is_in</code> operator deserves special mention, since it is a key operator in cADL. This operator can be understood mathematically as set membership. When it occurs between a name and a block delimited by braces, the meaning is: the set of values allowed for the entity referred to by the name (either an object, or parts of an object - attributes) is specified between the braces. What appears between any matching pair of braces can be thought of as a specification for a set of values. Since blocks can be nested, this approach to specifying values can be understood in terms of nested sets, or in terms of a value space for objects of a set of defined types. Thus, in the following example, the <code>matches</code> operator links the name of an entity to a linear value space (i.e. a list), consisting of all words ending in "ion".</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/.*ion[^\s\n\t]/</span><span class="tok-p">}</span><span class="tok-w">      </span><span class="tok-c">-- the set of english words ending in &#39;ion&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following example links the name of a type <code>XXX</code> with a complex multi-dimensional value space.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">XXX</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">--</span>
<span class="tok-w">        </span><span class="tok-nc">YYY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..3</span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">                               </span><span class="tok-c">-- the value space of the</span>
<span class="tok-w">    </span><span class="tok-nc">bbb</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- and instance of XXX</span>
<span class="tok-w">        </span><span class="tok-nc">ZZZ</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">&gt;</span><span class="tok-ld">1992-12-01</span><span class="tok-p">}</span><span class="tok-w">   </span><span class="tok-c">--</span>
<span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">                               </span><span class="tok-c">--</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of the constraint structure above is: in data matching the constraints, there is an instance of type <code>XXX</code> whose attribute values recursively match the inner constraints named after those attributes, and so on, to the leaf level.</p>
</div>
<div class="paragraph">
<p>Occasionally, the matches operator needs to be used in the negative, usually at a leaf block. Any of the following can be used to constrain the value space of the attribute aaa to any number except 5:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">~matches </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span>
<span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">~is_in </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span>
<span class="tok-nc">aaa</span><span class="tok-w"> </span><span class="tok-o">∉</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">5</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The choice of whether to use <code>matches</code> or <code>is_in</code> is a matter of taste and background; those with a mathematical background will probably prefer <code>is_in</code>, while those with a data processing background may prefer <code>matches</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_comments_2"><a class="anchor" href="#_comments_2"></a>5.2.2. Comments</h4>
<div class="paragraph">
<p>In a cADL text, comments satisfy the following rule:</p>
</div>
<div class="paragraph principle">
<p>Comments are indicated by the leader characters '--'. Multi-line comments are achieved using the '--' leader on each line where the comment continues.</p>
</div>
<div class="paragraph">
<p>In this document, comments are shown in brown.</p>
</div>
<div class="sect4">
<h5 id="_information_model_identifiers_2"><a class="anchor" href="#_information_model_identifiers_2"></a>5.2.2.1. Information Model Identifiers</h5>
<div class="paragraph">
<p>As with dADL, identifiers from the underlying information model are used for all cADL nodes. Identifiers obey the same rules as in dADL: type names commence with an upper case letter, while attribute and function names commence with a lower case letter. In cADL, type names and any property (i.e. attribute or function) name can be used, whereas in dADL, only type names and attribute names appear.</p>
</div>
<div class="paragraph principle">
<p>A <strong>type name</strong> is any identifier with an initial upper case letter, followed by any combination of letters, digits and underscores. A <strong>generic type name</strong> (including nested forms) additionally may include commas, angle brackets and spaces, and must be syntactically correct as per the UML. An <strong>attribute name</strong> is any identifier with an initial lower case letter, followed by any combination of letters, digits and underscores. Any convention that obeys this rule is allowed.</p>
</div>
<div class="paragraph">
<p>Type identifiers are shown in this document in all uppercase, e.g. <code>PERSON</code> , while attribute identifiers are shown in all lowercase, e.g. <code>home_address</code> . In both cases, underscores are used to represent word breaks. This convention is used to improve the readability of this document, and other conventions may be used, such as the common programmer&#8217;s mixed-case convention exemplified by <code>Person</code> and <code>homeAddress</code>. The convention chosen for any particular cADL document should be based on that used in the underlying information model. Identifiers are shown in blue in this document.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_node_identifiers"><a class="anchor" href="#_node_identifiers"></a>5.2.3. Node Identifiers</h4>
<div class="paragraph">
<p>In cADL, an entity in brackets e.g. <code>[xxxx]</code> is used to identify "object nodes", i.e. nodes expressing constraints on instances of some type. Object nodes always commence with a type name. Any string may appear within the brackets, depending on how it is used. However, in this document, all node identifiers are of the form of an archetype term identifier, i.e. <code>[atNNNN]</code>, e.g. <code>[at0042]</code>. Node identifiers are shown in magenta in this document.</p>
</div>
</div>
<div class="sect3">
<h4 id="_natural_language"><a class="anchor" href="#_natural_language"></a>5.2.4. Natural Language</h4>
<div class="paragraph">
<p>cADL is completely independent of all natural languages. The only potential exception is where constraints include literal values from some language, and this is easily and routinely avoided by the use of separate language and terminology definitions, as used in ADL archetypes. However, for the purposes of readability, comments in English have been included in this document to aid the reader. In real cADL documents, comments are generated from the archetype <code>ontology</code> in the language of the locale.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_structure_3"><a class="anchor" href="#_structure_3"></a>5.3. Structure</h3>
<div class="paragraph">
<p>cADL constraints are written in a block-structured style, similar to block-structured programming languages like C. A typical block resembles the following (the recurring pattern <code>/.+/</code> is a regular expression meaning "non-empty string"):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON_NAME</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">forenames</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">family_name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;Dr&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Miss&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mrs&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;Mr&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">LOCATION_ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">street_number</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">street_name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">locality</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">post_code</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">state</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">country</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, an identifier (shown in green in this document) followed by the ∈ operator (equivalent text keyword: <code>matches</code> or <code>is_in</code> ) followed by an open brace, is the start of a 'block', which continues until the closing matching brace (normally visually indented to match the line at the beginning of the block).</p>
</div>
<div class="paragraph">
<p>The example above expresses a constraint on an instance of the type <code>PERSON</code>; the constraint is expressed by everything inside the <code>PERSON</code> block. The two blocks at the next level define constraints on properties of <code>PERSON</code>, in this case <code><em>name</em></code> and <code><em>addresses</em></code>. Each of these constraints is expressed in turn by the next level containing constraints on further types, and so on. The general structure is therefore a recursive nesting of constraints on types, followed by constraints on properties (of that type), followed by types (being the types of the attribute under which it appears) until leaf nodes are reached.</p>
</div>
<div class="paragraph">
<p>We use the term "object" block or node to refer to any block introduced by a type name (in this document, in all upper case), while an "attribute" block or node is any block introduced by an attribute identifier (in all lower case in this document), as illustrated below.</p>
</div>
<div id="object_attribute_blocks" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/object_attribute_blocks.png" alt="object attribute blocks">
</div>
<div class="title">Figure 4. Object and Attribute Blocks in cADL</div>
</div>
<div class="sect3">
<h4 id="_complex_objects"><a class="anchor" href="#_complex_objects"></a>5.3.1. Complex Objects</h4>
<div class="paragraph">
<p>It may by now be clear that the identifiers in the above could correspond to entities in an object-oriented information model. A UML model compatible with the example above is shown in the following figure. Note that there can easily be more than one model compatible with a given fragment of cADL syntax, and in particular, there may be more properties and classes in the reference model than are mentioned in the cADL constraints. In other words, a cADL text includes constraints <em>only for those parts of a model which are useful or meaningful to constrain</em>.</p>
</div>
<div id="uml_model_of_person" class="imageblock text-center text-center">
<div class="content">
<img src="UML/diagrams/AM-example-demographics.svg" alt="AM example demographics">
</div>
<div class="title">Figure 5. UML Model of Person</div>
</div>
<div class="paragraph">
<p>Constraints expressed in cADL cannot be stronger than those from the information model. For example, the <code>PERSON</code>.<code><em>family_name</em></code> attribute is mandatory in the model in the above <code>PERSON</code> model, so it is not valid to express a constraint allowing the attribute to be optional. In general, a cADL archetype can only further constrain an existing information model. However, it must be remembered that for very generic models consisting of only a few classes and a lot of optionality, this rule is not so much a limitation as a way of adding meaning to information. Thus, for a demographic information model which has only the types <code>PARTY</code> and <code>PERSON</code>, one can write cADL which defines the concepts of entities such as <code>COMPANY</code> , <code>EMPLOYEE</code> , <code>PROFESSIONAL</code> , and so on, in terms of constraints on the types available in the information model.</p>
</div>
<div class="paragraph">
<p>This general approach can be used to express constraints for instances of any information model. The following example shows how to express a constraint on the <code><em>value</em></code> property of an <code>ELEMENT</code> class to be a <code>DV_QUANTITY</code> with a suitable range for expressing blood pressure.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0010</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- diastolic blood pressure</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">QUANTITY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;pressure&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_attribute_constraints"><a class="anchor" href="#_attribute_constraints"></a>5.3.2. Attribute Constraints</h4>
<div class="paragraph">
<p>In any information model, attributes are either single-valued or multiply-valued, i.e. of a generic container type such as <code>List&lt;Contact&gt;</code>.</p>
</div>
<div class="sect4">
<h5 id="_existence"><a class="anchor" href="#_existence"></a>5.3.2.1. Existence</h5>
<div class="paragraph">
<p>The only constraint that applies to all attributes is to do with existence. Existence constraints say whether an attribute value must exist, and are indicated by <code>0..1</code> or <code>1</code> markers at line ends in UML diagrams (and often mistakenly referred to as a "cardinality of 1..1"). It is the absence or presence of the <code>cardinality</code> constraint in cADL which indicates that the attribute being constrained is single-valued or a container attribute respectively. Existence constraints are expressed in cADL as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">QUANTITY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mm[Hg]&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of an existence constraint is to indicate whether a value - i.e. an object - is mandatory or optional (i.e. obligatory or not) in runtime data for the attribute in question. The same logic applies whether the attribute is of single or multiple cardinality, i.e. whether it is a container type or not. For container attributes, the existence constraint indicates whether the whole container (usually a list or set) is mandatory or not; a further <em>cardinality</em> constraint (described below) indicates how many members in the container are allowed.</p>
</div>
<div class="paragraph principle">
<p>An <strong>existence constraint</strong> may be used directly after any attribute identifier, and indicates whether the object to which the attribute refers is mandatory or optional in the data.</p>
</div>
<div class="paragraph">
<p>Existence is shown using the same constraint language as the rest of the archetype definition. Existence constraints can take the values <code>{0}</code> , <code>{0..0}</code> , <code>{0..1}</code> , <code>{1}</code> , or <code>{1..1}</code> . The first two of these constraints may not seem initially obvious, but can be used to indicate that an attribute must not be present in the particular situation modelled by the archetype. The default existence constraint, if none is shown, is {1..1}.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_single_valued_attributes"><a class="anchor" href="#_single_valued_attributes"></a>5.3.3. Single-valued Attributes</h4>
<div class="paragraph">
<p>Repeated blocks of object constraints of the same class (or its subtypes) can have two possible meanings in cADL, depending on whether the cardinality is present or not in the containing attribute block. With no cardinality, the meaning is that each child object constraint of the attribute in question is a possible alternative for the value of the attribute in the data, as shown in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">    </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- miles per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">55</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mph&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">DV_QUANTITY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- km per hour</span>
<span class="tok-w">            </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">100</span><span class="tok-p">|}</span>
<span class="tok-w">            </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;velocity&quot;</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;km/h&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the cardinality of the value attribute is <code>1..1</code> (the default), while the occurrences of both <code>QUANTITY</code> constraints is optional, leading to the result that only one <code>QUANTITY</code> instance can appear in runtime data, and it can match either of the constraints.</p>
</div>
<div class="paragraph principle">
<p>Two or more object blocks introduced by type names appearing after an attribute which is not a container (i.e. for which there is no cardinality constraint) are taken to be <strong>alternative constraints</strong>, only one of which needs to be matched by the data.</p>
</div>
<div class="paragraph">
<p>Note that there is a more efficient way to express the above example, using domain type extensions. See <a href="#_customising_adl">Section 9</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_container_attributes_3"><a class="anchor" href="#_container_attributes_3"></a>5.3.4. Container Attributes</h4>
<div class="sect4">
<h5 id="_cardinality"><a class="anchor" href="#_cardinality"></a>5.3.4.1. Cardinality</h5>
<div class="paragraph">
<p>The cardinality of container attributes may be constrained in cADL with the <code><em>cardinality</em></code> constraint. Cardinality indicates limits on the number of instance members of a container types such as lists and sets. Consider the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The keyword <code>cardinality</code> implies firstly that the property events must be of a container type, such as <code>List&lt;T&gt;</code> , <code>Set&lt;T&gt;</code> , <code>Bag&lt;T&gt;</code> . The integer range indicates the valid membership of the container; a single <code>*</code> means the range <code>0..*</code>, i.e. '0 to many'. The type of the container is not explicitly indicated, since it is usually defined by the information model. However, the semantics of a logical set (unique membership, ordering not significant), a logical list (ordered, non-unique membership) or a bag (unordered, non-unique membership) can be constrained using the additional keywords <code>ordered</code> , <code>unordered</code> , <code>unique</code> and <code>non-unique</code> within the cardinality constraint, as per the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                   </span><span class="tok-c">-- logical list</span>
<span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; unordered; unique</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">         </span><span class="tok-c">-- logical set</span>
<span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*; unordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                 </span><span class="tok-c">-- logical bag</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In theory, none of these constraints can be stronger than the semantics of the corresponding container in the relevant part of the reference model. However, in practice, developers often use lists to facilitate integration, when the actual semantics are intended to be of a set; in such cases, they typically ensure set-like semantics in their own code rather than by using an <code>Set&lt;T&gt;</code> type. How such constraints are evaluated in practice may depend somewhat on knowledge of the  software system.</p>
</div>
<div class="paragraph principle">
<p>A <strong>cardinality constraint</strong> may be used after any attribute name (or after its <code>existence</code> constraint, if there is one) in order to indicate that the attribute refers to a container type, what number of member items it must have in the data, and optionally, whether it has "list", "set", or "bag" semantics, via the use of the keywords <code>ordered</code>, <code>unordered</code>, <code>unique</code> and <code>non-unique</code>.</p>
</div>
<div class="paragraph">
<p>The numeric part of the cardinality contraint can take the values <code>{0}</code>, <code>{0..0}</code>, <code>{0..n}</code>, <code>{m..n}</code>, <code>{0..*}</code>, or <code>{*}</code>, or a syntactic equivalent. The first two of these constraints are unlikely to be useful, but there is no reason to prevent them. There is no default cardinality, since if none is shown, the relevant attribute is assumed to be single-valued (in the interests of uniformity in archetypes, this holds even for smarter parsers that can access the reference model and determine that the attribute is in fact a container).</p>
</div>
<div class="paragraph">
<p>Cardinality and existence constraints can co-occur, in order to indicate various combinations on a container type property, e.g. that it is optional, but if present, is a container that may be empty, as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-c">-- etc --}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_occurrences"><a class="anchor" href="#_occurrences"></a>5.3.4.2. Occurrences</h5>
<div class="paragraph">
<p>A constraint on occurrences is used only with cADL object nodes (not attribute nodes), to indicate how many times in runtime data an instance of a given class conforming to a particular constraint can occur. It only has significance for objects which are children of a container attribute, since by definition, the occurrences of an object which is the value of a single valued attribute can only be <code>0..1</code> or <code>1..1</code>, and this is already defined by the attribute <code>existence</code>. However, it is not illegal. In the example below, three <code>EVENT</code> constraints are shown; the first one ("1 minute sample") is shown as mandatory, while the other two are optional.</p>
</div>
<div class="paragraph">
<p>In the example below, three <code>EVENT</code> constraints are shown; the first one ("1 minute sample") is shown as mandatory, while the other two are optional.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">        </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">          </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Another contrived example below expresses a constraint on instances of <code>GROUP</code> such that for <code>GROUPs</code> representing tribes, clubs and families, there can only be one "head", but there may be many members.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">GROUP</span><span class="tok-p">[</span><span class="tok-nd">iat0103</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">kind</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/tribe|family|club/</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0105</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-c">-- etc --</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first <code>occurrences</code> constraint indicates that a <code>PERSON</code> with the title <code>"head"</code> is mandatory in the <code>GROUP</code>, while the second indicates that at runtime, instances of <code>PERSON</code> with the title <code>"member"</code> can number from none to many. Occurrences may take the value of any range including <code>{0..*}</code>, meaning that any number of instances of the given type may appear in data, each conforming to the one constraint block in the archetype. A single positive integer, or the infinity indicator, may also be used on its own, thus: <code>{2}</code>, <code>{*}</code>. A range of <code>{0..0}</code> or <code>{0}</code> indicates that no occurrences of this object are allowed in this archetype. The default occurrences, if none is mentioned, is <code>{1..1}</code>.</p>
</div>
<div class="paragraph principle">
<p>An occurrences constraint may appear directly after the type name of any object constraint within a container attribute, in order to indicate how many times data objects conforming to the block introduced by the type name may occur in the data.</p>
</div>
<div class="paragraph">
<p>Where <code>cardinality</code> constraints are used (remembering that <code>occurrences</code> is always there by default, if not explicitly specified), <code>cardinality</code> and <code>occurrences</code> must always be compatible. The validity rule is:</p>
</div>
<div class="paragraph rule">
<p><strong>VCOC</strong>: cardinality/occurrences validity: the interval represented by: (the sum of all occurrences minimum values) .. (the sum of all occurrences maximum values) must be inside the interval of the cardinality.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_any_constraints"><a class="anchor" href="#_any_constraints"></a>5.3.5. "Any" Constraints</h4>
<div class="paragraph">
<p>There are two cases where it is useful to state a completely open, or "any", constraint. The "any" constraint is shown by a single asterisk (<code>*</code>) in braces. The first is when it is desired to show explicitly that some property can have any value, such as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-kt">existence </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-c">-- etc --</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The "any" constraint on <code><em>name</em></code> means that any value permitted by the underlying information model is also permitted by the archetype; however, it also provides an opportunity to specify an existence constraint which might be narrower than that in the information model. If the existence constraint is the same, an "any" constraint on a property is equivalent to no constraint being stated at all for that property in the cADL.</p>
</div>
<div class="paragraph">
<p>The second use of "any" as a constraint value is for types, such as in the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">          </span><span class="tok-c">-- speed limit</span>
<span class="tok-w">        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">QUANTITY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The meaning of this constraint is that in the data at runtime, the <code><em>value</em></code> property of <code>ELEMENT</code> must be of type <code>QUANTITY</code>, but can have any value internally. This is most useful for constraining objects to be of a certain type, without further constraining value, and is especially useful where the information model contains subtyping, and there is a need to restrict data to be of certain subtypes in certain contexts.</p>
</div>
</div>
<div class="sect3">
<h4 id="_object_node_identification_and_paths"><a class="anchor" href="#_object_node_identification_and_paths"></a>5.3.6. Object Node Identification and Paths</h4>
<div class="paragraph">
<p>In many of the examples above, some of the object node type-names are followed by a node identifier, shown in brackets.</p>
</div>
<div class="paragraph principle">
<p>Node identifiers are required for any object node which is intended to be addressable elsewhere in the cADL text, or in the runtime system and which would otherwise
be ambiguous i.e. has sibling nodes.</p>
</div>
<div class="paragraph">
<p>In the following example, the <code>PERSON</code> type does not require an identifier, since no sibling node exists at the same level, and unambiguous paths can be formed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The path to the <code><em>title</em></code> attribute is <code><em>members/title</em></code> However, where there are more than one sibling node, node identifiers must be used to ensure distinct paths:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">members</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;head&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0105</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">title</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;member&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The paths to the respective <code><em>title</em></code> attributes are now:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">members</span><span class="tok-p">[</span><span class="tok-nd">at0104</span><span class="tok-p">]/</span><span class="tok-nc">title</span>
<span class="tok-nc">members</span><span class="tok-p">[</span><span class="tok-nd">at0105</span><span class="tok-p">]/</span><span class="tok-nc">title</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Logically, all non-unique parent nodes of an identified node must also be identified back to the root node. The primary function of node identifiers is in forming paths, enabling cADL nodes to be unambiguously referred to. The node identifier can also perform a second function, that of giving a design-time meaning to the node, by equating the node identifier to some description. Thus, in the example shown in <a href="#_complex_objects">Section 5.3.1</a>, the <code>ELEMENT</code> node is identified by the code <code>[at0010]</code>, which can be designated elsewhere in an archetype as meaning "diastolic blood pressure".</p>
</div>
<div class="paragraph">
<p>Node ids are required only where it is necessary to create paths, for example in <code>use_node</code> statements. However, the underlying reference model might have stronger requirements. The <a href="https://specifications.openehr.org/releases/RM/latest">openEHR Reference Model</a> for example requires that all node types which inherit from the class <code>LOCATABLE</code> have both a <code><em>archetype_node_id</em></code> and a runtime <code><em>name</em></code> attribute. Only data types (such as <code>QUANTITY</code>, <code>CODED_TEXT</code>) and their constituent types are exempt.</p>
</div>
<div class="paragraph">
<p>Paths are used in cADL to refer to cADL nodes, and are expressed in the ADL path syntax, described in detail in <a href="#_adl_paths">Section 7</a>. ADL paths have the same alternating object/attribute structure implied in the general hierarchical structure of cADL, obeying the pattern <code>TYPE/attribute/TYPE/attribute/&#8230;&#8203;</code>.</p>
</div>
<div class="paragraph principle">
<p><strong>Paths</strong> in cADL always refer to object nodes, and can only be constructed through nodes having node ids, or nodes which are the only child object of a single-cardinality attribute.</p>
</div>
<div class="paragraph">
<p>Unusually for a path syntax, a trailing object identifier can be required, even if the attribute corresponds to a single relationship (as might be expected with the "name" property of an object) because in cADL, it is legal to define multiple alternative object constraints - each identified by a unique node id - for a relationship node which has single cardinality.</p>
</div>
<div class="paragraph">
<p>Consider the following cADL example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">HISTORY</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">periodic</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 1 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 2 min sample</span>
<span class="tok-w">            </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">    </span><span class="tok-p">}</span><span class="tok-w">           </span><span class="tok-c">-- 3 min sample</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The following paths can be constructed:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">/                       </span><span class="tok-c">-- the HISTORY (root) object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">periodic</span><span class="tok-p">               </span><span class="tok-c">-- the HISTORY.periodic attribute</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]         </span><span class="tok-c">-- the 1 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]         </span><span class="tok-c">-- the 2 minute event object</span>
<span class="tok-w">    </span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]         </span><span class="tok-c">-- the 3 minute event object</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is valid to add attribute references to the end of a path, if the underlying information model permits
it, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-p">/</span><span class="tok-nc">events</span><span class="tok-p">/</span><span class="tok-nc">count</span><span class="tok-p"> </span><span class="tok-c">-- count attribute of the items property</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The examples above are <em>physical</em> paths because they refer to object nodes using codes. Physical paths can be rendered as <em>logical</em> paths using descriptive meanings for node identifiers, if defined. Thus, the following two paths might be equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    /events[at0004]                -- the 3 minute event object
    /events[3 minute event]        -- the 3 minute event object</pre>
</div>
</div>
<div class="paragraph">
<p>None of the paths shown here have any validity outside the cADL block in which they occur, since they do not include an identifier of the enclosing document, normally an archetype. To reference a cADL node in a document from elsewhere (e.g. another archetype of a template) requires that the identifier of the document itself be prefixed to the path, as in the following archetype example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    [openehr-ehr-entry.apgar-result.v]/events[at0001]</pre>
</div>
</div>
<div class="paragraph">
<p>This kind of path expression is necessary to form the paths that occur when archetypes are composed to form larger structures.</p>
</div>
</div>
<div class="sect3">
<h4 id="_internal_references"><a class="anchor" href="#_internal_references"></a>5.3.7. Internal References</h4>
<div class="paragraph">
<p>It occurs reasonably often that one needs to include a constraint which is a repeat of an earlier complex constraint, but within a different block. This is achieved using an archetype internal reference, according to the following rule:</p>
</div>
<div class="paragraph principle">
<p>An archetype internal reference is introduced with the <code>use_node</code> keyword, in a line of the following form:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>use_node TYPE object_path</pre>
</div>
</div>
<div class="paragraph">
<p>This statement says: use the node of type <code>TYPE</code>, found at (the existing) path <code>object_path</code>. The following example shows the definitions of the <code>ADDRESS</code> nodes for phone, fax and email for a home <code>CONTACT</code> being reused for a work <code>CONTACT</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">identities</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-c">-- etc --</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- postal address</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">      </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- phone</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- fax</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- email</span>
<span class="tok-w">                        </span><span class="tok-nc">type</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                        </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                    </span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                    </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]   </span><span class="tok-c">-- phone</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0006</span><span class="tok-p">]   </span><span class="tok-c">-- fax</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0007</span><span class="tok-p">]   </span><span class="tok-c">-- email</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The type mentioned in the use_node reference must always be the same type as, or a super-type of the referenced type. In most cases, it will be the same. In some cases, an archetype section might use a subtype of the type required by the reference model (e.g. in the above example, a type such as <code>POSTAL_ADDRESS</code>); a use_node reference to such a node can legally mention the parent type (<code>ADDRESS</code>, in the example). Whether this possibility has practical utility remains to be seen.</p>
</div>
<div class="paragraph rule">
<p><strong>VUNT</strong>: <code>use_node</code> type: the type mentioned in a use_node must be the same as or a super-type (according to the reference model) of the reference model type of the node referred to.</p>
</div>
<div class="paragraph">
<p>Like any other object node, a node defined using an internal reference has <code>occurrences</code>. Unlike other node types, if no <code>occurrences</code> is mentioned, the value of the <code>occurrences</code> is set to that of the referenced node (which if not explicitly mentioned will be the default occurrences). However, the <code>occurrences</code> can be overridden in the referring node as well, as in the following example which enables the specification for 'phone' to be re-used, but with a different <code>occurrences</code> constraint.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">PERSON</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">contacts</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                   </span><span class="tok-c">-- home contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w"> </span><span class="tok-p">...}</span><span class="tok-w">   </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-nc">CONTACT</span><span class="tok-p">[</span><span class="tok-nd">at0008</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                  </span><span class="tok-c">-- work contact</span>
<span class="tok-w">                </span><span class="tok-nc">addresses</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-kt">use_node </span><span class="tok-nc">ADDRESS</span><span class="tok-p">[</span><span class="tok-nd">at0009</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">contacts</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]/</span><span class="tok-nc">addresses</span><span class="tok-p">[</span><span class="tok-nd">at0005</span><span class="tok-p">]      </span><span class="tok-c">-- phone</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_archetype_slots"><a class="anchor" href="#_archetype_slots"></a>5.3.8. Archetype Slots</h4>
<div class="paragraph">
<p>At any point in a cADL definition, a constraint can be defined that allows other archetypes to be used, rather than defining the desired constraints inline. This is known as an archetype 'slot' or 'chaining point', i.e. a connection point whose allowable 'fillers' are constrained by a set of statements, written in the ADL assertion language (described in <a href="#_assertions">Section 6</a>).</p>
</div>
<div class="paragraph">
<p>An archetype slot is defined in terms of two lists of assertions statements defining which archetypes are allowed and/or which are excluded from filling that slot.</p>
</div>
<div class="paragraph principle">
<p>An <strong>archetype slot</strong> is introduced with the keyword <code>allow_archetype</code>, and is expressed using two lists of assertions, introduced with the keywords <code>include</code> and <code>exclude</code>, respectively.</p>
</div>
<div class="paragraph">
<p>Since archetype slots are typed, the (possibly abstract) type of the allowed archetypes is already constrained. Otherwise, any assertion about a filler archetype can be made. The assertions do not constrain data in the way that other archetype statements do, instead they constrain archetypes. Two kinds of reference may be used in a slot assertion. The first is a reference to an object-oriented property of the filler archetype itself, where the property names are defined by the <code>ARCHETYPE</code> class in the Archetype Object Model. Examples include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>archetype_id
parent_archetype_id
short_concept_name</pre>
</div>
</div>
<div class="paragraph">
<p>This kind of reference is usually used to constrain the allowable archetypes based on <code><em>archetype_id</em></code> or some other meta-data item (e.g. archetypes written in the same organisation). The second kind of reference is to absolute paths in the <code>definition</code> section of the filler archetype (i.e. 'archetype paths' as used throughout this section of the specification). Both kinds of reference take the form of an Xpath-style path, with the distinction that paths referring to <code>ARCHETYPE</code> attributes not in the <code>definition</code> section do not start with a slash (this allows parsers to easily distinguish the two types of reference).</p>
</div>
<div class="sect4">
<h5 id="_defining_slots_on_the_basis_of_archetype_identifiers_and_concepts"><a class="anchor" href="#_defining_slots_on_the_basis_of_archetype_identifiers_and_concepts"></a>5.3.8.1. Defining Slots on the basis of Archetype Identifiers and Concepts</h5>
<div class="paragraph">
<p>A basic kind of assertion is on the identifier of archetypes allowed in the slot. This is achieved with statements like the following in the include and exclude lists:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">archetype_id</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*\.SECTION\..*\..*/</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- match any SECTION archetype</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is possible to limit valid slot-fillers to a single archetype simply by stating a full archetype identifier with no wildcards; this has the effect that the choice of archetype in that slot is predetermined by the archetype and cannot be changed later. In general, however, the intention of archetypes is to provide highly re-usable models of real world content with local constraining left to templates, in which case a 'wide' slot definition is used (i.e. matches many possible archetypes).</p>
</div>
<div class="paragraph">
<p>The following example shows how the "Objective" <code>SECTION</code> in a problem/SOAP headings archetype defines two slots, indicating which <code>OBSERVATION</code> and <code>SECTION</code> archetypes are allowed and excluded under the <code><em>items</em></code> property.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-nd">at2000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                      </span><span class="tok-c">-- objective</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">OBSERVATION</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">short_concept_name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">SECTION</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-kt">include</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/.*/</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-kt">exclude</span>
<span class="tok-w">                    </span><span class="tok-nc">archetype_id</span><span class="tok-p">/</span><span class="tok-nc">value</span><span class="tok-p"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/openEHR-EHR-SECTION\.patient_details\..+/</span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, every constraint inside the block starting on an <code>allow_archetype</code> line contains constraints that must be met by archetypes in order to fill the slot. In the examples above, the constraints are in the form of regular expressions on archetype identifiers. In cADL, the PERL regular expression syntax is assumed.</p>
</div>
</div>
<div class="sect4">
<h5 id="_using_other_constraints_in_slots"><a class="anchor" href="#_using_other_constraints_in_slots"></a>5.3.8.2. Using Other Constraints in Slots</h5>
<div class="paragraph">
<p>Other constraints are possible as well, including that the allowed archetype must contain a certain keyword, or a certain path. The latter allows archetypes to be linked together on the basis of content. For example, under a "genetic relatives" heading in a Family History Organiser archetype, the following slot constraint might be used:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">EVALUATION</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-kt">include</span>
<span class="tok-w">            </span><span class="tok-nc">short_concept_name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;risk_family_history&quot;</span><span class="tok-p">}</span>
<span class="tok-w">                </span><span class="tok-o">∧</span><span class="tok-w"> </span><span class="tok-o">∃</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-p"> </span><span class="tok-o">-&gt;</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">subject</span><span class="tok-p">/</span><span class="tok-nc">relationship</span><span class="tok-p">/</span><span class="tok-nc">defining_code</span><span class="tok-p">/</span><span class="tok-nc">code_list</span><span class="tok-err">.</span><span class="tok-nc">has</span><span class="tok-err">(</span><span class="tok-p">[</span><span class="tok-nc">openehr</span><span class="tok-err">::</span>0<span class="tok-p">]</span><span class="tok-err">)</span><span class="tok-p"> </span><span class="tok-c">-- self</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This says that the slot allows archetypes on the <code>EVALUATION</code> class, which either have as their concept "risk_family_history" or, if there is a constraint on the subject relationship, then it may not include the code <code>[openehr::0]</code> (the openEHR term for "self") - i.e. it must be an archetype designed for family members rather than the subject of care herself.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_placeholder_constraints"><a class="anchor" href="#_placeholder_constraints"></a>5.3.9. Placeholder Constraints</h4>
<div class="paragraph">
<p>Not all constraints can be defined easily within an archetype. One common category of constraint that should be defined externally, and referenced from the archetype is the 'value set' for a coded attribute. The need within the archetype in this case is to limit an attribute value to a particular set of codes, i.e. value set, from a terminology.</p>
</div>
<div class="paragraph">
<p>The value set could be simply enumerated within the archetype, for example using the <code>C_CODE_PHRASE</code> type defined in the openEHR Archetype Profile; this will work perfectly well, but has at least two limitations. Firstly, the intended set of values allowed for the attribute may change over time (e.g. as has happened with 'types of hepatitis' since 1980), requiring the archetype to be updated. With a large repository of archetypes, each containing coded term constraints, this approach is likely to be unsustainable and error-prone. Secondly, the best means of defining the value set is in general not likely to be via enumeration of the individual terms, but in the form of a semantic expression that can be evaluated against the terminology. This is because the value set is typically logically specified in terms of inclusions, exclusions, conjunctions and disjunctions of general categories.</p>
</div>
<div class="paragraph">
<p>Consider for example the value set logically defined as "any bacterial infection of the lung". The possible values would be codes from a target terminology, corresponding to numerous strains of pneumococcus, staphylococcus and so on, but not including species that are never found in the lung. Rather than enumerate the list of codes corresponding to this value set (which is likely to be quite large), the archetype author is more likely to rely on semantic links within the terminology to express the set; a query such as 'is-a bacteria and has-site lung' might be definable against the terminology (such as <a href="http://www.snomed.org">SNOMED CT</a> or the <a href="http://www.who.int/classifications/icd/en/">WHO ICD10</a> terminology).</p>
</div>
<div class="paragraph">
<p>In a similar way, other value sets, including for quantitative values, are likely to be specified by queries or formal expressions, and evaluated by an external knowledge service. Examples include "any
unit of pressure" and "normal range values for serum sodium".</p>
</div>
<div class="paragraph">
<p>In all such cases, expressing the constraint could be done by including the query or other formal expression within the archetype itself. However, experience shows that this is problematic in various ways. Firstly, there is little if any standardisation in such formal value set expressions or queries for use with knowledge services; two archetype authors could easily create competing syntactical expressions for the same logical constraint. A second problem is that errors might be made in the query expression itself, or the expression may be correct at the time of authoring, but need subsequent adjustment as the relevant knowledge resource grows and changes. The consequence of this is the same as for a value set enumerated inline - it is unlikely to be sustainable for large numbers of archetypes. These problems are not accidental: a query with respect to a terminological, ontological or other knowledge resource is most likely to be authored correctly by maintainers or experts of the knowledge resource, rather than archetype authors; it may well be altered over time due to improvements in the query formalism itself.</p>
</div>
<div class="paragraph">
<p>The solution adopted in ADL is to store only <em>identifiers</em> of query expressions which when evaluated return a required value set, while query expressions are assumed to be stored in a query repository, or some part of the relevant knowledge service. Rather than store external identifiers inline in a cADL text, the ADL approach is to store a 'placeholder' internal code of the form <code>[acNNNN]</code>, e.g. <code>[ac0012]</code>. Codes of this form are defined in the archetype ontology section, and can be mapped to query identifiers for one or more knowledge resources. This approach would allow a single 'ac' code to be defined for the value set.</p>
</div>
</div>
<div class="sect3">
<h4 id="_mixed_structures"><a class="anchor" href="#_mixed_structures"></a>5.3.10. Mixed Structures</h4>
<div class="paragraph">
<p>Three types of structure representing constraints on complex objects have been presented so far:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>complex object structures</em>: any node introduced by a type name and followed by {} containing constraints on attributes;</p>
</li>
<li>
<p><em>internal references</em>: any node introduced by the keyword use_node, followed by a type name; such nodes indicate re-use of a complex object constraint that has already been expressed elsewhere in the archetype;</p>
</li>
<li>
<p><em>archetype slots</em>: any node introduced by the keyword allow_archetype, followed by a type name; such nodes indicate a complex object constraint which is expressed in some other archetype.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>At any given node, all three types can co-exist, as in the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at2000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">allow_archetype </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2003</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at0004</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2004</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2005</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at1012</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-kt">use_node </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2006</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">some_path</span><span class="tok-p">[</span><span class="tok-nd">at1052</span><span class="tok-p">]</span>
<span class="tok-p">            </span><span class="tok-nc">ENTRY</span><span class="tok-p">[</span><span class="tok-nd">at2007</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{...}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here we have a constraint on an attribute called <code><em>items</em></code> (of cardinality <code>0..*</code>), expressed as a series of possible constraints on objects of type <code>ENTRY</code>. The 1st, 4th and 7th are described inline; the 3rd, 5th and 6th are expressed in terms of internal references to other nodes earlier in the archetype, while the 2nd is an archetype slot, whose constraints are expressed in other archetypes matching the include/exclude constraints appearing between the braces of this node. Note also that the <code>ordered</code> keyword on the enclosing <code><em>items</em></code> node has been used to indicate that the list order is intended to be significant.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_constraints_on_primitive_types"><a class="anchor" href="#_constraints_on_primitive_types"></a>5.4. Constraints on Primitive Types</h3>
<div class="paragraph">
<p>While constraints on complex types follow the rules described so far, constraints on attributes of
primitive types in cADL are expressed without type names, and omitting one level of braces, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-nc">some_pattern</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>rather than:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">PRIMITIVE_TYPE</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">some_pattern</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This is made possible because the syntax patterns of all primitive type constraints are mutually distinguishable, i.e. the type can always be inferred from the syntax alone. Since all leaf attributes of all object models are of primitive types, or lists or sets of them, cADL archetypes using the brief form for primitive types are significantly less verbose overall, as well as being more directly comprehensible to human readers. Currently the cADL grammar <strong>only supports the brief form</strong> used in this specification since no practical reason has been identified for supporting the more verbose version. Theoretically however, there is nothing to prevent it being used in the future, or in some specialist application.</p>
</div>
<div class="sect3">
<h4 id="_constraints_on_string"><a class="anchor" href="#_constraints_on_string"></a>5.4.1. Constraints on String</h4>
<div class="paragraph">
<p>Strings can be constrained in two ways: using a list of fixed strings, and using using a regular expression. All constraints on strings are case-sensitive.</p>
</div>
<div class="sect4">
<h5 id="_list_of_strings"><a class="anchor" href="#_list_of_strings"></a>5.4.1.1. List of Strings</h5>
<div class="paragraph">
<p>A String-valued attribute can be constrained by a list of strings (using the dADL syntax for string lists), including the simple case of a single string. Examples are as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;kangaroo&quot;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">species</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-s">&quot;platypus&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;kangaroo&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-s">&quot;wombat&quot;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first example constrains the runtime value of the <code><em>species</em></code> attribute of some object to take the value "platypus"; the second constrains it be either "platypus" or "kangaroo", and so on. <strong>In almost all cases, this kind of string constraint should be avoided</strong>, since it usually renders the body of the archetype language-dependent. Exceptions are proper names (e.g. "NHS", "Apgar"), product tradenames (but note even these are typically different in different language locales, even if the different names are not literally translations of each other). The preferred way of constraining string attributes in a language independent way is with local <code>[ac]</code> codes. See <a href="#_local_constraint_codes">Section 8.2.3</a>.</p>
</div>
</div>
<div class="sect4">
<h5 id="_regular_expression"><a class="anchor" href="#_regular_expression"></a>5.4.1.2. Regular Expression</h5>
<div class="paragraph">
<p>The second way of constraining strings is with regular expressions, a widely used syntax for expressing patterns for matching strings. The regular expression syntax used in cADL is a proper subset of that used in the Perl language (see <a href="https://perldoc.perl.org/perlre.html" target="_blank" rel="noopener">the specification of the regular expression language of Perl</a>). It is specified as a constraint using either <code>//</code> or <code>^^</code> delimiters:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">string_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/regular expression/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">string_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-o">=~</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">regular</span><span class="tok-p"> </span><span class="tok-nc">expression</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">string_attr</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-err">!</span><span class="tok-o">~</span><span class="tok-w"> </span><span class="tok-p">/</span><span class="tok-nc">regular</span><span class="tok-p"> </span><span class="tok-nc">expression</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first two are identical, indicating that the attribute value must match the supplied regular expression. The last indicates that the value must <em>not</em> match the expression. If the delimiter character is required in the pattern, it must be quoted with the backslash ('\') character, or else alternative delimiters can be used, enabling more comprehensible patterns. A typical example is regular expressions including units. The following two patterns are equivalent:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">/km\/h|mi\/h/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-sr">^km/h|mi/h^</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The rules for including special characters within strings are described in <a href="#_file_encoding_and_character_quoting">Section 3</a>.</p>
</div>
<div class="paragraph">
<p>The regular expression patterns supported in cADL are as follows.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 14.2857%;">
<col style="width: 42.8571%;">
<col style="width: 42.8572%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-center valign-top" colspan="3">Atomic Items</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>.</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any single character.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>&#8230;&#8203;</code> matches any 3 characters;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[xyz]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any of the characters in the set <code>xyz</code> (case sensitive).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[0-9]</code> matches any string containing a single decimal digit;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[a-m]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any of the characters in the set of characters formed by the continuous range from <code>a</code> to <code>m</code> (case sensitive).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[0-9]</code> matches any single character string containing a single decimal digit, <code>[S-Z]</code> matches any single character in the range <code>S</code> - <code>Z</code> ;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[^a-m]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match any character except those in the set of characters formed by the continuous range from <code>a</code> to <code>m</code> .</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>[^0-9]</code> matches any single character string as long as it does not contain a single decimal digit;</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Grouping</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>(pattern)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">parentheses are used to group items; any pattern appearing within parentheses is treated as an atomic item for the purposes of the occurrences operators.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>([1-9][0-9])</code> matches any 2-digit number.</p></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Occurrences</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 0 or more of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>.*</code> matches any string; <code>[a-z][a-z0-9]*</code> matches any alphanumeric string starting with a letter;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 1 or more occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>a[^\s]+</code> matches any string starting with 'a', followed by at least one further non-whitespace character;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>?</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match 0 or 1 occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>ab?</code> matches the strings <code>"a"</code> and <code>"ab"</code> ;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m,n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match m to n occurrences of the preceding atomic item.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>ab{1,3}</code> matches the strings <code>"ab"</code> and <code>"abb"</code> and <code>"abbb"</code> ; <code>[a-z]{1,3}</code> matches all lower-case alphabetic strings of one to three characters in length;</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m,}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match at least m occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{,n}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match at most n occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>{m}</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match exactly m occurrences of the preceding atomic item;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Special Character Classes</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\d</code> , <code>\D</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match a decimal digit character; match a non-digit character;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\s</code> , <code>\S</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match a whitespace character; match a non-whitespace character;</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<th class="tableblock halign-center valign-top" colspan="3"><p class="tableblock">Alternatives</p></th>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>pattern1|pattern2</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">match either pattern1 or pattern2.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">E.g. <code>lying|sitting|standing</code> matches any of the words <code>"lying"</code> , <code>"sitting"</code> and <code>"standing"</code> .</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><strong>A similar warning should be noted for the use of regular expressions to constrain strings</strong>: they should be limited to non-linguistically dependent patterns, such as proper and scientific names. The use of regular expressions for constraints on normal words will render an archetype linguistically dependent, and potentially unusable by others.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_integer"><a class="anchor" href="#_constraints_on_integer"></a>5.4.2. Constraints on Integer</h4>
<div class="paragraph">
<p>Integers can be constrained using a list of integer values, and using an integer interval.</p>
</div>
<div class="sect4">
<h5 id="_list_of_integers"><a class="anchor" href="#_list_of_integers"></a>5.4.2.1. List of Integers</h5>
<div class="paragraph">
<p>Lists of integers expressed in the syntax from ODIN can be used as a constraint, e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-m">1000</span><span class="tok-p">}</span><span class="tok-w">       </span><span class="tok-c">-- fixed value of 1000</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-mi">0</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">8</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- any of 0, 5 or 8</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first constraint requires the attribute <code><em>length</em></code> to be 1000, while the second limits the value of <code><em>magnitude</em></code> to be 0, 5, or 8 only.</p>
</div>
</div>
<div class="sect4">
<h5 id="_interval_of_integer"><a class="anchor" href="#_interval_of_integer"></a>5.4.2.2. Interval of Integer</h5>
<div class="paragraph">
<p>Integer intervals are expressed using the interval syntax from dADL (described in the dADL specification). Examples of 2-sided intervals include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- point interval of 1000 (=fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">950</span><span class="tok-p">..</span><span class="tok-mi">1050</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 950 - 1050</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- allow 0 - 1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..&lt;</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                   </span><span class="tok-c">-- allow 0&gt;= x &lt;1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">&gt;..&lt;</span><span class="tok-mi">1000</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 0&gt; x &lt;1000</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">100</span><span class="tok-p">+/-</span><span class="tok-mi">5</span><span class="tok-p">|}</span><span class="tok-w">                    </span><span class="tok-c">-- allow 100 +/- 5, i.e. 95 - 105</span>
<span class="tok-w">    </span><span class="tok-nc">rate</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-err">infinity</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 0 - infinity, i.e. same as &gt;= 0</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Examples of one-sided intervals include:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&lt;</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow up to 9</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow 11 or more</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&lt;=</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- allow up to 10</span>
<span class="tok-w">    </span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|&gt;=</span><span class="tok-mi">10</span><span class="tok-p">|}</span><span class="tok-w">                       </span><span class="tok-c">-- allow 10 or more</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_real"><a class="anchor" href="#_constraints_on_real"></a>5.4.3. Constraints on Real</h4>
<div class="paragraph">
<p>Constraints on Real values follow exactly the same syntax as for Integers, in both list and interval forms. The only difference is that the real number values used in the constraints are indicated by the use of the decimal point and at least one succeeding digit, which may be 0. Typical examples are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mf">5.5</span><span class="tok-p">}</span><span class="tok-w">                             </span><span class="tok-c">-- list of one (fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">5.5</span><span class="tok-p">|}</span><span class="tok-w">                           </span><span class="tok-c">-- point interval (=fixed value)</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">5.5</span><span class="tok-p">..</span><span class="tok-mf">6.0</span><span class="tok-p">|}</span><span class="tok-w">                      </span><span class="tok-c">-- interval</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mf">5.5</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mf">6.0</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mf">6.5</span><span class="tok-p">}</span><span class="tok-w">                   </span><span class="tok-c">-- list</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..&lt;</span><span class="tok-mf">1000.0</span><span class="tok-p">|}</span><span class="tok-w">                  </span><span class="tok-c">-- allow 0&gt;= x &lt;1000.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|&lt;</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                         </span><span class="tok-c">-- allow anything less than 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|&gt;</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                         </span><span class="tok-c">-- allow greater than 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|&lt;=</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow up to 10.0</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|&gt;=</span><span class="tok-mf">10.0</span><span class="tok-p">|}</span><span class="tok-w">                        </span><span class="tok-c">-- allow 10.0 or more</span>
<span class="tok-w">    </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mf">80.0</span><span class="tok-p">+/-</span><span class="tok-mf">12.0</span><span class="tok-p">|}</span><span class="tok-w">                   </span><span class="tok-c">-- allow 80 +/- 12</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_boolean"><a class="anchor" href="#_constraints_on_boolean"></a>5.4.4. Constraints on Boolean</h4>
<div class="paragraph">
<p>Boolean runtime values can be constrained to be True, False, or either, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">False</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-l">False</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_character"><a class="anchor" href="#_constraints_on_character"></a>5.4.5. Constraints on Character</h4>
<div class="paragraph">
<p>Characters can be constrained in two ways: using a list of characters, and using a regular expression.</p>
</div>
<div class="sect4">
<h5 id="_list_of_characters"><a class="anchor" href="#_list_of_characters"></a>5.4.5.1. List of Characters</h5>
<div class="paragraph">
<p>The following examples show how a character value may be constrained using a list of fixed character values. Each character is enclosed in single quotes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sc">&#39;r&#39;</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sc">&#39;r&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-sc">&#39;g&#39;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-sc">&#39;b&#39;</span><span class="tok-p">}</span></code></pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_regular_expression_2"><a class="anchor" href="#_regular_expression_2"></a>5.4.5.2. Regular Expression</h5>
<div class="paragraph">
<p>Character values can also be constrained using a single-character regular expression character class, as per the following examples:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/[rgbcmyk]/</span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">color_name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-sr">/[^\s\t\n]/</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The only allowed elements of the regular expression syntax in character expressions are the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>any item from the Character Classes list above;</p>
</li>
<li>
<p>any item from the Special Character Classes list above;</p>
</li>
<li>
<p>an alternative expression whose parts are any item types, e.g. <code>'a'|'b'|[m-z]</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_dates_times_and_durations"><a class="anchor" href="#_constraints_on_dates_times_and_durations"></a>5.4.6. Constraints on Dates, Times and Durations</h4>
<div class="paragraph">
<p>Dates, times, date/times and durations may all be constrained in three ways: using a list of values, using intervals, and using patterns. The first two ways allow values to be constrained to actual date, time etc values, while the last allows values to be constrained on the basis of which parts of the date, time etc are present or missing, regardless of value. The pattern method is described first, since patterns can also be used in lists and intervals.</p>
</div>
<div class="sect4">
<h5 id="date_time_constraint_patterns"><a class="anchor" href="#date_time_constraint_patterns"></a>5.4.6.1. Date, Time and Date/Time</h5>
<div class="sect5">
<h6 id="_patterns"><a class="anchor" href="#_patterns"></a>Patterns</h6>
<div class="paragraph">
<p>Dates, times, and date/times (i.e. timestamps), can be constrained using patterns based on the <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener">ISO 8601 date/time syntax</a>, which indicate which parts of the date or time must be supplied. A constraint pattern is formed from the abstract pattern <code>yyyy-mm-ddThh:mm:ss</code> (itself formed by translating each field of an ISO 8601 date/time into a letter representing its type), with either <code>?</code> (meaning optional) or <code>X</code> (not allowed) characters substituted in appropriate places. Timezone may be indicated as being <em>required</em> by the addition of a patterns such as <code>+hh:mm</code>, <code>+hhmm</code>, and <code>-hh</code>. The <code>Z</code> (UTC, i.e. equivalent of <code>+0000</code>) timezone modifier can always be used when any such pattern is specified (see <a href="#timezone_constraints">table below</a>).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
there is no way to state that timezone information be <em>prohibited</em>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The syntax of legal patterns is given by Antlr4 lexical rules <code>DATE_CONSTRAINT_PATTERN</code>, <code>TIME_CONSTRAINT_PATTERN</code> and <code>DATE_TIME_CONSTRAINT_PATTERN</code> shown below in the <a href="#_base_lexer">Base Lexer syntax section</a>.</p>
</div>
<div class="paragraph">
<p>All expressions generated by these patterns must also satisfy the validity rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>where <code>??</code> appears in a field, only <code>??</code> or <code>XX</code> can appear in fields to the right</p>
</li>
<li>
<p>where <code>XX</code> appears in a field, only <code>XX</code> can appear in fields to the right</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following table shows the valid patterns that can be used, and the types implied by each pattern.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 30%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Implied Type</th>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-dd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full date must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional day;<br>
 e.g. day in month forgotten</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional month, optional day;<br>
 i.e. any date allowed; e.g. mental health questionnaires which include well known historical dates</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mandatory month, no day</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional month, no day</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
<td class="tableblock halign-left valign-top"></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:mm:ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full time must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:mm:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds;<br>
 e.g. appointment time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:??:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional minutes, no seconds;<br>
 e.g. normal clock times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hh:??:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional minutes, seconds;<br>
 i.e. any time allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"> </p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:ss</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">full date/time must be specified</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">optional seconds;<br>
 e.g. appointment date/time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:mm:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds;<br>
 e.g. appointment date/time</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-mm-ddThh:??:XX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no seconds, minutes optional;<br>
 e.g. in patient-recollected date/times</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Date/Time</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">yyyy-??-??T??:??:??</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">minimum valid date/time constraint</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>In the above patterns, the 'yyyy' etc match strings can be replaced by literal date/time numbers. For example, <code>yyyy-??-XX</code> could be transformed into <code>1995-??-XX</code> to mean any partial date in 1995.</p>
</div>
<div class="paragraph">
<p>Any of the time or date/time (but not date) patterns above may be modified to require a timezone by appending one of the following timezone constraint patterns:</p>
</div>
<table id="timezone_constraints" class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Pattern</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">±hh</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hours-only timezone modifier required, commencing with '+' or '-'; 'Z' also allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">±hh:mm</p></td>
<td class="tableblock halign-left valign-top" rowspan="2"><p class="tableblock">full timezone modifier required, commencing with '+' or '-'; 'Z' also allowed</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">±hhmm</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Z</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">'Z' required (indicating GMT)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>It is assumed that any time or date/time datum that includes timezone is correctly constructed to include the effect of summer time.</p>
</div>
<div class="paragraph">
<p>The absence of a timezone constraint indicates that a timezone modifier is optional.</p>
</div>
<div class="paragraph">
<p>An assumed value can be used with any of the above using the semi-colon separator, as follows, e.g. <code>yyyy-??-??; 1970-01-01</code>. If there is a timezone constraint, the assumed value must include a valid timezone, i.e. <code>yyyy-mm-dd±hh; 1970-01-01+02</code>.</p>
</div>
</div>
<div class="sect5">
<h6 id="_intervals"><a class="anchor" href="#_intervals"></a>Intervals</h6>
<div class="paragraph">
<p>Dates, times and date/times can also be constrained using intervals. Each date, time or date/time in an interval may be a literal value. Examples of such constraints:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                    </span><span class="tok-c">-- exactly 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&lt; </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                  </span><span class="tok-c">-- any time before 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&lt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                 </span><span class="tok-c">-- any time at or before 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&gt; </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                  </span><span class="tok-c">-- any time after 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|&gt; </span><span class="tok-ld">09:30:00+0200</span><span class="tok-p">|</span><span class="tok-w">                             </span><span class="tok-c">-- any time after 9:30 am in UTC+0200 timezone</span>
<span class="tok-w">    </span><span class="tok-p">|&gt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|</span><span class="tok-w">                                 </span><span class="tok-c">-- any time at or after 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20</span><span class="tok-p">..</span><span class="tok-ld">2004-06-02</span><span class="tok-p">|</span><span class="tok-w">                      </span><span class="tok-c">-- a date range</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20T00:00:00</span><span class="tok-p">..</span><span class="tok-ld">2005-05-19T23:59:59</span><span class="tok-p">|</span><span class="tok-w">    </span><span class="tok-c">-- a date/time range</span>
<span class="tok-w">    </span><span class="tok-p">|&gt;= </span><span class="tok-ld">09:30:00</span><span class="tok-p">|;</span><span class="tok-ld">09:30:00</span><span class="tok-w">                        </span><span class="tok-c">-- any time at or after 9:30 am; assume 9:30 am</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">2004-05-20T00:00:00Z</span><span class="tok-p">..</span><span class="tok-ld">2005-05-19T23:59:59Z</span><span class="tok-p">|</span><span class="tok-w">  </span><span class="tok-c">-- a date/time range in UTC timezone</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Within any interval containing two literal date/time values (i.e. not one-sided intervals), if a timezone is used on one, it must be used on both, to ensure comparability. The timezones need not be identical.</p>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_duration_constraints"><a class="anchor" href="#_duration_constraints"></a>5.4.6.2. Duration Constraints</h5>
<div class="sect5">
<h6 id="_patterns_2"><a class="anchor" href="#_patterns_2"></a>Patterns</h6>
<div class="paragraph">
<p>Patterns based on ISO 8601 can be used to constrain durations in the same way as for Date/time types. The Antlr4 lexical rule for the pattern is <code>DURATION_CONSTRAINT_PATTERN</code>, shown below in the <a href="#_base_lexer">Base Lexer syntax section</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
allowing the 'W' designator to be used with the other designators corresponds to a deviation from the published <a href="https://en.wikipedia.org/wiki/ISO_8601" target="_blank" rel="noopener">ISO 8601 standard</a> used in openEHR, namely: durations are supposed to take the form of <code>PnnW</code> or <code>PnnYnnMnnDTnnHnnMnnS</code>, but in openEHR, the 'W' (week) designator can be used with the other designators, since it is very common to state durations of pregnancy as some combination of weeks and days.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The use of this pattern indicates which 'slots' in an ISO duration string may be filled. Where multiple letters are supplied in a given pattern, the meaning is 'or', i.e. any one or more of the slots may be supplied in the data. This syntax allows specifications like the following to be made:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-ld">Pd</span><span class="tok-w">            </span><span class="tok-c">-- a duration containing days only, e.g. P5d</span>
<span class="tok-w">    </span><span class="tok-ld">Pm</span><span class="tok-w">            </span><span class="tok-c">-- a duration containing months only, e.g. P5m</span>
<span class="tok-w">    </span><span class="tok-ld">PTm</span><span class="tok-w">           </span><span class="tok-c">-- a duration containing minutes only, e.g. PT5m</span>
<span class="tok-w">    </span><span class="tok-ld">Pwd</span><span class="tok-w">           </span><span class="tok-c">-- a duration containing weeks and/or days only, e.g. P4w</span>
<span class="tok-w">    </span><span class="tok-ld">PThm</span><span class="tok-w">          </span><span class="tok-c">-- a duration containing hours and/or minutes only, e.g. PT2h30m</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Pure pattern constraints are used to constrain negative durations as well as positive durations. Accordingly, any of the above constraints may be used for values such as <code>'-P5d'</code> etc.</p>
</div>
</div>
<div class="sect5">
<h6 id="_lists_and_intervals"><a class="anchor" href="#_lists_and_intervals"></a>Lists and Intervals</h6>
<div class="paragraph">
<p>Durations can also be constrained by using absolute ISO 8601 duration values, or ranges of the same (including negative values), e.g.:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-ld">PT1m</span><span class="tok-w">              </span><span class="tok-c">-- 1 minute</span>
<span class="tok-w">    </span><span class="tok-ld">P1dT8h</span><span class="tok-w">            </span><span class="tok-c">-- 1 day 8 hrs</span>
<span class="tok-w">    </span><span class="tok-p">|</span><span class="tok-ld">PT0m</span><span class="tok-p">..</span><span class="tok-ld">PT1m30s</span><span class="tok-p">|</span><span class="tok-w">   </span><span class="tok-c">-- Reasonable time offset of first apgar sample</span></code></pre>
</div>
</div>
</div>
<div class="sect5">
<h6 id="_mixed_pattern_and_interval"><a class="anchor" href="#_mixed_pattern_and_interval"></a>Mixed Pattern and Interval</h6>
<div class="paragraph">
<p>In some cases there is a need to be able to limit the allowed units as well as state a duration interval. This is common in obstetrics, where physicians want to be able to set an interval from say 0-50 weeks and limit the units to only weeks and days. This can be done as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    PWD/|P0W..P50W|   -- 0-50 weeks, expressed only using weeks and days</pre>
</div>
</div>
<div class="paragraph">
<p>The same type of constraint can be used to constrain values that may be negative (usually allowing for zero as well):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    PYMWD/|&lt;=P0Y|     -- negative age, with years/months/weeks/days allowed</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
a negative sign (or equivalently, '&lt;= 0' construction as above) is only used for specifying interval values; the pattern part is understood as allowing values of either sign.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The general form is a pattern followed by a slash ('/') followed by an interval, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">duration_constraint</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_pattern</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_interval</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraints_on_lists_of_primitive_types"><a class="anchor" href="#_constraints_on_lists_of_primitive_types"></a>5.4.7. Constraints on Lists of Primitive types</h4>
<div class="paragraph">
<p>In many cases, the type in the information model of an attribute to be constrained is a list or set of primitive types, e.g. <code>List&lt;Integer&gt;</code>, <code>Set&lt;String&gt;</code> etc. As for complex types, this is indicated in cADL using the <code>cardinality</code> keyword, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">some_attr</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-nc">some_constraint</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The pattern to match in the final braces will then have the meaning of a list or set of value constraints, rather than a single value constraint. Any constraint described above for single-valued attributes, which is commensurate with the type of the attribute in question, may be used. However, as with complex objects, the meaning is now that every item in the list is constrained to be any one of the values implied by the constraint expression. For example,</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">speed_limits</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*; ordered</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-mi">50</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">60</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">70</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">80</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">100</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-mi">130</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>constrains each value in the list corresponding to the value of the attribute <code>speed_limits</code> (of type <code>List&lt;Integer&gt;</code> ), to be any one of the values 50, 60, 70 etc.</p>
</div>
</div>
<div class="sect3">
<h4 id="_assumed_values"><a class="anchor" href="#_assumed_values"></a>5.4.8. Assumed Values</h4>
<div class="paragraph">
<p>When archetypes are defined to have optional parts, an ability to define 'assumed' values is useful. For example, an archetype for the concept 'blood pressure measurement' might include an optional data point describing the patient position, with choices 'lying', 'sitting' and 'standing'. Since the section is optional, data could be created according to the archetype which does not contain the protocol section. However, a blood pressure cannot be taken without the patient in some position, so clearly
there could be an implied or 'assumed' value.</p>
</div>
<div class="paragraph">
<p>The archetype allows this to be explicitly stated so that all users/systems know what value to assume when optional items are not included in the data. Assumed values are currently definable on primitive types only, and are expressed after the constraint expression, by a semi-colon (';') followed by a value of the same type as that implied by the preceding part of the constraint. The use of assumed values is illustrated here for a number of primitive types:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">length</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|;</span><span class="tok-w"> </span><span class="tok-mi">200</span><span class="tok-p">}</span><span class="tok-w">             </span><span class="tok-c">-- allow 0 - 1000, assume 200</span>
<span class="tok-nc">some_flag</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-l">True</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-l">False</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-l">True</span><span class="tok-p">}</span><span class="tok-w">       </span><span class="tok-c">-- allow T or F, assume T</span>
<span class="tok-nc">some_date</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-ld">yyyy-mm-dd</span><span class="tok-w"> </span><span class="tok-ld">hh:mm:XX</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-ld">1800-01-01</span><span class="tok-nc">T00</span><span class="tok-err">:</span><span class="tok-mi">00</span><span class="tok-err">:</span><span class="tok-mi">00</span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>If no assumed value is stated, no reliable assumption can be made by the receiver of the archetyped data about what the values of removed optional parts might be, from inspecting the archetype. However, this usually corresponds to a situation where the assumed value does not even need to be stated - the same value will be assumed by all users of this data, if its value is not transmitted. In other cases, it may be that it doesn&#8217;t matter what the assumed value is. For example, an archetype used to capture
physical measurements might include a "protocol" section, which in turn can be used to record the "instrument" used to make a given measurement. In a blood pressure specialisation of this archetype it is fairly likely that physicians recording or receiving the data will not care about what instrument was used.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_specification_2"><a class="anchor" href="#_syntax_specification_2"></a>5.5. Syntax Specification</h3>
<div class="paragraph">
<p>The grammar for the standard cADL syntax is shown below. The form used in openEHR is the same as this, but with custom additions, described in the <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/openehr_archetype_profile.pdf" target="_blank" rel="noopener">openEHR Archetype Profile</a>. The resulting grammar and lexical analysis specification used in the openEHR reference ADL parser is implemented using lex (.l file) and yacc (.y file) specifications for the Eiffel programming environment. The current release of these files is available at in the <a href="https://github.com/openEHR/adl-tools/blob/Release-1.4/components/adl_parser/src/syntax/cadl/parser" target="_blank" rel="noopener">ADL Workbench cADL parser source code</a>. The .l and .y files can be converted for use in other yacc/lex-based programming environments. The production rules of the .y file are available as an <a href="https://github.com/openEHR/adl-tools/blob/Release-1.4/components/adl_parser/src/syntax/cadl/parser/cadl_validator.html" target="_blank" rel="noopener">HTML document</a>.</p>
</div>
<div class="sect3">
<h4 id="_grammar_2"><a class="anchor" href="#_grammar_2"></a>5.5.1. Grammar</h4>
<div class="paragraph">
<p>The following is an extract of the cADL parser production rules (yacc specification). Note that because of interdependencies with path and assertion production rules, practical implementations may have to include all production rules in one parser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">input</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_complex_object_head</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">c_complex_object_body</span><span class="tok-w"> </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_complex_object_id</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object_id</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">type_identifier</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-no">V_LOCAL_TERM_CODE_REF</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object_body</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_any</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_attributes</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_object</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">archetype_internal_ref</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">archetype_slot</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constraint_ref</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_C_DOMAIN_TYPE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">archetype_internal_ref</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_USE_NODE</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-w"> </span><span class="tok-nv">object_path</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">archetype_slot</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_archetype_slot_head</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">c_includes</span><span class="tok-w"> </span><span class="tok-nv">c_excludes</span>
<span class="tok-w">    </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_slot_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_archetype_slot_id</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_slot_id</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_ALLOW_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_ALLOW_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">type_identifier</span><span class="tok-w"> </span><span class="tok-no">V_LOCAL_TERM_CODE_REF</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_primitive_object</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_primitive</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_primitive</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_integer</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_real</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_duration</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_string</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_boolean</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_any</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;*&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_attributes</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_attribute</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_attributes</span><span class="tok-w"> </span><span class="tok-nv">c_attribute</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_attribute</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_attr_head</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">c_attr_values</span><span class="tok-w"> </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_attr_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span><span class="tok-w"> </span><span class="tok-nv">c_existence</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span><span class="tok-w"> </span><span class="tok-nv">c_existence</span><span class="tok-w"> </span><span class="tok-nv">c_cardinality</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_attr_values</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_attr_values</span><span class="tok-w"> </span><span class="tok-nv">c_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_any</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_includes</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// nothing OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertions</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_excludes</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// nothing OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_EXCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertions</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_existence</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// nothing OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTENCE</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">existence_spec</span><span class="tok-w"> </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">existence_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_INTEGER</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_INTEGER</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-no">V_INTEGER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_cardinality</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_CARDINALITY</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">cardinality_spec</span>
<span class="tok-w">    </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">cardinality_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">occurrence_spec</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_ORDERED</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNORDERED</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_ORDERED</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNORDERED</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_ORDERED</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNORDERED</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">cardinality_limit_value</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_occurrences</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// nothing OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_OCCURRENCES</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span><span class="tok-w"> </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">occurrence_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">cardinality_limit_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_INTEGER</span><span class="tok-w"> </span><span class="tok-no">SYM_ELLIPSIS</span><span class="tok-w"> </span><span class="tok-nv">cardinality_limit_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_integer_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">occurrence_spec</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_integer</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_integer_spec</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_integer_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_real_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_real</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_real_spec</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_real_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_date_constraint</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_DATE_CONSTRAINT_PATTERN</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_date</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_date_constraint</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date_constraint</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_time_constraint</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_TIME_CONSTRAINT_PATTERN</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_time</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_time_constraint</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_time_constraint</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_date_time_constraint</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_DATE_TIME_CONSTRAINT_PATTERN</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_date_time</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_date_time_constraint</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date_time_constraint</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">c_duration_constraint</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">duration_pattern</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_pattern</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">duration_pattern</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ISO8601_DURATION_CONSTRAINT_PATTERN</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_duration</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_duration_constraint</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_duration_constraint</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_string_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_STRING</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">string_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">string_list_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_REGEXP</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_string</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_string_spec</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_string_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">string_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_boolean_spec</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_TRUE</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_boolean</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">c_boolean_spec</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_boolean_spec</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">constraint_ref</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_LOCAL_TERM_CODE_REF</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">any_identifier</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">type_identifier</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">// for string_value etc, see dADL spec</span>
<span class="tok-c">// for attribute_path, object_path, call_path, etc, see Path spec</span>
<span class="tok-c">// for assertions, assertion, see Assertion spec</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_symbols_2"><a class="anchor" href="#_symbols_2"></a>5.5.2. Symbols</h4>
<div class="paragraph">
<p>The following shows the lexical specification for the cADL grammar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>----------/* definitions */ -----------------------------------------------
ALPHANUM [a-zA-Z0-9]
IDCHAR [a-zA-Z0-9_]
NAMECHAR [a-zA-Z0-9._\-]
NAMECHAR_SPACE [a-zA-Z0-9._\- ]
NAMECHAR_PAREN [a-zA-Z0-9._\-()]
UTF8CHAR (([\xC2-\xDF][\x80-\xBF])|(\xE0[\xA0-\xBF][\x80-\xBF])|([\xE1-\xEF][\x80-\xBF][\x80-\xBF])|(\xF0[\x90-\xBF][\x80-\xBF][\x80-\xBF])|([\xF1-\xF7][\x80-\xBF][\x80-\xBF][\x80-\xBF]))

----------/* comments */ -------------------------------------------------
"--".* -- Ignore comments
"--".*\n[ \t\r]*

----------/* symbols */ -------------------------------------------------
"-"             -- -&gt; Minus_code
"+"             -- -&gt; Plus_code
"*"             -- -&gt; Star_code
"/"             -- -&gt; Slash_code
"^"             -- -&gt; Caret_code
"="             -- -&gt; Equal_code
"."             -- -&gt; Dot_code
";"             -- -&gt; Semicolon_code
","             -- -&gt; Comma_code
":"             -- -&gt; Colon_code
"!"             -- -&gt; Exclamation_code
"("             -- -&gt; Left_parenthesis_code
")"             -- -&gt; Right_parenthesis_code
"$"             -- -&gt; Dollar_code
"??"            -- -&gt; SYM_DT_UNKNOWN
"?"             -- -&gt; Question_mark_code
"|"             -- -&gt; SYM_INTERVAL_DELIM
"["             -- -&gt; Left_bracket_code
"]"             -- -&gt; Right_bracket_code
"{"             -- -&gt; SYM_START_CBLOCK
"}"             -- -&gt; SYM_END_CBLOCK
".."            -- -&gt; SYM_ELLIPSIS
"..."           -- -&gt; SYM_LIST_CONTINUE

----------/* common keywords */ --------------------------------------
[Mm][Aa][Tt][Cc][Hh][Ee][Ss]                    -- -&gt; SYM_MATCHES
[Ii][Ss]_[Ii][Nn]                               -- -&gt; SYM_MATCHES

----------/* assertion keywords */ ------------------------------------
[Tt][Hh][Ee][Nn]                                    -- -&gt; SYM_THEN
[Ee][Ll][Ss][Ee]                                    -- -&gt; SYM_ELSE
[Aa][Nn][Dd]                                        -- -&gt; SYM_AND
[Oo][Rr]                                            -- -&gt; SYM_OR
[Xx][Oo][Rr]                                        -- -&gt; SYM_XOR
[Nn][Oo][Tt]                                        -- -&gt; SYM_NOT
[Ii][Mm][Pp][Ll][Ii][Ee][Ss]                        -- -&gt; SYM_IMPLIES
[Tt][Rr][Uu][Ee]                                    -- -&gt; SYM_TRUE
[Ff][Aa][Ll][Ss][Ee]                                -- -&gt; SYM_FALSE
[Ff][Oo][Rr][_][Aa][Ll][Ll]                         -- -&gt; SYM_FORALL
[Ee][Xx][Ii][Ss][Tt][Ss]                            -- -&gt; SYM_EXISTS

---------/* cADL keywords */ ---------------------------------------
[Ee][Xx][Ii][Ss][Tt][Ee][Nn][Cc][Ee]                -- -&gt; SYM_EXISTENCE
[Oo][Cc][Cc][Uu][Rr][Rr][Ee][Nn][Cc][Ee][Ss]        -- -&gt; SYM_OCCURRENCES
[Cc][Aa][Rr][Dd][Ii][Nn][Aa][Ll][Ii][Tt][Yy]        -- -&gt; SYM_CARDINALITY
[Oo][Rr][Dd][Ee][Rr][Ee][Dd]                        -- -&gt; SYM_ORDERED
[Uu][Nn][Oo][Rr][Dd][Ee][Rr][Ee][Dd]                -- -&gt; SYM_UNORDERED
[Uu][Nn][Ii][Qq][Uu][Ee]                            -- -&gt; SYM_UNIQUE
[Ii][Nn][Ff][Ii][Nn][Ii][Tt][Yy]                    -- -&gt; SYM_INFINITY
[Uu][Ss][Ee][_][Nn][Oo][Dd][Ee]                     -- -&gt; SYM_USE_NODE
[Uu][Ss][Ee][_][Aa][Rr][Cc][Hh][Ee][Tt][Yy][Pp][Ee] -- -&gt; SYM_USE_ARCHETYPE
[Aa][Ll][Ll][Oo][Ww][_][Aa][Rr][Cc][Hh][Ee][Tt][Yy][Pp][Ee] -- -&gt; SYM_ALLOW_ARCHETYPE
[Ii][Nn][Cc][Ll][Uu][Dd][Ee]                        -- -&gt; SYM_INCLUDE
[Ee][Xx][Cc][Ll][Uu][Dd][Ee]                        -- -&gt; SYM_EXCLUDE

----------/* V_URI */ -----------------------------------------------
[a-z]+:\/\/[^&lt;&gt;|\\{}^~"\[\] ]*

---------/* V_QUALIFIED_TERM_CODE_REF */ ----------------------------
-- any qualified code, e.g. [local::at0001], [local::ac0001], [loinc::700-0]
--
\[{NAMECHAR_PAREN}+::{NAMECHAR}+\]
\[{NAMECHAR_PAREN}+::{NAMECHAR_SPACE}+\] -- error

---------/* V_LOCAL_TERM_CODE_REF */ ---------------------------------
-- any unqualified code, e.g. [at0001], [ac0001], [700-0]
--
\[{ALPHANUM}{NAMECHAR}*\]

----------/* V_LOCAL_CODE */ ----------------------------------------
a[ct][0-9.]+

---------/* V_TERM_CODE_CONSTRAINT of form */ ------------
-- [terminology_id::code, -- comment
-- code, -- comment
-- code] -- comment
--
-- Form with assumed value
-- [terminology_id::code, -- comment
-- code; -- comment
-- code] -- an optional assumed value
--
\[[a-zA-Z0-9()._\-]+::[ \t\n]*          -- start IN_TERM_CONSTRAINT
&lt;IN_TERM_CONSTRAINT&gt; {
[ \t]*[a-zA-Z0-9._\-]+[ \t]*;[ \t\n]*

-- match second last line with ';' termination (assumed value)
[ \t]*[a-zA-Z0-9._\-]+[ \t]*,[ \t\n]*

-- match any line, with ',' termination
\-\-[^\n]*\n -- ignore comments
[ \t]*[a-zA-Z0-9._\-]*[ \t\n]*\]        -- match final line, terminating in ']'

------/* V_ISO8601_EXTENDED_DATE_TIME */ ---
-- YYYY-MM-DDThh:mm:ss[,sss][Z|+/-nnnn]
--
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9]:[0-6][0-9](,[0-9]+)?(Z|[+-][0-9]{4})? |
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9]:[0-6][0-9](Z|[+-][0-9]{4})? |
[0-9]{4}-[0-1][0-9]-[0-3][0-9]T[0-2][0-9](Z|[+-][0-9]{4})?

----------/* V_ISO8601_EXTENDED_TIME */ --------
-- hh:mm:ss[,sss][Z|+/-nnnn]
--
[0-2][0-9]:[0-6][0-9]:[0-6][0-9](,[0-9]+)?(Z|[+-][0-9]{4})? |
[0-2][0-9]:[0-6][0-9](Z|[+-][0-9]{4})?

----------/* V_ISO8601_DATE YYYY-MM-DD */ --------------------
[0-9]{4}-[0-1][0-9]-[0-3][0-9] |
[0-9]{4}-[0-1][0-9]

----------/* V_ISO8601_DURATION */ -------------------------
P([0-9]+[yY])?([0-9]+[mM])?([0-9]+[wW])?([0-9]+[dD])?T([0-9]+[hH])?([0-9]+[mM])?([0-9]+[sS])? |
P([0-9]+[yY])?([0-9]+[mM])?([0-9]+[wW])?([0-9]+[dD])?

----------/* V_ISO8601_DATE_CONSTRAINT_PATTERN */ -----------------
[yY][yY][yY][yY]-[mM?X][mM?X]-[dD?X][dD?X]

----------/* V_ISO8601_TIME_CONSTRAINT_PATTERN */ ------------------
[hH][hH]:[mM?X][mM?X]:[sS?X][sS?X]

----------/* V_ISO8601_DATE_TIME_CONSTRAINT_PATTERN */ -------------
[yY][yY][yY][yY]-[mM?][mM?]-[dD?X][dD?X][ T][hH?X][hH?X]:[mM?X][mM?X]:[sS?X][sS?X]

----------/* V_ISO8601_DURATION_CONSTRAINT_PATTERN */ --------------
P[yY]?[mM]?[wW]?[dD]?T[hH]?[mM]?[sS]? |
P[yY]?[mM]?[wW]?[dD]?

----------/* V_TYPE_IDENTIFIER */ ------------------------------------
[A-Z]{IDCHAR}*

----------/* V_GENERIC_TYPE_IDENTIFIER */ ----------------------------
[A-Z]{IDCHAR}*&lt;[a-zA-Z0-9,_&lt;&gt;]+&gt;

----------/* V_FEATURE_CALL_IDENTIFIER */ ----------------------------
[a-z]{IDCHAR}*[ ]*\(\)

----------/* V_ATTRIBUTE_IDENTIFIER */ ----------------------------
[a-z]{IDCHAR}*

----------/* V_GENERIC_TYPE_IDENTIFIER */ -------------------------------
[A-Z]{IDCHAR}*&lt;[a-zA-Z0-9,_&lt;&gt;]+&gt;

----------/* V_ATTRIBUTE_IDENTIFIER */ ----------------------------------
[a-z]{IDCHAR}*

----------/* V_C_DOMAIN_TYPE - sections of dADL syntax */ ---------------
-- {mini-parser specification}
-- this is an attempt to match a dADL section inside cADL. It will
-- probably never work 100% properly since there can be '&gt;' inside "||"
-- ranges, and also strings containing any character, e.g. units string
-- contining "{}" chars. The real solution is to use the dADL parser on
-- the buffer from the current point on and be able to fast-forward the
-- cursor to the last character matched by the dADL scanner
-- the following version matches a type name without () and is deprecated

[A-Z]{IDCHAR}*[ \n]*&lt;               -- match a pattern like
                                    -- 'Type_Identifier whitespace &lt;'

-- the following version is correct ADL 1.4/ADL 1.5
\([A-Z]{IDCHAR}*\)[ \n]*&lt;           -- match a pattern like
                                    -- '(Type_Identifier) whitespace &lt;'
&lt;IN_C_DOMAIN_TYPE&gt; {
[^}&gt;]*&gt;[ \n]*[^&gt;}A-Z]               -- match up to next &gt; not
                                    -- followed by a '}' or '&gt;'
[^}&gt;]*&gt;+[ \n]*[}A-Z]                -- final section - '...&gt;
                                    -- whitespace } or beginning of
                                    -- a type identifier'
[^}&gt;]*[ \n]*}                       -- match up to next '}' not
}                                   -- preceded by a '&gt;'

----------/* V_REGEXP */ -------------------------------------
-- {mini-parser specification}
"{/"                            -- start of regexp
&lt;IN_REGEXP1&gt;[^/]*\\\/           -- match any segments with quoted slashes
&lt;IN_REGEXP1&gt;[^/}]*\/            -- match final segment
\^[^^\n]*\^                     -- regexp formed using '^' delimiters

----------/* V_INTEGER */ -----------------------------------------------
[0-9]+

----------/* V_REAL */ -----------------------------------------------
[0-9]+\.[0-9]+
[0-9]+\.[0-9]+[eE][+-]?[0-9]+

----------/* V_STRING */ -----------------------------------------------
\"[^\\\n"]*\"
\"[^\\\n"]*{ -- beginning of a multi-line string
&lt;IN_STR&gt; {
\\\\ -- match escaped backslash, i.e. \\ -&gt; \
\\\" -- match escaped double quote, i.e. \" -&gt; "
{UTF8CHAR}+ -- match UTF8 chars
[^\\\n"]+ -- match any other characters
\\\n[ \t\r]* -- match LF in line
[^\\\n"]*\" -- match final end of string
.|\n |
&lt;&lt;EOF&gt;&gt; -- unclosed String -&gt; ERR_STRING</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_assertions"><a class="anchor" href="#_assertions"></a>6. Assertions</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_4"><a class="anchor" href="#_overview_4"></a>6.1. Overview</h3>
<div class="paragraph">
<p>This section describes the assertion sub-language of archetypes. Assertions are used in archetype "slot" clauses in the cADL <code>definition</code> section, and in the <code>invariant</code> section. The following simple assertion in an invariant clause says that the speed in kilometres of some node is related to the speed-in-miles by a factor of 1.6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="expr"><span></span>    validity: /speed[at0002]/kilometres/magnitude = /speed[at0004]/miles/magnitude * 1.6</code></pre>
</div>
</div>
<div class="paragraph">
<p>The archetype assertion language is a small language of its own. Formally it is a first-order predicate logic with equality and comparison operators (=, &gt;, etc). It is very nearly a subset of the OMG’s emerging OCL (Object Constraint Language) syntax, and is very similar to the assertion syntax which has been used in the Object Z <span class="citation">(<a href="#Object_Z">Smith&#44; 2000</a>)</span> and the Eiffel <span class="citation">(<a href="#Eiffel">Meyer&#44; 1992</a>)</span> languages and tools for over a decade. (See <span class="citation"><a href="#Sowa2000">Sowa (2000)</a></span>, <span class="citation"><a href="#Hein2002">Hein (2002)</a></span>, <span class="citation"><a href="#Kilov1994">Kilov &amp; Ross (1994)</a></span> for an explanation of predicate logic in information modelling.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_keywords_3"><a class="anchor" href="#_keywords_3"></a>6.2. Keywords</h3>
<div class="paragraph">
<p>The syntax of the invariant section is a subset of first-order predicate logic. In it, the following keywords can be used:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>exists</code> , <code>for_all</code> ,</p>
</li>
<li>
<p><code>and</code> , <code>or</code> , <code>xor</code> , <code>not</code> , <code>implies</code></p>
</li>
<li>
<p><code>true</code> , <code>false</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Symbol equivalents for some of the above are given in the following table.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 60%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Textual<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Symbolic<br>
 Rendering</th>
<th class="tableblock halign-left valign-top">Meaning</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">matches, is_in</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∈</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Set membership, "p is in P"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">exists</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∃</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Existential quantifier, "there exists &#8230;&#8203;"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">for_all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∀</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Universal quantifier, "for all x&#8230;&#8203;"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">implies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">®</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Material implication, "p implies q", or "if p then q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">and</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∧</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical conjunction, "p and q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">or</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∨</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Logical disjunction, "p or q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">xor</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∨</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Exclusive or, "only one of p or q"</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">not, ~</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">∼, ¬</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Negation, "not p"</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code>not</code> operator can be applied as a prefix operator to all other operators except <code>for_all</code>; either textual rendering <code>not</code> or <code>~</code> can be used.</p>
</div>
</div>
<div class="sect2">
<h3 id="_operators"><a class="anchor" href="#_operators"></a>6.3. Operators</h3>
<div class="paragraph">
<p>Assertion expressions can include arithmetic, relational and boolean operators, plus the existential and universal quantifiers.</p>
</div>
<div class="sect3">
<h4 id="_arithmetic_operators"><a class="anchor" href="#_arithmetic_operators"></a>6.3.1. Arithmetic Operators</h4>
<div class="paragraph">
<p>The supported arithmetic operators are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>addition: <code>+</code></p>
</li>
<li>
<p>subtraction: <code>-</code></p>
</li>
<li>
<p>multiplication: <code>*</code></p>
</li>
<li>
<p>division: <code>/</code></p>
</li>
<li>
<p>exponent: <code>^</code></p>
</li>
<li>
<p>modulo division: <code>%</code>&#8201;&#8212;&#8201;remainder after integer division</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_equality_operators"><a class="anchor" href="#_equality_operators"></a>6.3.2. Equality Operators</h4>
<div class="paragraph">
<p>The supported equality operators are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>equality: <code>=</code></p>
</li>
<li>
<p>inequality: <code>&lt;&gt;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The semantics of these operators are of value comparison.</p>
</div>
</div>
<div class="sect3">
<h4 id="_relational_operators"><a class="anchor" href="#_relational_operators"></a>6.3.3. Relational Operators</h4>
<div class="paragraph">
<p>The supported relational operators are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>less than: <code>&lt;</code></p>
</li>
<li>
<p>less than or equal: <code>&lt;=</code></p>
</li>
<li>
<p>greater than: <code>&gt;</code></p>
</li>
<li>
<p>greater than or equal: <code>&gt;=</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The semantics of these operators are of value comparison on entities of Comparable types (see openEHR Support IM, Assumed Types section). All generate a Boolean result.</p>
</div>
</div>
<div class="sect3">
<h4 id="_boolean_operators"><a class="anchor" href="#_boolean_operators"></a>6.3.4. Boolean Operators</h4>
<div class="paragraph">
<p>The supported boolean operators are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>not: <code>not</code></p>
</li>
<li>
<p>and: <code>and</code></p>
</li>
<li>
<p>xor: <code>xor</code></p>
</li>
<li>
<p>implies: <code>implies</code></p>
</li>
<li>
<p>set membership: <code>matches</code>, <code>is_in</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The boolean operators also have symbolic equivalents shown earlier.</p>
</div>
</div>
<div class="sect3">
<h4 id="_quantifiers"><a class="anchor" href="#_quantifiers"></a>6.3.5. Quantifiers</h4>
<div class="paragraph">
<p>The two standard logical quantifier operators are supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>existential quantifier: <code>exists</code></p>
</li>
<li>
<p>universal quantifier: <code>for_all</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These operators also have the usual symbolic equivalents shown earlier.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_operands"><a class="anchor" href="#_operands"></a>6.4. Operands</h3>
<div class="paragraph">
<p>Operands in an assertion expression can be any of the following:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><em>manifest constant</em></dt>
<dd>
<p>any constant of any primitive type, expressed according to the dADL syntax for values;</p>
</dd>
<dt class="hdlist1"><em>variable reference</em></dt>
<dd>
<p>any name starting with <code>$</code>, e.g. <code>$body_weight</code>;</p>
</dd>
<dt class="hdlist1"><em>object reference</em></dt>
<dd>
<p>a path referring to an object node, i.e. any path ending in a node identifier;</p>
</dd>
<dt class="hdlist1"><em>property reference</em></dt>
<dd>
<p>a path referring to a property, i.e. any path ending in <code>.property_name</code>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If an assertion is used in an archetype slot definition, its paths refer to the archetype filling the slot, not the one containing the slot.</p>
</div>
</div>
<div class="sect2">
<h3 id="_precedence_and_parentheses"><a class="anchor" href="#_precedence_and_parentheses"></a>6.5. Precedence and Parentheses</h3>
<div class="paragraph tbd">
<p>To be continued.</p>
</div>
</div>
<div class="sect2">
<h3 id="_future"><a class="anchor" href="#_future"></a>6.6. Future</h3>
<div class="sect3">
<h4 id="_variables"><a class="anchor" href="#_variables"></a>6.6.1. Variables</h4>
<div class="paragraph tbd">
<p><strong>TBD</strong>: : main problem of variables is that they must have names, which are language-dependent; imagine if there were a mixture of variables added by authors in different languages. The only solution is to name them with terms.</p>
</div>
<div class="paragraph tbd">
<p><strong>TBD</strong>: : Variables have to be treated as term coordinations, and should be coded e.g. using ccNNNN codes (“cc” = coordinated code). Then they can be given meanings in any language.</p>
</div>
<div class="sect4">
<h5 id="_predefined_variables"><a class="anchor" href="#_predefined_variables"></a>6.6.1.1. Predefined Variables</h5>
<div class="paragraph">
<p>A number of predefined variables can be referenced in ADL assertion expressions, without prior definition, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>$current_date: Date</code>; returns the date whenever the archetype is evaluated</p>
</li>
<li>
<p><code>$current_time: Time</code>; returns time whenever the archetype is evaluated</p>
</li>
<li>
<p><code>$current_date_time: Date_Time</code>; returns date/time whenever the archetype is evaluated</p>
</li>
</ul>
</div>
<div class="paragraph tbd">
<p>To Be Continued: these should be coded as well, using openEHR codes</p>
</div>
</div>
<div class="sect4">
<h5 id="_archetype_defined_variables"><a class="anchor" href="#_archetype_defined_variables"></a>6.6.1.2. Archetype-defined Variables</h5>
<div class="paragraph">
<p>Variables can also be defined inside an archetype, as part of the assertion statements in an invariant. The syntax of variable definition is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre> let $var_name = reference</pre>
</div>
</div>
<div class="paragraph">
<p>Here, a reference can be any of the operand types listed above. 'Let' statements can come anywhere in an <code>invariant</code> block, but for readability, should generally come first.
The following example illustrates the use of variables in an invariant block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>invariant
    let $sys_bp = /data[at9001]/events[at9002]/data[at1000]/items[at1100]
    let $dia_bp = /data[at9001]/events[at9002]/data[at1000]/items[at1200]
    $sys_bp &gt;= $dia_bp</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_specification_3"><a class="anchor" href="#_syntax_specification_3"></a>6.7. Syntax Specification</h3>
<div class="paragraph">
<p>The assertion grammar is part of the cADL grammar. This grammar is implemented and tested using lex (.l file) and yacc (.y file) specifications for in the Eiffel programming environment. The 1.4 release of these files is available in the <a href="https://github.com/openEHR/adl-tools/tree/Release-1.4/components/adl_parser/src/syntax/cadl/parser" target="_blank" rel="noopener">cADL grammar files</a>. The .l and .y files can be converted for use in another yacc/lex-based programming environment.</p>
</div>
<div class="sect3">
<h4 id="_grammar_3"><a class="anchor" href="#_grammar_3"></a>6.7.1. Grammar</h4>
<div class="paragraph">
<p>The following provides the assertion parser production rules (yacc specification). Note that because of interdependencies with path and assertion production rules, practical implementations may have to include all production rules in one parser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">assertions</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">assertion</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">assertions</span><span class="tok-w"> </span><span class="tok-nv">assertion</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">assertion</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">any_identifier</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_expression</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_node</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_node</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_EXISTS</span><span class="tok-w"> </span><span class="tok-nv">absolute_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-no">SYM_START_CBLOCK</span><span class="tok-w"> </span><span class="tok-nv">c_primitive</span><span class="tok-w"> </span><span class="tok-no">SYM_END_CBLOCK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_NOT</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_NE</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_AND</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_OR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_XOR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span><span class="tok-w"> </span><span class="tok-no">SYM_IMPLIES</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_leaf</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arithmetic_expression</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_node</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arithmetic_node</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arithmetic_leaf</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expression</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">absolute_path</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adl_paths"><a class="anchor" href="#_adl_paths"></a>7. ADL Paths</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_5"><a class="anchor" href="#_overview_5"></a>7.1. Overview</h3>
<div class="paragraph">
<p>The notion of paths is integral to ADL, and a common path syntax is used to reference nodes in both dADL and cADL sections of an archetype. The same path syntax works for both, because both dADL and cADL have an alternating object/attribute structure. However, the interpretation of path expressions in dADL and cADL differs slightly; the differences are explained in the dADL and cADL sections of this document. This section describes only the common syntax and semantics.</p>
</div>
<div class="paragraph">
<p>The general form of the path syntax is as follows (see syntax section below for full specification):</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-w">    </span><span class="tok-nl">path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">path_segment</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">path_segment</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-w">    </span><span class="tok-nl">path_segment</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">attr_name</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">object_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Essentially, ADL paths consist of segments separated by slashes (<code>'/'</code>), where each segment is an attribute name with optional object identifier predicate, indicated by brackets ('[]').</p>
</div>
<div class="paragraph principle">
<p><strong>ADL Paths</strong> are formed from an alternation of segments made up of an attribute name and optional object node identifier predicate, separated by slash (<code>'/'</code>) characters. Node identifiers are delimited by brackets (i.e. <code>[]</code>).</p>
</div>
<div class="paragraph">
<p>Similarly to paths used in file systems, ADL paths are either absolute or relative, with the former being indicated by a leading slash.</p>
</div>
<div class="paragraph principle">
<p>Paths are <strong>absolute</strong> or <strong>relative</strong> with respect to the document in which they are mentioned. Absolute paths commence with an initial slash ('/') character.</p>
</div>
<div class="paragraph">
<p>The ADL path syntax also supports the concept of "movable" path patterns, i.e. paths that can be used to find a section anywhere in a hierarchy that matches the path pattern. Path patterns are indicated with a leading double slash ('//') as in Xpath.</p>
</div>
<div class="paragraph principle">
<p><strong>Path patterns</strong> are absolute or relative with respect to the document in which they are mentioned. Absolute paths commence with an initial slash ('/') character.</p>
</div>
</div>
<div class="sect2">
<h3 id="_relationship_with_w3c_xpath"><a class="anchor" href="#_relationship_with_w3c_xpath"></a>7.2. Relationship with W3C Xpath</h3>
<div class="paragraph">
<p>The ADL path syntax is semantically a subset of the Xpath query language, with a few syntactic shortcuts to reduce the verbosity of the most common cases. Xpath differentiates between "children" and "attributes" sub-items of an object due to the difference in XML between Elements (true sub-objects) and Attributes (tag-embedded primitive values). In ADL, as with any pure object formalism, there is no such distinction, and all sub-parts of any object are referenced in the manner of Xpath children; in particular, in the Xpath abbreviated syntax, the key <code>child::</code> does not need to be used.</p>
</div>
<div class="paragraph">
<p>ADL does not distinguish attributes from children, and also assumes the node_id attribute. Thus, the following expressions are legal for cADL structures:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span>1<span class="tok-p">]</span><span class="tok-w">                            </span><span class="tok-c">-- the first member of &#39;items&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nc">systolic</span><span class="tok-p">]</span><span class="tok-w">                     </span><span class="tok-c">-- the member of &#39;items&#39; with meaning &#39;systolic&#39;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-p">[</span><span class="tok-nd">at0001</span><span class="tok-p">]</span><span class="tok-w">                       </span><span class="tok-c">-- the member of &#39;items&#39; with node id &#39;at0001&#39;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The Xpath equivalents are:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="xpath"><span></span>    items[1]                                -- the first member of &#39;items&#39;
    items[meaning() = &#39;systolic&#39;]           -- the member of &#39;items&#39; for which the meaning()
                                            -- function evaluates to &quot;systolic&quot;
    items[@archetype_node_id = &#39;at0001&#39;]    -- the member of &#39;items&#39; with key &#39;at0001&#39;</code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, <code>meaning()</code> is a notional function is defined for Xpath in openEHR, which returns the rubric for the node_id of the current node. Such paths are only for display purposes, and paths used for computing always use the 'at' codes, e.g. <code>items[at0001]</code>, for which the Xpath equivalent is <code>items[@node_id = 'at0001']</code>.</p>
</div>
<div class="paragraph">
<p>The ADL movable path pattern is a direct analogue of the Xpath syntax abbreviation for the 'descendant' axis.</p>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_specification_4"><a class="anchor" href="#_syntax_specification_4"></a>7.3. Syntax Specification</h3>
<div class="paragraph">
<p>The path grammar is part of the cADL grammar. This grammar is implemented and tested using lex (.l file) and yacc (.y file) specifications for in the Eiffel programming environment. The 1.4 release of these files is available in the <a href="https://github.com/openEHR/adl-tools/tree/Release-1.4/components/adl_parser/src/syntax/cadl/parser">cADL grammar files</a>. The .l and .y files can be converted for use in another yacc/lex-based programming environment.</p>
</div>
<div class="sect3">
<h4 id="_grammar_4"><a class="anchor" href="#_grammar_4"></a>7.3.1. Grammar</h4>
<div class="paragraph">
<p>The following provides the assertion parser production rules (yacc specification). Note that because of interdependencies with path and assertion production rules, practical implementations may have to include all production rules in one parser.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">input</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">movable_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">absolute_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">movable_path</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_MOVABLE_LEADER</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span>

<span class="tok-nv">absolute_path</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">absolute_path</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">relative_path</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">path_segment</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relative_path</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-nv">path_segment</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">path_segment</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span><span class="tok-w"> </span><span class="tok-no">V_LOCAL_TERM_CODE_REF</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">V_ATTRIBUTE_IDENTIFIER</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_symbols_3"><a class="anchor" href="#_symbols_3"></a>7.3.2. Symbols</h4>
<div class="paragraph">
<p>The following specifies the symbols and lexical patterns used in the path grammar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>----------/* symbols */ -------------------------------------------------
"."     -- -&gt; Dot_code
"/"     -- -&gt; Slash_code
"["     -- -&gt; Left_bracket_code
"]"     -- -&gt; Right_bracket_code
"//"    -- -&gt; SYM_MOVABLE_LEADER

----------/* term code reference */ -------------------------------------
\[[a-zA-Z0-9][a-zA-Z0-9._\-]*\] -- -&gt; V_LOCAL_TERM_CODE_REF

----------/* identifiers */ ---------------------------------------------
[a-z][a-zA-Z0-9_]*              -- -&gt; V_ATTRIBUTE_IDENTIFIER</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adl_archetype_definition_language"><a class="anchor" href="#_adl_archetype_definition_language"></a>8. ADL - Archetype Definition Language</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction"><a class="anchor" href="#_introduction"></a>8.1. Introduction</h3>
<div class="paragraph">
<p>This section describes ADL archetypes as a whole, adding a small amount of detail to the descriptions of dADL and cADL already given. The important topic of the relationship of the cADL-encoded definition section and the dADL-encoded ontology section is discussed in detail. In this section, only standard ADL (i.e. the cADL and dADL constructs and types described so far) is assumed. Archetypes for use in particular domains can also be built with more efficient syntax and domain-specific types, as described in <a href="#_customising_adl">Section 9</a>, and the succeeding sections.</p>
</div>
<div class="paragraph">
<p>An ADL archetype follows the structure shown below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>archetype
    archetype_id
[specialize
    parent_archetype_id]
concept
    coded_concept_name
language
    dADL language description section
[description
    dADL meta-data description section]
definition
    cADL structural section
invariant
    assertions
ontology
    dADL definitions section
[revision_history
    dADL section]</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_basics_3"><a class="anchor" href="#_basics_3"></a>8.2. Basics</h3>
<div class="sect3">
<h4 id="_keywords_4"><a class="anchor" href="#_keywords_4"></a>8.2.1. Keywords</h4>
<div class="paragraph">
<p>ADL has a small number of keywords which are reserved for use in archetype declarations, as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>archetype</code>, <code>specialise</code> / <code>specialize</code>, <code>concept</code>,</p>
</li>
<li>
<p><code>language</code> ,</p>
</li>
<li>
<p><code>description</code> , <code>definition</code> , <code>invariant</code> , <code>ontology</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All of these words can safely appear as identifiers in the <code>definition</code> and <code>ontology</code> sections.</p>
</div>
</div>
<div class="sect3">
<h4 id="_node_identification"><a class="anchor" href="#_node_identification"></a>8.2.2. Node Identification</h4>
<div class="paragraph">
<p>In the definition section of an ADL archetype, a particular scheme of codes is used for node identifiers as well as for denoting constraints on textual (i.e. language dependent) items. Codes are either local to the archetype, or from an external lexicon. This means that the archetype description is the same in all languages, and is available in any language that the codes have been translated to. All term codes are shown in brackets (<code>[]</code>). Codes used as node identifiers and defined within the same archetype are prefixed with <code>at</code> and by convention have 4 digits, e.g. <code>[at0010]</code>. Codes of any length are acceptable in ADL archetypes. Specialisations of locally coded concepts have the same root, followed by 'dot' extensions, e.g. <code>[at0010.2]</code>. From a terminology point of view, these codes have no implied semantics - the 'dot' structuring is used as an optimisation on node identification.</p>
</div>
</div>
<div class="sect3">
<h4 id="_local_constraint_codes"><a class="anchor" href="#_local_constraint_codes"></a>8.2.3. Local Constraint Codes</h4>
<div class="paragraph">
<p>A second kind of local code is used to stand for constraints on textual items in the body of the archetype. Although these could be included in the main archetype body, because they are language- and/or terminology-sensitive, they are defined in the ontology section, and referenced by codes prefixed by <code>ac</code>, e.g. <code>[ac0009]</code>. As for <code>at</code> codes, the convention used in this document is to use 4-digit <code>ac</code> codes, even though any number of digits is acceptable. The use of these codes is described in section
<a href="#Constraint_definitions section">[Constraint_definitions section]</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_header_sections"><a class="anchor" href="#_header_sections"></a>8.3. Header Sections</h3>
<div class="sect3">
<h4 id="_archetype_section"><a class="anchor" href="#_archetype_section"></a>8.3.1. Archetype Section</h4>
<div class="paragraph">
<p>This section introduces the archetype and must include an identifier. A typical archetype section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">1.4</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology.v1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The multi-axial identifier identifies archetypes in a global space. The syntax of the identifier is described in <a href="#Archetype Identification">[Archetype Identification]</a> in <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/archetype_system.pdf" target="_blank" rel="noopener">The openEHR Archetype System</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_controlled_indicator"><a class="anchor" href="#_controlled_indicator"></a>8.3.2. Controlled Indicator</h4>
<div class="paragraph">
<p>A flag indicating whether the archetype is change-controlled or not can be included after the version, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">1.4</span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-nc">controlled</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology.v1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This flag may have the two values "controlled" and "uncontrolled" only, and is an aid to software. Archetypes that include the "controlled" flag should have the revision history section included, while those with the "uncontrolled" flag, or no flag at all, may omit the revision history. This enables archetypes to be privately edited in an early development phase without generating large revision histories of little or no value.</p>
</div>
</div>
<div class="sect3">
<h4 id="_specialise_section"><a class="anchor" href="#_specialise_section"></a>8.3.3. Specialise Section</h4>
<div class="paragraph">
<p>This optional section indicates that the archetype is a specialisation of some other archetype, whose identity must be given. Only one specialisation parent is allowed, i.e. an archetype cannot 'multiply-inherit' from other archetypes. An example of declaring specialisation is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">archetype</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nc">adl_version</span><span class="tok-o">=</span><span class="tok-l">1.4</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology-cbc.v1</span>
<span class="tok-gh">specialise</span>
<span class="tok-w">    </span><span class="tok-nd">openEHR-EHR-OBSERVATION.haematology.v1</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Here the identifier of the new archetype is derived from that of the parent by adding a new section to its domain concept section. See the <code>ARCHETYPE_ID</code> definition in the identification package in the <a href="https://specifications.openehr.org/releases/RM/latest/support.html" target="_blank" rel="noopener">openEHR Support IM specification</a>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
both the US and British English versions of the word "specialise" are valid in ADL.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_concept_section"><a class="anchor" href="#_concept_section"></a>8.3.4. Concept Section</h4>
<div class="paragraph">
<p>All archetypes represent some real world concept, such as a "patient", a "blood pressure", or an "antenatal examination". The concept is always coded, ensuring that it can be displayed in any language the archetype has been translated to. A typical concept section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>concept
    [at0010] -- haematology result</pre>
</div>
</div>
<div class="paragraph">
<p>In this concept definition, the term definition of <code>[at0010]</code> is the proper description corresponding to the "haematology-cbc" section of the archetype id above.</p>
</div>
</div>
<div class="sect3">
<h4 id="_language_section_and_language_translation"><a class="anchor" href="#_language_section_and_language_translation"></a>8.3.5. Language Section and Language Translation</h4>
<div class="paragraph">
<p>The <code>language</code> section includes data describing the original language in which the archetype was authored (essential for evaluating natural language quality), and the total list of languages available in the archetype. There can be only one <code>original_language</code>. The <code>translations</code> list must be updated every time a translation of the archetype is undertaken. The following shows a typical example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">language</span>
<span class="tok-w">    </span><span class="tok-nc">original_language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">translations</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">de</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Frederik Tyler&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;freddy@something.somewhere.co.uk&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">accreditation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;British Medical Translator id 00400595&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;ru&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">ru</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Nina Alexandrovna&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dostoevsky Media Services&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;email&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nina@translation.dms.ru&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">accreditation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Russian Translator id 892230-3A&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Archetypes must always be translated completely, or not at all, to be valid. This means that when a new translation is made, every language dependent section of the <code>description</code> and <code>ontology</code> sections has to be translated into the new language, and an appropriate addition made to the <code>translations</code> list in the language section.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
some non-conforming ADL tools in the past created archetypes without a <code>language</code> section, relying on the <code>ontology</code> section to provide the <code>original_language</code> (there called <code>primary_language</code>) and list of languages (<code>languages_available</code>). In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_description_section"><a class="anchor" href="#_description_section"></a>8.3.6. Description Section</h4>
<div class="paragraph">
<p>The <code>description</code> section of an archetype contains descriptive information, or what some people think of as document "meta-data", i.e. items that can be used in repository indexes and for searching. The dADL syntax, described in <a href="#_dadl_data_adl">Section 4</a>, is used for the description, as in the following example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dr J Joyce&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NT Health Service&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2003-08-03</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;initial&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">resource_package_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.aihw.org.au/data_sets/diabetic_archetypes.html&quot;</span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;archetype for diabetic patient review&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">use</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;used for all hospital or clinic-based diabetic reviews,</span>
<span class="tok-w">                </span><span class="tok-nc">including</span><span class="tok-w"> </span><span class="tok-nc">first</span><span class="tok-w"> </span><span class="tok-nc">time</span><span class="tok-err">.</span><span class="tok-w"> </span><span class="tok-err">O</span><span class="tok-nc">ptional</span><span class="tok-w"> </span><span class="tok-nc">sections</span><span class="tok-w"> </span><span class="tok-nc">are</span><span class="tok-w"> </span><span class="tok-nc">removed</span><span class="tok-w"> </span><span class="tok-nc">according</span><span class="tok-w"> </span><span class="tok-nc">to</span><span class="tok-w"> </span><span class="tok-nc">the</span><span class="tok-w"> </span><span class="tok-nc">particular</span><span class="tok-w"> </span><span class="tok-nc">review</span><span class="tok-s">&quot;&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">misuse</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;not appropriate for pre-diagnosis use&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">original_resource_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">de</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w">  </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Archetyp für die Untersuchung von Patienten mit Diabetes&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">use</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;wird benutzt für alle Diabetes-Untersuchungen im</span>
<span class="tok-w">                    </span><span class="tok-err">K</span><span class="tok-nc">rankenhaus</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nc">inklusive</span><span class="tok-w"> </span><span class="tok-nc">der</span><span class="tok-w"> </span><span class="tok-nc">ersten</span><span class="tok-w"> </span><span class="tok-err">V</span><span class="tok-nc">orstellung</span><span class="tok-err">.</span><span class="tok-w"> </span><span class="tok-err">O</span><span class="tok-nc">ptionale</span>
<span class="tok-w">                    </span><span class="tok-err">A</span><span class="tok-nc">bschnitte</span><span class="tok-w"> </span><span class="tok-nc">werden</span><span class="tok-w"> </span><span class="tok-nc">in</span><span class="tok-w"> </span><span class="tok-err">A</span><span class="tok-nc">bhängigkeit</span><span class="tok-w"> </span><span class="tok-nc">von</span><span class="tok-w"> </span><span class="tok-nc">der</span><span class="tok-w"> </span><span class="tok-nc">speziellen</span>
<span class="tok-w">                    </span><span class="tok-err">V</span><span class="tok-nc">orstellung</span><span class="tok-w"> </span><span class="tok-nc">entfernt</span><span class="tok-err">.</span><span class="tok-s">&quot;&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">misuse</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;nicht geeignet für Benutzung vor Diagnosestellung&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">original_resource_uri</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;http://www.healthdata.org.au/data_sets/diabetic_review_data_set_1.html&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>A number of details are worth noting here. Firstly, the free hierarchical structuring capability of dADL is exploited for expressing the 'deep' structure of the <code>details</code> section and its subsections. Secondly, the dADL qualified list form is used to allow multiple translations of the <code>purpose</code> and <code>use</code> to be shown. Lastly, empty items such as <code>misuse</code> (structured if there is data) are shown with just one level of empty brackets. The above example shows meta-data based on the <a href="https://specifications.openehr.org/releases/AM/latest/AOM1.4.html" target="_blank" rel="noopener">openEHR Archetype Object Model (AOM)</a>.</p>
</div>
<div class="paragraph">
<p>The <code>description</code> section is technically optional according to the AOM, but in any realistic use of ADL for archetypes, it will be required. A minimal description section satisfying to the AOM is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">description</span>
<span class="tok-w">    </span><span class="tok-nc">original_author</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;name&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Dr J Joyce&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NT Health Service&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2003-08-03</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">lifecycle_state</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;initial&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">language</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">iso_639-1</span><span class="tok-p">::</span><span class="tok-nd">en</span><span class="tok-p">]&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">purpose</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;archetype for diabetic patient review&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="sect4">
<h5 id="_extending_meta_data"><a class="anchor" href="#_extending_meta_data"></a>8.3.6.1. Extending meta-data</h5>
<div class="paragraph">
<p>The <code>description</code> section models a specific set of meta-data items, but of course, the meta-data needs over time can never be fully predicted. To enable free extension of the <code>description</code> section, the <code>other_details</code> is used. Its structure takes the form of a Hash of strings, i.e. <code>Hash &lt;String, String&gt;</code>, and can be used to contain other meta-data items not explicitly modelled.</p>
</div>
<div class="paragraph">
<p>The <a href="#_extended_meta_data_guide">Appendix B</a> Appendix describes the known uses of extended meta-data to date.</p>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_definition_section"><a class="anchor" href="#_definition_section"></a>8.4. Definition Section</h3>
<div class="paragraph">
<p>The <code>definition</code> section contains the main formal definition of the archetype, and is written in <a href="#_cadl_constraint_adl">the Constraint Definition Language</a>). A typical <code>definition</code> section is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">definition</span>
<span class="tok-w">    </span><span class="tok-nc">OBSERVATION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                              </span><span class="tok-c">-- blood pressure measurement</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                                         </span><span class="tok-c">-- any synonym of BP</span>
<span class="tok-w">            </span><span class="tok-nc">CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0001</span><span class="tok-p">]}</span>
<span class="tok-w">                </span><span class="tok-p">}</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">HISTORY</span><span class="tok-p">[</span><span class="tok-nd">at9001</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                           </span><span class="tok-c">-- history</span>
<span class="tok-w">                </span><span class="tok-nc">events</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">1..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                    </span><span class="tok-nc">EVENT</span><span class="tok-p">[</span><span class="tok-nd">at9002</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..1</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">               </span><span class="tok-c">-- baseline</span>
<span class="tok-w">                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0002</span><span class="tok-p">]}</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-p">}</span>
<span class="tok-w">                        </span><span class="tok-nc">data</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                            </span><span class="tok-nc">ITEM_LIST</span><span class="tok-p">[</span><span class="tok-nd">at1000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                           </span><span class="tok-c">-- systemic arterial BP</span>
<span class="tok-w">                                </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-kt">cardinality </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">2..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at1100</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                     </span><span class="tok-c">-- systolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                            </span><span class="tok-c">-- any synonym of &#39;systolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0002</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">QUANTITY</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">  </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">          </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at1200</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- diastolic BP</span>
<span class="tok-w">                                        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-w">                                 </span><span class="tok-c">-- any synonym of &#39;diastolic&#39;</span>
<span class="tok-w">                                            </span><span class="tok-nc">CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">ac0003</span><span class="tok-p">]}</span>
<span class="tok-w">                                                </span><span class="tok-p">}</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                            </span><span class="tok-nc">QUANTITY</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span>
<span class="tok-w">                                                </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{|</span><span class="tok-mi">0</span><span class="tok-p">..</span><span class="tok-mi">1000</span><span class="tok-p">|}</span>
<span class="tok-w">                                                </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">properties</span><span class="tok-p">::</span><span class="tok-nd">944</span><span class="tok-p">]}</span><span class="tok-w">   </span><span class="tok-c">-- &quot;pressure&quot;</span>
<span class="tok-w">                                                </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{[</span><span class="tok-nd">units</span><span class="tok-p">::</span><span class="tok-nd">387</span><span class="tok-p">]}</span><span class="tok-w">           </span><span class="tok-c">-- &quot;mm[Hg]&quot;</span>
<span class="tok-w">                                            </span><span class="tok-p">}</span>
<span class="tok-w">                                        </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-p">}</span>
<span class="tok-w">                                    </span><span class="tok-nc">ELEMENT</span><span class="tok-p">[</span><span class="tok-nd">at9000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-kt">occurrences </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">0..*</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-o">∈</span><span class="tok-w"> </span><span class="tok-p">{</span><span class="tok-m">*</span><span class="tok-p">}</span><span class="tok-w">    </span><span class="tok-c">-- unknown new item</span>
<span class="tok-w">                                </span><span class="tok-p">}</span>
<span class="tok-w">                            </span><span class="tok-p">...</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This definition expresses constraints on instances of the types <code>ENTRY</code> , <code>HISTORY</code> , <code>EVENT</code> , <code>ITEM_LIST</code> , <code>ELEMENT</code> , <code>QUANTITY</code> , and <code>CODED_TEXT</code> so as to allow them to represent a blood pressure measurement, consisting of a history of measurement events, each consisting of at least systolic and diastolic pressures, as well as any number of other items (expressed by the <code>[at9000]</code> "any" node near the bottom).</p>
</div>
<div class="sect3">
<h4 id="_design_time_and_run_time_paths"><a class="anchor" href="#_design_time_and_run_time_paths"></a>8.4.1. Design-time and Run-time paths</h4>
<div class="paragraph">
<p>All non-unique sibling nodes in a cADL text that correspond to nodes in data which might be referred to from elsewhere in the archetype (via <code>use_node</code>), or might be queried at runtime, require a node identifier. It is preferable to assign a 'design-time meaning', enabling paths and queries to be expressed using logical meanings rather than meaningless identifiers. When data are created according to the <code>definition</code> section of an archetype, the archetype node identifiers can be written into the data, providing a reliable way of finding data nodes, regardless of what other runtime names might have been chosen by the user for the node in question. There are two reasons for doing this. Firstly, querying cannot rely on runtime names of nodes (e.g. names like "sys BP", "systolic bp", "sys blood press." entered by a doctor are unreliable for querying); secondly, it allows runtime data retrieved from a persistence mechanism to be re-associated with the cADL structure which was used to create it.</p>
</div>
<div class="paragraph">
<p>An example which shows the difference between design-time meanings associated with node identifiers and runtime names is the following, from a <code>SECTION</code> archetype representing the problem/SOAP headings (a simple heading structure commonly used by clinicians to record patient contacts under top-level headings corresponding to the patient&#8217;s problem(s), and under each problem heading, the headings "subjective", "objective", "assessment", and "plan").</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-w">    </span><span class="tok-nc">SECTION</span><span class="tok-p">[</span><span class="tok-nd">at0000</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-w">                          </span><span class="tok-c">-- problem</span>
<span class="tok-w">        </span><span class="tok-nc">name</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">            </span><span class="tok-nc">CODED_TEXT</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">                </span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{[</span><span class="tok-nd">ac0001</span><span class="tok-p">]}</span><span class="tok-w">       </span><span class="tok-c">-- any clinical problem type</span>
<span class="tok-w">            </span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In the above, the node identifier <code>[at0000]</code> is assigned a meaning such as "clinical problem" in the archetype terminology section. The subsequent lines express a constraint on the runtime <em>name</em> attribute, using the internal code <code>[ac0001]</code> . The constraint <code>[ac0001]</code> is also defined in the archetype terminology section with a formal statement meaning "any clinical problem type", which could clearly evaluate to thousands of possible values, such as "diabetes", "arthritis" and so on. As a result, in the runtime data, the node identifier corresponding to "clinical problem" and the actual problem type chosen at runtime by a user, e.g. "diabetes", can both be found. This enables querying to find all nodes with meaning "problem", or all nodes describing the problem "diabetes". Internal <code>[acNNNN]</code> codes are described in <a href="#_local_constraint_codes">Section 8.2.3</a>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_invariant_section"><a class="anchor" href="#_invariant_section"></a>8.5. Invariant Section</h3>
<div class="paragraph">
<p>The <code>rules</code> section in an ADL archetype introduces assertions which relate to the entire archetype, and can be used to make statements which are not possible within the block structure of the <code>definition</code> section. Any constraint which relates more than one property to another is in this category, as are most constraints containing mathematical or logical formulae. Rules are expressed in the archetype assertion language, described in <a href="#_assertions">Section 6</a>.</p>
</div>
<div class="paragraph">
<p>An assertion is a first order predicate logic statement which can be evaluated to a boolean result at runtime. Objects and properties are referred to using paths.</p>
</div>
<div class="paragraph">
<p>The following simple example says that the speed in kilometres of some node is related to the speed-in-miles by a factor of 1.6:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-err">invariant</span>
<span class="tok-err">    validity: /speed[at0002]/kilometres/magnitude = /speed[at0004]/miles/magnitude * 1.6</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ontology_section"><a class="anchor" href="#_ontology_section"></a>8.6. Ontology Section</h3>
<div class="sect3">
<h4 id="_overview_6"><a class="anchor" href="#_overview_6"></a>8.6.1. Overview</h4>
<div class="paragraph">
<p>The <code>ontology</code> section of an archetype is expressed in dADL, and is where codes representing node identifiers, constraints on coded term values, and bindings to terminologies are defined. Linguistic language translations are added in the form of extra blocks keyed by the relevant language. The following example shows the general layout of this section.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">ontology</span>
<span class="tok-w">    </span><span class="tok-nc">terminologies_available</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-p">...&gt;</span>

<span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">constraint_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-nc">constraint_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;...&gt;</span>
<span class="tok-w">            </span><span class="tok-p">...</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The <code>term_definitions</code> section is mandatory, and must be defined for each translation carried out. Each of these sections can have its own meta-data, which appears within description sub-sections, such as the one shown above providing translation details.</p>
</div>
</div>
<div class="sect3">
<h4 id="_ontology_header_statements"><a class="anchor" href="#_ontology_header_statements"></a>8.6.2. Ontology Header Statements</h4>
<div class="paragraph">
<p>The <code>terminologies_available</code> statement includes the identifiers of all terminologies for which <code>term_bindings</code> sections have been written.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
some ADL tools in the past created archetypes with <code>primary_language</code> and <code>languages_available</code> statements rather than the <code>original_languages</code> and <code>translations</code> blocks in the <code>language</code> section. In the interests of backward compatibility, tool builders should consider accepting archetypes of the old form and upgrading them when parsing to the correct form, which should then be used for serialising/saving.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_term_definitions_section"><a class="anchor" href="#_term_definitions_section"></a>8.6.3. Term_definitions Section</h4>
<div class="paragraph">
<p>This section is where all archetype local terms (that is, terms of the form <code>[atNNNN]</code>) are defined. The following example shows an extract from the English and German term definitions for the archetype local terms in a problem/SOAP headings archetype. Each term is defined using a structure of name/value pairs, and must at least include the names "text" and "description", which are akin to the usual rubric, and full definition found in terminologies like SNOMED-CT. Each term object is then included in the appropriate language list of term definitions, as shown in the example below.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-nc">term_definitions</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;en&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The problem experienced by the subject of care to which the contained information relates&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;problem/SOAP headings&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP heading structure for multiple problems&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">...</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at4000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;de&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;klinisches Problem&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Das Problem des Patienten worauf sich diese Informationen beziehen&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Problem/SOAP Schema&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;SOAP-Schlagwort-Gruppierungsschema fuer mehrfache Probleme&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">[</span><span class="tok-s">&quot;at4000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">                    </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                    </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Klinisch-professionelle Beratung des Pflegenden&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">                </span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In some cases, term definitions may have been lifted from existing terminologies (only a safe thing to do if the definitions <em>exactly</em> match the need in the archetype). To indicate where definitions come from, a "provenance" tag can be used, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;at4000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;plan&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;The clinician&#39;s professional advice&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">provenance</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;ACME_terminology(v3.9a)&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that this does not indicate a <em>binding</em> to any term, only the origin of its definition. Bindings are described below.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
the use of <code>items</code> in the above is historical in ADL, and will be changed in ADL2 to the proper form of dADl for nested containers, i.e. removing the "items = &lt;" blocks altogether.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_constraint_definitions_section"><a class="anchor" href="#_constraint_definitions_section"></a>8.6.4. Constraint_definitions Section</h4>
<div class="paragraph">
<p>The constraint_definitions section is of exactly the same form as the <code>term_definitions</code> section, and provides the definitions - i.e. the meanings - of the local constraint codes, which are of the form <code>[acNNNN]</code>. Each such code refers to some constraint such as "any term which is a subtype of 'hepatitis' in the ICD10AM terminology"; the constraint definitions do not provide the constraints themselves, but define the <em>meanings</em> of such constraints, in a manner comprehensible to human beings, and usable in GUI applications. This may seem a superfluous thing to do, but in fact it is quite important. Firstly, term constraints can only be expressed with respect to particular terminologies - a constraint for "kind of hepatitis" would be expressed in different ways for each terminology which the archetype is bound to. For this reason, the actual constraints are defined in the <code>constraint_bindings</code> section. An example of a constraint term definition for the hepatitis constraint is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;ac1015&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">text</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;type of hepatitis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">description</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;any term which means a kind of viral hepatitis&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Note that while it often seems tempting to use classification codes, e.g. from the <a href="http://www.who.int/classifications/icd/en/" target="_blank" rel="noopener">ICD vocabularies</a>, these will rarely be much use in terminology or constraint definitions, because it is nearly always <em>descriptive</em>, not classificatory terms which are needed.</p>
</div>
</div>
<div class="sect3">
<h4 id="_term_bindings_section"><a class="anchor" href="#_term_bindings_section"></a>8.6.5. Term_bindings Section</h4>
<div class="paragraph">
<p>This section is used to describe the equivalences between archetype local terms and terms found in external terminologies. The main purpose for allowing query engine software that wants to search for an instance of some external term to determine what equivalent to use in the archetype. Note that this is distinct from the process of embedding mapped terms in runtime data, which is also possible with the openEHR Reference Model <code>DV_TEXT</code> and <code>DV_CODED_TEXT</code> types.</p>
</div>
<div class="sect4">
<h5 id="_global_term_bindings"><a class="anchor" href="#_global_term_bindings"></a>8.6.5.1. Global Term Bindings</h5>
<div class="paragraph">
<p>There are two types of term bindings that can be used, 'global' and path-based. The former is where an external term is bound directly to an archetype local term, and the binding holds globally throughout the archetype. In many cases, archetype terms only appear once in an archetype, but in some archetypes, at-codes are reused throughout the archetype. In such cases, a global binding asserts that the correspondence is true in all locations. A typical global term binding section resembles the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">term_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;umls&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0000&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C124305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- apgar result</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">0000000</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 1-minute event</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0004&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C234305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- cardiac score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0005&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C232405</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- respiratory score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0006&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C254305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- muscle tone score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0007&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C987305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- reflex response score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0008&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C189305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- color score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0009&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C187305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- apgar score</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0010&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C325305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 2-minute apgar</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0011&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C725354</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 5-minute apgar</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;at0012&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">umls</span><span class="tok-p">::</span><span class="tok-nd">C224305</span><span class="tok-p">]&gt;</span><span class="tok-w"> </span><span class="tok-c">-- 10-minute apgar</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Each entry indicates which term in an external terminology is equivalent to the archetype internal codes. Note that not all internal codes necessarily have equivalents: for this reason, a terminology binding is assumed to be valid even if it does not contain all of the internal codes.</p>
</div>
</div>
<div class="sect4">
<h5 id="_path_based_bindings"><a class="anchor" href="#_path_based_bindings"></a>8.6.5.2. Path-based Bindings</h5>
<div class="paragraph">
<p>The second kind of binding is one between an archetype path and an external code. This occurs commonly for archetypes where a term us re-used at the leaf level. For example, in the binding example below, the at0004 code represents 'temperature' and the codes <code>at0003</code>, <code>at0005</code>, <code>at0006</code> etc correspond to various times such as 'any', 1-hour average, 1-hour maximum and so on. Some terminologies (notably <a href="http://loinc.org" target="_blank" rel="noopener">LOINC</a>, the laboratory terminology in this example) define 'pre-coordinated' codes, such as '1 hour body temperature'; these clearly correspond not to single codes such as at0004 in the archetype, but to whole paths. In such cases, the key in each term binding row is a full path rather than a single term.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-p">[</span><span class="tok-s">&quot;LNC205&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0003]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8310-5</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0005]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8321-2</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0006]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8311-3</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0007]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8316-2</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0008]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8332-0</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0009]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8312-1</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0017]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8325-3</span><span class="tok-p">]&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;/data[at0002]/events[at0019]/data[at0001]/item[at0004]&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;[</span><span class="tok-nd">LNC205</span><span class="tok-p">::</span><span class="tok-nd">8320-4</span><span class="tok-p">]&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_constraint_bindings_section"><a class="anchor" href="#_constraint_bindings_section"></a>8.6.6. Constraint_bindings Section</h4>
<div class="paragraph">
<p>The last of the <code>ontology</code> sections formally describes bindings to placeholder constraints (see <a href="#_placeholder_constraints">Section 5.3.9</a>) from the main archetype body. They are described separately because they are terminology-dependent, and because there may be more than one for a given logical constraint. A typical example follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">constraint_bindings</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;snomed_ct&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">items</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac0001&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org?query_id=12345</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-s">&quot;ac0002&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-l">http://terminology.org?query_id=678910</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, each local constraint code is formally defined to refer to a query defined in a terminology service, in this case, a terminology service that can interrogate the Snomed-CT terminology.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_revision_history_section_2"><a class="anchor" href="#_revision_history_section_2"></a>8.7. Revision History Section</h3>
<div class="paragraph">
<p>The revision history section of an archetype shows the audit history of changes to the archetype, and is expressed in dADL syntax. It is optional, and is included at the end of the archetype, since it does not contain content of direct interest to archetype authors, and will monotonically grow in size. Where archetypes are stored in a version-controlled repository such as CVS or some commercial product, the revision history section would normally be regenerated each time by the authoring software, e.g. via processing of the output of the 'prs' command used with SCCS files, or 'rlog' for RCS files. The following shows a typical example, with entries in most-recent-first order (although technically speaking, the order is irrelevant to ADL).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="adl"><span></span><span class="tok-gh">revision_history</span>
<span class="tok-w">    </span><span class="tok-nc">revision_history</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;1.57&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Miriam Hanoosh&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer_organisation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;AIHW.org.au&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">time_committed</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2004-11-02</span><span class="tok-w"> </span><span class="tok-ld">09:31:04+1000</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">revision</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;1.2&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">reason</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Added social history section&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">change_type</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Modification&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-c">-- etc</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;1.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Enrico Barrios&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer_organisation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;AIHW.org.au&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">time_committed</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2004-09-24</span><span class="tok-w"> </span><span class="tok-ld">11:57:00+1000</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">revision</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;1.1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">reason</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Updated HbA1C test result reference&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">change_type</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Modification&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">[</span><span class="tok-s">&quot;1.0&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Enrico Barrios&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">committer_organisation</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;AIHW.org.au&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">time_committed</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-ld">2004-09-14</span><span class="tok-w"> </span><span class="tok-ld">16:05:00+1000</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">revision</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;1.0&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">reason</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Initial Writing&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">            </span><span class="tok-nc">change_type</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Creation&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">        </span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_validity_rules"><a class="anchor" href="#_validity_rules"></a>8.8. Validity Rules</h3>
<div class="paragraph">
<p>This section describes the formal (i.e. checkable) semantics of ADL archetypes. It is recommended that parsing tools use the identifiers published here in their error messages, as an aid to archetype designers.</p>
</div>
<div class="sect3">
<h4 id="_global_archetype_validity"><a class="anchor" href="#_global_archetype_validity"></a>8.8.1. Global Archetype Validity</h4>
<div class="paragraph">
<p>The following validity constraints apply to an archetype as a whole. Note that the term "section" means the same as "attribute" in the following, i.e. a section called "definition" in a dADL text is a serialisation of the value for the attribute of the same name.</p>
</div>
<div class="paragraph rule">
<p><strong>VARID</strong>: archetype identifier validity. The archetype must have an identifier value for the archetype_id section. The identifier must conform to the published openEHR specification for archetype identifiers.</p>
</div>
<div class="paragraph rule">
<p><strong>VARCN</strong>: archetype concept validity. The archetype must have an archetype term value in the concept section. The term must exist in the archetype ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VARDF</strong>: archetype definition validity. The archetype must have a definition section, expressed as a cADL syntax string, or in an equivalent plug-in syntax.</p>
</div>
<div class="paragraph rule">
<p><strong>VARON</strong>: archetype ontology validity. The archetype must have an ontology section, expressed as a cADL syntax string, or in an equivalent plug-in syntax.</p>
</div>
<div class="paragraph rule">
<p><strong>VARDT</strong>: archetype definition typename validity. The topmost typename mentioned in the archetype definition section must match the type mentioned in the type-name slot of the first segment of the archetype id.</p>
</div>
</div>
<div class="sect3">
<h4 id="_coded_term_validity"><a class="anchor" href="#_coded_term_validity"></a>8.8.2. Coded Term Validity</h4>
<div class="paragraph">
<p>All node identifiers ('at' codes) used in the definition part of the archetype must be defined in the term_definitions part of the ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VATDF</strong>: archetype term validity. Each archetype term used as a node identifier the archetype definition must be defined in the term_definitions part of the ontology. All constraint identifiers ('ac' codes) used in the definition part of the archetype must be defined in the constraint_definitions part of the ontology.</p>
</div>
<div class="paragraph rule">
<p><strong>VACDF</strong>: node identifier validity. Each constraint code used in the archetype definition part must be defined in the constraint_definitions part of the ontology.</p>
</div>
</div>
<div class="sect3">
<h4 id="_definition_section_2"><a class="anchor" href="#_definition_section_2"></a>8.8.3. Definition Section</h4>
<div class="paragraph">
<p>The following constraints apply to the definition section of the archetype.</p>
</div>
<div class="paragraph rule">
<p><strong>VDFAI</strong>: archetype identifier validity in definition. Any archetype identifier mentioned in an archetype slot in the definition section must conform to the published openEHR specification for archetype identifiers.</p>
</div>
<div class="paragraph rule">
<p><strong>VDFPT</strong>: path validity in definition. Any path mentioned in the definition section must be valid syntactically, and a valid path with respect to the hierarchical structure of the definition section.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_syntax_specification_5"><a class="anchor" href="#_syntax_specification_5"></a>8.9. Syntax Specification</h3>
<div class="paragraph">
<p>The following syntax and lexical specification are used to process an entire ADL file. Their main job is reading the header items, and then cutting it up into dADL, cADL and assertion sections.</p>
</div>
<div class="paragraph">
<p>The ADL grammar is implemented and tested using lex (.l file) and yacc (.y file) specifications for in the Eiffel programming environment. The 1.4 release of these files is available in the <a href="https://github.com/openEHR/adl-tools/tree/Release-1.4/components/adl_parser/src/syntax/adl/parser" target="_blank" rel="noopener">ADL grammar files</a>. The .l and .y files can be converted for use in another yacc/lex-based programming environment.</p>
</div>
<div class="sect3">
<h4 id="_grammar_5"><a class="anchor" href="#_grammar_5"></a>8.9.1. Grammar</h4>
<div class="paragraph">
<p>This section describes the ADL grammar.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">archetype</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">arch_identification</span>
<span class="tok-w">    </span><span class="tok-nv">arch_specialisation</span>
<span class="tok-w">    </span><span class="tok-nv">arch_concept</span>
<span class="tok-w">    </span><span class="tok-nv">arch_language</span>
<span class="tok-w">    </span><span class="tok-nv">arch_description</span>
<span class="tok-w">    </span><span class="tok-nv">arch_definition</span>
<span class="tok-w">    </span><span class="tok-nv">arch_invariant</span>
<span class="tok-w">    </span><span class="tok-nv">arch_ontology</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_identification</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">arch_head</span><span class="tok-w"> </span><span class="tok-no">V_ARCHETYPE_ID</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_head</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_ARCHETYPE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">arch_meta_data</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_meta_data</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arch_meta_data_items</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_meta_data_items</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-nv">arch_meta_data_item</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arch_meta_data_items</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">arch_meta_data_item</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_meta_data_item</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_ADL_VERSION</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">V_VERSION_STRING</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_IS_CONTROLLED</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_specialisation</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// empty OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_SPECIALIZE</span><span class="tok-w"> </span><span class="tok-no">V_ARCHETYPE_ID</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_concept</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_CONCEPT</span><span class="tok-w"> </span><span class="tok-no">V_LOCAL_TERM_CODE_REF</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_CONCEPT</span><span class="tok-w"> </span><span class="tok-nv">error</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_language</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// empty OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LANGUAGE</span><span class="tok-w"> </span><span class="tok-no">V_DADL_TEXT</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_description</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// empty OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_DESCRIPTION</span><span class="tok-w"> </span><span class="tok-no">V_DADL_TEXT</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_definition</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_DEFINITION</span><span class="tok-w"> </span><span class="tok-no">V_CADL_TEXT</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arch_invariant</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-c">// empty OK</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_INVARIANT</span><span class="tok-w"> </span><span class="tok-no">V_ASSERTION_TEXT</span>

<span class="tok-nv">arch_ontology</span><span class="tok-p">:</span>
<span class="tok-w">    </span><span class="tok-no">SYM_ONTOLOGY</span><span class="tok-w"> </span><span class="tok-no">V_DADL_TEXT</span>
<span class="tok-w">    </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_symbols_4"><a class="anchor" href="#_symbols_4"></a>8.9.2. Symbols</h4>
<div class="paragraph">
<p>The following shows the ADL lexical specification.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>----------/* symbols */ -------------------------------------------------
"-"     Minus_code
"+"     Plus_code
"*"     Star_code
"/"     Slash_code
"^"     Caret_code
"="     Equal_code
"."     Dot_code
";"     Semicolon_code
","     Comma_code
":"     Colon_code
"!"     Exclamation_code
"("     Left_parenthesis_code
")"     Right_parenthesis_code
"$"     Dollar_code
"?"     Question_mark_code
"["     Left_bracket_code
"]"     Right_bracket_code

----------/* keywords */ -------------------------------------------------
^[Aa][Rr][Cc][Hh][Ee][Tt][Yy][Pp][Ee][ \t\r]*\n         SYM_ARCHETYPE
^[Ss][Pp][Ee][Cc][Ii][Aa][Ll][Ii][SsZz][Ee][ \t\r]*\n   SYM_SPECIALIZE
^[Cc][Oo][Nn][Cc][Ee][Pp][Tt][ \t\r]*\n                 SYM_CONCEPT
^[Dd][Ee][Ff][Ii][Nn][Ii][Tt][Ii][Oo][Nn][ \t\r]*\n     SYM_DEFINITION

-- mini-parser to match V_DADL_TEXT
^[Ll][Aa][Nn][Gg][Uu][Aa][Gg][Ee][ \t\r]*\n             SYM_LANGUAGE

-- mini-parser to match V_DADL_TEXT
^[Dd][Ee][Ss][Cc][Rr][Ii][Pp][Tt][Ii][Oo][Nn][ \t\r]*\n SYM_DESCRIPTION

-- mini-parser to match V_CADL_TEXT
^[Ii][Nn][Vv][Aa][Rr][Ii][Aa][Nn][Tt][ \t\r]*\n         SYM_INVARIANT

-- mini-parser to match V_ASSERTION_TEXT
^[Oo][Nn][Tt][Oo][Ll][Oo][Gg][Yy][ \t\r]*\n SYM_ONTOLOGY

-- mini-parser to match V_DADL_TEXT
----------/* V_DADL_TEXT */ -------------------------------------
&lt;IN_DADL_SECTION&gt;{
    -- the following 2 patterns are a hack, until ADL2 comes into being;
    -- until then, dADL blocks in an archetype finish when they
    -- hit EOF, or else the 'description' or 'definition' keywords.
    -- It's not nice, but it's simple ;-)
    -- For both these patterns, the lexer has to unread what it
    -- has just matched, store the dADL text so far, then get out
    -- of the IN_DADL_SECTION state
    ^[Dd][Ee][Ff][Ii][Nn][Ii][Tt][Ii][Oo][Nn][ \t\r]*\n
    ^[Dd][Ee][Sc][Rr][Ii][Pp][Tt][Ii][Oo][Nn][ \t\r]*\n
    [^\n]+\n            -- any text on line with a LF
    [^\n]+              -- any text on line with no LF
    &lt;&lt;EOF&gt;&gt;             -- (escape condition)
    (.|\n)              -- ignore unmatched chars
}

----------/* V_CADL_TEXT */ -------------------------------------
&lt;IN_CADL_SECTION&gt;{
    ^[ \t]+[^\n]*\n -- non-blank lines
    \n+ -- blank lines
    ^[^ \t] -- non-white space at start (escape condition)
}

----------/* V_ASSERTION_TEXT */ -------------------------------------
&lt;IN_ASSERTION_SECTION&gt;{
    ^[ \t]+[^\n]*\n -- non-blank lines
    ^[^ \t] -- non-white space at start (escape condition)
}

----------/* V_VERSION_STRING */ -------------------------------------
[0-9]+\.[0-9]+(\.[0-9]+)*

----------/* V_LOCAL_TERM_CODE_REF */ --------------------------------------
\[[a-zA-Z0-9][a-zA-Z0-9.-]*\]

----------/* V_ARCHETYPE_ID */ ---------------------------------------------
[a-zA-Z][a-zA-Z0-9_]+(-[a-zA-Z][a-zA-Z0-9_]+){2}\.[a-zA-Z][a-zA-Z0-9_]+(-[azA-Z][a-zA-Z0-9_]+)*\.v[1-9][0-9]*

----------/* V_IDENTIFIER */ ----------------------------------------------
[a-zA-Z][a-zA-Z0-9_]*</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customising_adl"><a class="anchor" href="#_customising_adl"></a>9. Customising ADL</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_introduction_2"><a class="anchor" href="#_introduction_2"></a>9.1. Introduction</h3>
<div class="paragraph">
<p>Standard ADL has a completely regular way of representing constraints. Type names and attribute names from a reference model are mentioned in an alternating, hierarchical structure that is isomorphic to the aggregation structure of the corresponding classes in the reference model. Constraints at the leaf nodes are represented in a syntactic way that avoids committing to particular modelling details. The overall result enables constraints on most reference model types to be expressed. This section describes how to handle exceptions from the standard semantics. openEHR uses a small number of such exceptions, which are documented in the <a href="https://specifications.openehr.org/releases/1.0.2/architecture/am/openehr_archetype_profile.pdf">openEHR Archetype Profile (oAP) specification</a>.</p>
</div>
<div class="paragraph">
<p>A situation in which standard ADL falls short is when the required semantics of constraint are different from those available naturally from the standard approach. Consider a reference model type <code>QTY</code>, shown in the following figure, which could be used to represent a person’s age in an archetype.</p>
</div>
<div id="qty_class" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/qty_class.png" alt="qty class" width="20%">
</div>
<div class="title">Figure 6. QTY class</div>
</div>
<div class="paragraph">
<p>A typical ADL constraint to enable <code>QTY</code> to be used to represent age in clinical data can be expressed in natural language as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>    property matches "time"
    units matches "years" or "months"
    if units is "years" then magnitude matches 0..200 (for adults)
    if units is "months" then magnitude matches 3..36 (for infants)</pre>
</div>
</div>
<div class="paragraph">
<p>The standard ADL expression for this requires the use of multiple alternatives, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">age</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">QTY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;time&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;yr&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mf">0.0</span><span class="tok-p">..</span><span class="tok-mf">200.0</span><span class="tok-p">|}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">QTY</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">property</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;time&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">units</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;mth&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">magnitude</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{|</span><span class="tok-mf">3.0</span><span class="tok-p">..</span><span class="tok-mf">12.0</span><span class="tok-p">|}</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>While this is a perfectly legal approach, it is not the most natural expression of the required constraint, since it repeats the constraint of property matching "time". It also makes processing by software slightly more difficult than necessary.</p>
</div>
<div class="paragraph">
<p>A more convenient possibility is to introduce a new class into the archetype model, representing the concept "constraint on QTY", which we will call <code>C_QTY</code>. Such a class fits into the class model of archetypes (see the openEHR AOM) by inheriting from the class <code>C_DOMAIN_TYPE</code>. A <code>C_QTY</code> class is illustrated below, and corresponds to the way constraints on <code>QTY</code> objects are often expressed in user applications, which is to say, a property constraint, and a separate list of units/magnitude pairs.</p>
</div>
<div id="c_qty_class" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/c_qty_class.png" alt="c qty class" width="50%">
</div>
<div class="title">Figure 7. C_QTY class</div>
</div>
<div class="paragraph">
<p>The question now is how to express a constraint corresponding to this class in an ADL archetype. The solution is logical, and uses standard ADL. Consider that a particular constraint on a <code>QTY</code> must be an instance of the <code>C_QTY</code> type. An instance of any class can be expressed in ADL using the dADL syntax (ADL’s object serialisation syntax) at the appropriate point in the archetype, as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="dadl"><span></span>value matches {
    C_QTY &lt;
        property = &lt;&quot;time&quot;&gt;
        list = &lt;
            [&quot;1&quot;] = &lt;
                units = &lt;&quot;yr&quot;&gt;
                magnitude = &lt;|0.0..200.0|&gt;
                &gt;
            [&quot;2&quot;] = &lt;
                units = &lt;&quot;mth&quot;&gt;
                magnitude = &lt;|1.0..36.0|&gt;
            &gt;
        &gt;
    &gt;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This approach can be used for any custom type which represents a constraint on a reference model type. Since the syntax is generic, only one change is needed to an ADL parser to support dADL sections within the cADL (definition) part of an archetype. The syntax rules are as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>the dADL section occurs inside the <code>{}</code> block where its standard ADL equivalent would have occurred (i.e. no other delimiters or special marks are needed);</p>
</li>
<li>
<p>the dADL section must be ‘typed’, i.e. it must start with a type name, which should correspond directly to a reference model type;</p>
</li>
<li>
<p>the dADL instance must obey the semantics of the custom type of which it is an instance, i.e. include the correct attribute names and relationships.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>It should be understood of course, that just because a custom constraint type has been defined, it does not need to be used to express constraints on the reference model type it targets. Indeed, any mixture of standard ADL and dADL-expressed custom constraints may be used within the one archetype.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
that the classes in the above example are a simplified form of classes found in the openEHR reference model, designed purely for the purpose of the example.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="_custom_syntax"><a class="anchor" href="#_custom_syntax"></a>9.1.1. Custom Syntax</h4>
<div class="paragraph">
<p>A dADL section is not the only possibility for expressing a custom constraint type. A useful alternative is a custom addition to the ADL syntax. Custom syntax can be smaller, more intuitive to read, and easier to parse than embedded dADL sections. A typical example of the use of custom syntax is to express constraints on the type <code>CODE_PHRASE</code> in the openEHR reference model (rm.data_types package). This type models the notion of a ‘coded term’, which is ubiquitous in clinical computing. The standard ADL for a constraint on the <code><em>defining_code</em></code> attribute of a class <code>CODE_PHRASE</code> is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">terminology_id</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;local&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">code_string</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;at0039&quot;</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- lying</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-w">    </span><span class="tok-nc">CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">        </span><span class="tok-nc">terminology_id</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;local&quot;</span><span class="tok-p">}</span>
<span class="tok-w">        </span><span class="tok-nc">code_string</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span><span class="tok-s">&quot;at0040&quot;</span><span class="tok-p">}</span><span class="tok-w"> </span><span class="tok-c">-- sitting</span>
<span class="tok-w">    </span><span class="tok-p">}</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>However, as with <code>QUANTITY</code>, the most typical constraint required on a <code>CODE_PHRASE</code> is factored differently from the standard ADL - the need is almost always to specify the terminology, and then a set of <code><em>code_strings</em></code>. A type <code>C_CODE_PHRASE</code> type can be defined as shown in the figure below.</p>
</div>
<div id="c_code_phrase_class" class="imageblock text-center text-center">
<div class="content">
<img src="ADL1.4/diagrams/c_code_phrase_class.png" alt="c code phrase class" width="50%">
</div>
<div class="title">Figure 8. C_CODE_PHRASE class</div>
</div>
<div class="paragraph">
<p>Using the dADL section method, including a C_CODE_PHRASE constraint would require the following section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-nc">C_CODE_PHRASE</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">        </span><span class="tok-nc">terminology_id</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">            </span><span class="tok-nc">value</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-s">&quot;local&quot;</span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-nc">code_list</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-err">&quot;</span>1<span class="tok-err">&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-s">&quot;at0039&quot;</span><span class="tok-o">&gt;</span>
<span class="tok-w">            </span><span class="tok-p">[</span><span class="tok-err">&quot;</span>2<span class="tok-err">&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-o">&lt;</span><span class="tok-s">&quot;at0040&quot;</span><span class="tok-o">&gt;</span>
<span class="tok-w">        </span><span class="tok-o">&gt;</span>
<span class="tok-w">    </span><span class="tok-o">&gt;</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Although this is perfectly legal, a more compact and readable rendition of this same constraint is provided by a custom syntax addition to ADL, which enables the above example to be written as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="cadl"><span></span><span class="tok-nc">defining_code</span><span class="tok-w"> </span><span class="tok-o">matches </span><span class="tok-p">{</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-nd">local</span><span class="tok-p">::</span>
<span class="tok-w">    </span><span class="tok-nd">at0039</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-nd">at0040</span><span class="tok-p">]</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The above syntax should be understood as an extension to the ADL grammar, and an archetype tool supporting the extension needs to have a modified parser. While these two ADL fragments express exactly the same constraint, the second is shorter and clearer.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_relationship_of_adl_to_other_formalisms"><a class="anchor" href="#_relationship_of_adl_to_other_formalisms"></a>Appendix A: Relationship of ADL to Other Formalisms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview_7"><a class="anchor" href="#_overview_7"></a>A.1. Overview</h3>
<div class="paragraph">
<p>Whenever a new formalism is defined, it is reasonable to ask the question: are there not existing formalisms which would do the same job? Research to date has shown that in fact, no other formalism has been designed for the same use, and none easily express ADL&#8217;s semantics. During ADL&#8217;s initial development, it was felt that there was great value in analysing the problem space very carefully, and constructing an abstract syntax exactly matched to the solution, rather than attempting to use some other formalism - undoubtedly designed for a different purpose - to try and express the semantics of archetypes, or worse, to start with an XML-based exchange format, which often leads to the conflation of abstract and concrete representational semantics. Instead, the approach used has paid off, in that the resulting syntax is very simple and powerful, and in fact has allowed mappings to other formalisms to be more correctly defined and understood. The following sections compare ADL to other formalisms and show how it is different.</p>
</div>
</div>
<div class="sect2">
<h3 id="_constraint_syntaxes"><a class="anchor" href="#_constraint_syntaxes"></a>A.2. Constraint Syntaxes</h3>
<div class="sect3">
<h4 id="_omg_ocl_object_constraint_language"><a class="anchor" href="#_omg_ocl_object_constraint_language"></a>A.2.1. OMG OCL (Object Constraint Language)</h4>
<div class="paragraph">
<p>The OMG&#8217;s <a href="https://www.omg.org/spec/OCL/" target="_blank" rel="noopener">Object Constraint Language (OCL)</a> appears at first glance to be an obvious contender for writing archetypes. However, its designed use is to write constraints on object models, rather than on data, which is what archetypes are about. As a concrete example, OCL can be used to make statements about the actors attribute of a class Company - e.g. that actors must exist and contain the Actor who is the lead of Company. However, if used in the normal way to write constraints on a class model, it cannot describe the notion that for a particular kind of (acting) company, such as 'itinerant jugglers', there must be at least four actors, each of whom have among their capabilities 'advanced juggling', plus an Actor who has skill 'musician'. This is because doing so would constrain all instances of the class Company to conform to the specific configuration of instances corresponding to actors and jugglers, when what is intended is to allow a myriad of possibilities. ADL provides the ability to create numerous archetypes, each describing in detail a concrete configuration of instances of type Company.  OCL&#8217;s constraint types include function pre- and post-conditions, and class invariants. There is no structural character to the syntax - all statements are essentially first-order predicate logic statements about elements in models expressed in UML, and are related to parts of a model by 'context' statements.  This makes it impossible to use OCL to express an archetype in a structural way which is natural to domain experts. OCL also has some flaws, described in <span class="citation">(<a href="#Beale2003">Beale&#44; 2003</a>)</span>.  However, OCL is in fact relevant to ADL. ADL archetypes include invariants (and one day, might include pre- and post-conditions). Currently these are expressed in a syntax very similar to OCL, with minor differences. The exact definition of the ADL invariant syntax in the future will depend somewhat on the progress of OCL through the OMG standards process.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_ontology_formalisms"><a class="anchor" href="#_ontology_formalisms"></a>A.3. Ontology Formalisms</h3>
<div class="sect3">
<h4 id="_owl_web_ontology_language"><a class="anchor" href="#_owl_web_ontology_language"></a>A.3.1. OWL (Web Ontology Language)</h4>
<div class="paragraph">
<p>The <a href="https://www.w3.org/TR/2003/CR-owl-ref-20030818/" target="_blank" rel="noopener">W3C Web Ontology Language (OWL)</a> is a W3C initiative for defining Web-enabled ontologies which aim to allow the building of the "Semantic Web". OWL has an abstract syntax, developed at the University of Manchester, UK, and an exchange syntax, which is an extension of the XML-based syntax known as RDF (Resource Description Framework). We discuss OWL only in terms of its abstract syntax, since this is a semantic representation of the language unencumbered by XML or RDF details (there are tools which convert between abstract OWL and various exchange syntaxes).</p>
</div>
<div class="paragraph">
<p>OWL is a general purpose description logic (DL), and is primarily used to describe 'classes' of things in such a way as to support subsumptive inferencing within the ontology, and by extension, on data which are instances of ontology classes. There is no general assumption that the data itself were built based on any particular class model - they might be audio-visual objects in an archive, technical documentation for an aircraft or the Web pages of a company. OWL&#8217;s class definitions are therefore usually constraint statements on an <em>implied</em> model on which data <em>appear</em> to be based. However, the semantics of an information model can themselves be represented in OWL. Restrictions are the primary way of defining subclasses.</p>
</div>
<div class="paragraph">
<p>In intention, OWL is aimed at representing some 'reality' and then making inferences about it; for example in a medical ontology, it can infer that a particular patient is at risk of ischemic heart disease due to smoking and high cholesterol, if the knowledge that 'ischemic heart disease has-risk-factor smoking' and 'ischemic heart disease has-risk-factor high cholesterol' are in the ontology, along with a representation of the patient details themselves. OWL&#8217;s inferencing works by subsumption, which is to say, asserting either that an 'individual' (OWL&#8217;s equivalent of an object-oriented instance or a type) conforms to a 'class', or that a particular 'class' 'is-a' (subtype of another) 'class'; this approach can also be understood as category-based reasoning or set-containment.</p>
</div>
<div class="paragraph">
<p>ADL can also be thought of as being aimed at describing a 'reality', and allowing inferences to be made. However, the reality it describes is in terms of constraints on information structures (based on an underlying information model), and the inferencing is between data and the constraints. Some of the differences between ADL and OWL are as follows.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>ADL syntax is predicated on the existence of existing object-oriented reference models, expressed in UML or some similar formalism, and the constraints in an ADL archetype are in relation to types and attributes from such a model. In contrast, OWL is far more general, and requires the explicit expression of a reference model in OWL, before archetype-like constraints can be expressed.</p>
</li>
<li>
<p>Because information structures are in general hierarchical compositions of nodes and elements, and may be quite deep, ADL enables constraints to be expressed in a structural, nested way, mimicking the tree-like nature of the data it constrains. OWL does not provide a native way to do this, and although it is possible to express approximately the same constraints in OWL, it is fairly inconvenient, and would probably only be made easy by machine conversion from a visual format more or less like ADL.</p>
</li>
<li>
<p>As a natural consequence of dealing with heavily nested structures in a natural way, ADL also provides a path syntax, based on <a href="https://www.w3.org/TR/xpath-31/">W3C Xpath</a>, enabling any node in an archetype to be referenced by a path or path pattern. OWL does not provide an inbuilt path mechanism; Xpath can presumably be used with the RDF representation, although it is not yet clear how meaningful the paths would be with respect to the named categories within an OWL ontology.</p>
</li>
<li>
<p>ADL also natively takes care of disengaging natural language and terminology issues from constraint statements by having a separate ontology per archetype, which contains 'bindings' and language-specific translations. OWL has no inbuilt syntax for this, requiring such semantics to be represented from first principles.</p>
</li>
<li>
<p>ADL provides a rich set of constraints on primitive types, including dates and times. OWL 1.0 (c 2005) did not provide any equivalents; OWL 1.1 (c 2007) look as though it provides some.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Research to date shows that the semantics of an archetype are likely to be representable inside OWL, assuming expected changes to improve its primitive constraint types occur. To do so would require the following steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>express the relevant reference models in OWL (this has been shown to be possible);</p>
</li>
<li>
<p>express the relevant terminologies in OWL (research on this is ongoing);</p>
</li>
<li>
<p>be able to represent concepts (i.e. constraints) independently of natural language (status unknown);</p>
</li>
<li>
<p>convert the cADL part of an archetype to OWL; assuming the problem of primitive type constraints is solved, research to date shows that this should in principle be possible.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use the archetype on data, the data themselves would have to be converted to OWL, i.e. be expressed as 'individuals'. In conclusion, we can say that mathematical equivalence between OWL and ADL is probably provable. However, it is clear that OWL is far from a convenient formalism to express archetypes, or to use them for modelling or reasoning against data. The ADL approach makes use of existing UML semantics and existing terminologies, and adds a convenient syntax for expressing the required constraints. It also appears fairly clear that even if all of the above conversions were achieved, using OWL-expressed archetypes to validate data (which would require massive amounts of data to be converted to OWL statements) is unlikely to be anywhere near as efficient as doing it with archetypes expressed in ADL or one of its concrete expressions.</p>
</div>
<div class="paragraph">
<p>Nevertheless, OWL provides a very powerful generic reasoning framework, and offers a great deal of inferencing power of far wider scope than the specific kind of 'reasoning' provided by archetypes. It appears that it could be useful for the following archetype-related purposes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>providing access to ontological resources while authoring archetypes, including terminologies, pure domain-specific ontologies, etc;</p>
</li>
<li>
<p>providing a semantic 'indexing' mechanism allowing archetype authors to find archetypes relating to specific subjects (which might not be mentioned literally within the archetypes);</p>
</li>
<li>
<p>providing inferencing on archetypes in order to determine if a given archetype is subsumed within another archetype which it does not specialise (in the ADL sense);</p>
</li>
<li>
<p>providing access to archetypes from within a semantic Web environment, such as an ebXML server or similar.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_kif_knowledge_interchange_format"><a class="anchor" href="#_kif_knowledge_interchange_format"></a>A.3.2. KIF (Knowledge Interchange Format)</h4>
<div class="paragraph">
<p>The Knowledge Interchange Format (KIF) is a knowledge representation language whose goal is to be able to describe formal semantics which would be sharable among software entities, such as information systems in an airline and a travel agency. An example of KIF (taken from <span class="citation">(<a href="#Genesereth_Fikes_Gruber1992">Genesereth&#44; Fikes&#44; &amp; Gruber&#44; 1992</a>)</span>) used to describe the simple concept of 'units' in a class is as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="lisp"><span></span><span class="tok-p">(</span><span class="tok-nv">defrelation</span><span class="tok-w"> </span><span class="tok-nv">BASIC-UNIT</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">BASIC-UNIT</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-c1">; basic units are distinguished units of measure</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)))</span>

<span class="tok-p">(</span><span class="tok-nv">deffunction</span><span class="tok-w"> </span><span class="tok-nv">UNIT*</span>
<span class="tok-w">        </span><span class="tok-c1">; Unit* maps all pairs of units to units</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">defined</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">))))</span>

<span class="tok-w">        </span><span class="tok-c1">; It is commutative</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-p">))</span>

<span class="tok-w">        </span><span class="tok-c1">; It is associative</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?u3</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?u3</span><span class="tok-p">))</span>
<span class="tok-p">)</span>

<span class="tok-p">(</span><span class="tok-nv">deffunction</span><span class="tok-w"> </span><span class="tok-nv">UNIT^</span>
<span class="tok-w">        </span><span class="tok-c1">; Unit^ maps all units and reals to units</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">=&gt;</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nv">real-number</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))</span>
<span class="tok-w">        </span><span class="tok-p">(</span><span class="tok-nb">and</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">defined</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit-of-measure</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">))))</span>

<span class="tok-w">        </span><span class="tok-c1">; It has the algebraic properties of exponentiation</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-mi">1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r1</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-nv">?r2</span><span class="tok-p">))</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nb">+</span><span class="tok-w"> </span><span class="tok-nv">?r1</span><span class="tok-w"> </span><span class="tok-nv">?r2</span><span class="tok-p">)))</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nb">=</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)</span>
<span class="tok-w">    </span><span class="tok-p">(</span><span class="tok-nv">unit*</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u1</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-p">(</span><span class="tok-nv">UNIT^</span><span class="tok-w"> </span><span class="tok-nv">?u2</span><span class="tok-w"> </span><span class="tok-nv">?r</span><span class="tok-p">)))</span>
<span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It should be clear from the above that KIF is a definitional language - it defines all the concepts it mentions. However, the most common situation in which we find ourselves is that information models already exist, and may even have been deployed as software. Thus, to use KIF for expressing archetypes, the existing information model and relevant terminologies would have to be converted to KIF statements, before archetypes themselves could be expressed. This is essentially the same process as for expressing archetypes in OWL.</p>
</div>
<div class="paragraph">
<p>It should also be realised that KIF is intended as a knowledge exchange format, rather than a knowledge representation format, which is to say that it can (in theory) represent the semantics of any other knowledge representation language, such as OWL. This distinction today seems fine, since Web-enabled languages like OWL probably don&#8217;t need an exchange format other than their XML equivalents to be shared. The relationship and relative strengths and deficiencies is explored by e.g. <span class="citation"><a href="#Martin2003">Martin (2003)</a></span>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_xml_based_formalisms"><a class="anchor" href="#_xml_based_formalisms"></a>A.4. XML-based Formalisms</h3>
<div class="sect3">
<h4 id="_xml_schema"><a class="anchor" href="#_xml_schema"></a>A.4.1. XML-schema</h4>
<div class="paragraph">
<p>Previously, archetypes have been expressed as XML instance documents conforming to W3C XML schemas, for example in the Good Electronic Health Record project (see <span class="citation">(<a href="#GeHR_AUS">Beale &amp; Heard&#44; 2000</a>)</span>). The schemas used in those projects correspond technically to the XML expressions of information model-dependent object models shown in The Archetypes: Technical Overview specification. XML archetypes are accordingly equivalent to serialised instances of the parse tree, i.e. particular ADL archetypes serialised from objects into XML instance.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extended_meta_data_guide"><a class="anchor" href="#_extended_meta_data_guide"></a>Appendix B: Extended Meta-data Guide</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section documents the use of the <code>description/other_details</code> meta-data subsection of an ADL 1.4 archetype. The meta-data items described here correspond to requirements discovered since the publication of the ADL and AOM 1.4 standards, and are designed to enable forward compatibility with ADL/AOM 2.</p>
</div>
<div class="paragraph">
<p>They are divided into two groups. The first set consists of standardised items whose naming and rules should be followed, and which are intended to be implemented by any ADL 1.4 &#8658; ADL 2 conversion tool. The second set consists of items that have been used publicly by at least one organisation and should be considered either candidates for standardisation, or else as item names reserved from other use (i.e. to avoid future clashes).</p>
</div>
<div class="paragraph">
<p>Note that since the syntax structure of the <code>other_details</code> subsection is a <code>Hash &lt;String, String&gt;</code>, all values are just strings. However, some internal syntax rules are imposed or suggested to enable smart parsing to generate more complex structures. An example is the use of the typical string for a person or organisation of the form "name &lt;URN&gt;", which enables email addresses, website URLs etc to be easily extracted.</p>
</div>
<div class="sect2">
<h3 id="_standardised_items"><a class="anchor" href="#_standardised_items"></a>B.1. Standardised Items</h3>
<div class="paragraph">
<p>The standard items are defined as follows:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 44.4444%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">String syntax</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">revision</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://specifications.openehr.org/releases/AM/latest/Identification.html#_version_numbering">extended version string</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Full version identifier to compensate for only major version numbering in ADL 1.4 identifiers.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">build_uid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Guid string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Changed every save. See AOM2 spec, <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_machine_identifiers">Machine Identifiers section</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">original_namespace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reverse domain name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See AOM2 spec, <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_governance_meta_data">Governance Meta-data section</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">original_publisher</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org name with optional trailing <code>&lt;&gt;</code> section containing a domain name or email address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See AOM2 spec, <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_governance_meta_data">Governance Meta-data section</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">custodian_organisation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org name with optional trailing <code>&lt;&gt;</code> section containing a domain name or email address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See AOM2 spec, <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_governance_meta_data">Governance Meta-data section</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">custodian_namespace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reverse domain name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See AOM2 spec, <a href="https://specifications.openehr.org/releases/AM/latest/AOM2.html#_governance_meta_data">Governance Meta-data section</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">licence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">free string with optional trailing <code>&lt;&gt;</code> section containing a URL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Licence under which this archetype is shared.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">references</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string with one LF (<code>\n</code>) terminated line for each reference. If a URL is supplied, in a reference it is <em>not</em> <code>&lt;&gt;</code> delimited. Intervening LFs and leading and trailing whitespace may be added for clarity, to be stripped on conversion to ADL2.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Online or publication references relevant to the archetype.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip_acknowledgements</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">string with one LF (<code>\n</code>) terminated line for each reference. URLs may be interpolated in <code>&lt;&gt;</code> delimited or non-delimited form. Intervening LFs and leading and trailing whitespace may be added for clarity, to be stripped on conversion to ADL2.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Copyright and trademark notices.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following provides an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;licence&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;This work is licensed under the Creative Commons Attribution-ShareAlike 3.0 License. To view a copy of this license, visit http://creativecommons.org/licenses/by-sa/3.0/.&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;original_namespace&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;au.gov.nehta&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;original_publisher&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;NEHTA CTI Team, National E-Health Transition Authority &lt;clinicalinfo@nehta.gov.au&gt;&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;custodian_organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;openEHR Foundation &lt;http://www.openEHR.org&gt;&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;custodian_namespace&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;org.openehr&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;build_uid&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;3076af96-e1dd-4f9b-abf2-23913fcf52b1&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;revision&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;0.0.1-alpha&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;references&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;</span>
<span class="tok-s">        O&#39;Brien E, Asmar R, Beilin L, et al. European Society of Hypertension recommendations for conventional, ambulatory and home blood pressure measurement. Journal of Hypertension. 2003; 21(5):821-848. Available from: http://www.ncbi.nlm.nih.gov/pubmed/12714851</span>
<span class="tok-s">        Perloff D, Grim C, Flack J, Frohlich ED, Hill M, McDonald M, Morgenstern BZ. Human blood pressure determination by sphygmomanometry. Circulation. 1993; 88(5):2460. Available from: http://circ.ahajournals.org/cgi/reprint/88/5/2460</span>
<span class="tok-s">    &quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;ip_acknowledgements&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;</span>
<span class="tok-s">        Content from LOINC® is copyright © 1995 Regenstrief Institute, Inc. and the LOINC Committee, and available at no cost under the license at http://loinc.org/terms-of-use.</span>
<span class="tok-s">        Content from SNOMED CT® is copyright © 2007 IHTSDO &lt;ihtsdo.org&gt;.</span>
<span class="tok-s">    &quot;</span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_other_items"><a class="anchor" href="#_other_items"></a>B.2. Other Items</h3>
<div class="paragraph">
<p>The 'other' category is documented below.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 22.2222%;">
<col style="width: 44.4444%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Item</th>
<th class="tableblock halign-left valign-top">String syntax</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5-CAM-1.0.1</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MD5 32-bit hex number string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Used by CKM and openEHR template tools.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">current_contact</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">person name with optional trailing <code>&lt;&gt;</code> section containing email address</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CKM does nothing with this, except display.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">review_date</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ISO 8601 compliant date string</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicate the next time the archetype should be reviewed. Used by CKM in display only.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">responsible_organisation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">org name with optional trailing <code>&lt;&gt;</code> section containing a domain name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of the responsible organisation may be different to the custodian organisation. Used by CKM in display only.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The following provides an example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="odin"><span></span><span class="tok-nc">other_details</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;review_date&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;2014-06-10&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;current_contact&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Ian McNicoll, freshEHR Clinical Informatics Ltd &lt;ian.mcnicoll@freshehr.com&gt;&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;responsible_organisation&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;Nehta&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-w">    </span><span class="tok-p">[</span><span class="tok-s">&quot;MD5-CAM-1.0.1&quot;</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-o">=</span><span class="tok-w"> </span><span class="tok-p">&lt;</span><span class="tok-s">&quot;C5016B71B55DBDCBCAA8531CC1A982E3&quot;</span><span class="tok-p">&gt;</span>
<span class="tok-p">&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_syntax_specification_6"><a class="anchor" href="#_syntax_specification_6"></a>Appendix C: Syntax Specification</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The normative specification of the ADL1.4 syntax is expressed in Antlr4 as a series of component grammars, shown below. This has been tested with the Antlr 4.9 implementation available from <a href="http://www.antlr.org" target="_blank" rel="noopener">Antlr.org</a>. The source files are available in two locations on Github - <a href="https://github.com/openEHR/adl-antlr/tree/master/src/main/antlr/adl" target="_blank" rel="noopener">adl-antlr repository</a>. The ODIN grammar used in parts of an ADL archetype is not shown below, it can be found in the <a href="https://specifications.openehr.org/releases/LANG/latest/odin.html" target="_blank" rel="noopener">openEHR ODIN specification</a>.</p>
</div>
<div class="sect2">
<h3 id="_adl_outer_syntax"><a class="anchor" href="#_adl_outer_syntax"></a>C.1. ADL Outer Syntax</h3>
<div class="paragraph">
<p>The following grammar expresses the outer syntax of ADL, i.e. the top-level structure of section keywords and initial identification lines in an ADL text.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">//  description: Antlr4 grammar for Archetype Definition Language (ADL2)</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2015- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//  license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">adl14</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl14</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ============== Parser rules ==============</span>
<span class="tok-c">//</span>

<span class="tok-err">adl14_archetype</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">archetype</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-no">EOF</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">archetype</span><span class="tok-p">:</span><span class="tok-w"> </span>
<span class="tok-w">    </span><span class="tok-no">SYM_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">meta_data</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-no">ARCHETYPE_HRID</span>
<span class="tok-w">    </span><span class="tok-nv">specialization_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">concept_section</span>
<span class="tok-w">    </span><span class="tok-nv">language_section</span>
<span class="tok-w">    </span><span class="tok-nv">description_section</span>
<span class="tok-w">    </span><span class="tok-nv">definition_section</span>
<span class="tok-w">    </span><span class="tok-nv">invariant_section</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-nv">ontology_section</span>
<span class="tok-w">    </span><span class="tok-p">;</span>


<span class="tok-nl">specialization_section</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_SPECIALIZE</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_REF</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">language_section</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_LANGUAGE</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">description_section</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_DESCRIPTION</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">definition_section</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_DEFINITION</span><span class="tok-w"> </span><span class="tok-nv">c_complex_object</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">invariant_section</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_INVARIANT</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">statement</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-o">)?)+</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">ontology_section</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_ONTOLOGY</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">concept_section</span><span class="tok-p">:</span>
<span class="tok-w"> </span><span class="tok-s1">&#39;concept&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-p">;</span>

<span class="tok-nl">meta_data</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_item</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_item</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">meta_data_tag_adl_version</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_uid</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_build_uid</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_rm_release</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_is_controlled</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">meta_data_tag_is_generated</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHANUM_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">meta_data_value</span><span class="tok-w"> </span><span class="tok-o">)?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_value</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">primitive_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">GUID</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">VERSION_ID</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">meta_data_tag_adl_version</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;adl_version&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_uid</span><span class="tok-w">           </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;uid&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_build_uid</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;build_uid&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_rm_release</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;rm_release&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_is_controlled</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;controlled&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">meta_data_tag_is_generated</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;generated&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>


<span class="tok-c">//</span>
<span class="tok-c">// ------------------ lexical patterns -----------------</span>
<span class="tok-c">//</span>

<span class="tok-nl">SYM_ARCHETYPE</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Hh</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">SYM_SPECIALIZE</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Ss</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">SsZz</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_LANGUAGE</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Gg</span><span class="tok-p">][</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Gg</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_DESCRIPTION</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_DEFINITION</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Ff</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_INVARIANT</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Vv</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_ONTOLOGY</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Gg</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_ANNOTATIONS</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;\n&#39;</span><span class="tok-p">[</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ---------------- meta-data keywords and symbols ---------------</span>
<span class="tok-nl">SYM_EQ</span><span class="tok-w">         </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">ALPHANUM_ID</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">a</span><span class="tok-o">-</span><span class="tok-n">zA</span><span class="tok-o">-</span><span class="tok-n">Z0</span><span class="tok-o">-</span><span class="tok-mi">9</span><span class="tok-p">][</span><span class="tok-n">a</span><span class="tok-o">-</span><span class="tok-n">zA</span><span class="tok-o">-</span><span class="tok-n">Z0</span><span class="tok-o">-</span><span class="tok-mi">9_</span><span class="tok-p">]</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cadl_syntax"><a class="anchor" href="#_cadl_syntax"></a>C.2. cADL Syntax</h3>
<div class="paragraph">
<p>The following grammar expresses the syntax of cADL composite types, i.e. the language of the <code>definition</code> section of an archetype.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// description: Antlr4 grammar for cADL non-primitves sub-syntax of Archetype Definition Language (ADL2)</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2015- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">// license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">cadl14</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl14_primitives</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">base_expressions</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Top-level Objects ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">c_complex_object</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">at_type_id</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">c_attribute</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">at_type_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-p">;</span>

<span class="tok-c">// ======================== Components =======================</span>

<span class="tok-nl">c_objects</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">c_non_primitive_object_ordered</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_primitive_object</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_non_primitive_object_ordered</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">c_non_primitive_object</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_non_primitive_object</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_complex_object</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">domain_specific_extension</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_archetype_root</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_complex_object_proxy</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">archetype_slot</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_ordinal</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">domain_specific_extension</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">odin_text</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-p">;</span>

<span class="tok-nl">c_ordinal</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">ordinal_term</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">ordinal_term</span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">assumed_ordinal_value</span><span class="tok-o">)?</span><span class="tok-p">;</span>

<span class="tok-nl">assumed_ordinal_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">REAL</span><span class="tok-p">;</span>

<span class="tok-nl">ordinal_term</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_terminology_code</span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_root</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_USE_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">ARCHETYPE_REF</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_attribute</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_complex_object_proxy</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_USE_NODE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">archetype_slot</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_archetype_slot_head</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_includes</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">c_excludes</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_archetype_slot_head</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_slot_head</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">c_archetype_slot_id</span><span class="tok-w"> </span><span class="tok-nv">c_occurrences</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_archetype_slot_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_ALLOW_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_attribute</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">rm_attribute_id</span><span class="tok-w"> </span><span class="tok-nv">c_existence</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">c_cardinality</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">c_objects</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_includes</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_INCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">c_excludes</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_EXCLUDE</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_existence</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTENCE</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">existence</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">existence</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_cardinality</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_CARDINALITY</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">cardinality</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">cardinality</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">multiplicity</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">multiplicity_mod</span><span class="tok-w"> </span><span class="tok-nv">multiplicity_mod</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span><span class="tok-w"> </span><span class="tok-c">// max of two</span>
<span class="tok-nl">ordering_mod</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_ORDERED</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_UNORDERED</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">unique_mod</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_UNIQUE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">multiplicity_mod</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">ordering_mod</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">unique_mod</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_occurrences</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_OCCURRENCES</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">multiplicity</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">multiplicity</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// ---------- Lexer patterns -----------------</span>
<span class="tok-c">//</span>

<span class="tok-c">// CADL keywords</span>
<span class="tok-nl">SYM_EXISTENCE</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Xx</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_OCCURRENCES</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_CARDINALITY</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_ORDERED</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_UNORDERED</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_UNIQUE</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Qq</span><span class="tok-p">][</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_USE_NODE</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">_</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_USE_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Ss</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">_</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Hh</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_ALLOW_ARCHETYPE</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Oo</span><span class="tok-p">][</span><span class="tok-n">Ww</span><span class="tok-p">][</span><span class="tok-n">_</span><span class="tok-p">][</span><span class="tok-n">Aa</span><span class="tok-p">][</span><span class="tok-n">Rr</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Hh</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Tt</span><span class="tok-p">][</span><span class="tok-n">Yy</span><span class="tok-p">][</span><span class="tok-n">Pp</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_INCLUDE</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Ii</span><span class="tok-p">][</span><span class="tok-n">Nn</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">SYM_EXCLUDE</span><span class="tok-w">     </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">Ee</span><span class="tok-p">][</span><span class="tok-n">Xx</span><span class="tok-p">][</span><span class="tok-n">Cc</span><span class="tok-p">][</span><span class="tok-n">Ll</span><span class="tok-p">][</span><span class="tok-n">Uu</span><span class="tok-p">][</span><span class="tok-n">Dd</span><span class="tok-p">][</span><span class="tok-n">Ee</span><span class="tok-p">]</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_cadl_primitives_syntax"><a class="anchor" href="#_cadl_primitives_syntax"></a>C.3. cADL Primitives Syntax</h3>
<div class="paragraph">
<p>The following grammar defines the syntax of cADL primitives, which are used by cADL composites and also by ADL rules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// description: Antlr4 grammar for cADL primitives sub-syntax of Archetype Definition Language (ADL2)</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2015- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">// license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">cadl14_primitives</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">odin_values;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Parser rules ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">c_primitive_object</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">c_integer</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_real</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_date_time</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_duration</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_string</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_terminology_code</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_boolean</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">c_integer</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_integer_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_integer_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_real</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_real_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_real_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_date_time</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">DATE_TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_date_time_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_date_time_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_date</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">DATE_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_date_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_date_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_time</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_time_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_time_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_duration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span>
<span class="tok-w">      </span><span class="tok-no">DURATION_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">))?</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_duration_value</span><span class="tok-o">?</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_duration_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_string</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">string_list_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">regex_constraint</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_string_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">regex_constraint</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SLASH_REGEX</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CARET_REGEX</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_string_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-p">;</span>


<span class="tok-nl">c_terminology_code</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">c_local_term_code</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">c_qualified_term_code</span><span class="tok-p">;</span>

<span class="tok-nl">c_local_term_code</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">AC_CODE</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//TERM_CODE_REF clashes a lot and is needed from within odin, unfortunately. Switching lexer modes might be better</span>
<span class="tok-nl">c_qualified_term_code</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">terminology_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;::&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-nv">terminology_code</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">terminology_code</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">terminology_code</span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">TERM_CODE_REF</span><span class="tok-p">;</span>
<span class="tok-nl">terminology_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">terminology_code</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">AT_CODE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">AC_CODE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">c_boolean</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">assumed_boolean_value</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">assumed_boolean_value</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Lexical rules ========================</span>
<span class="tok-c">//</span>


<span class="tok-c">// ---------- ISO8601-based date/time/duration constraint patterns</span>

<span class="tok-nl">DATE_CONSTRAINT_PATTERN</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">YEAR_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">MONTH_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-no">DAY_PATTERN</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">TIME_CONSTRAINT_PATTERN</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">HOUR_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-no">MINUTE_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-no">SECOND_PATTERN</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">DATE_TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">DATE_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-s1">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-no">TIME_CONSTRAINT_PATTERN</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">DURATION_CONSTRAINT_PATTERN</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;P&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">yY</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">mM</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">Ww</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">dD</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;T&#39;</span><span class="tok-w"> </span><span class="tok-p">[</span><span class="tok-n">hH</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">mM</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-p">[</span><span class="tok-n">sS</span><span class="tok-p">]</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-s1">&#39;/&#39;</span><span class="tok-o">)?</span><span class="tok-p">;</span>

<span class="tok-c">// date time pattern</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">YEAR_PATTERN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;yyy&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;y&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;YYY&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;Y&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">MONTH_PATTERN</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;mm&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;MM&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">DAY_PATTERN</span><span class="tok-w">    </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;dd&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;DD&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">HOUR_PATTERN</span><span class="tok-w">   </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;hh&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;HH&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">MINUTE_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;mm&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;MM&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SECOND_PATTERN</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;ss&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;SS&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;??&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;XX&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;xx&#39;</span><span class="tok-w">  </span><span class="tok-p">;</span>


<span class="tok-c">// ---------- Delimited Regex matcher ------------</span>
<span class="tok-c">// In ADL, a regexp can only exist between {}.</span>
<span class="tok-c">// allows for &#39;/&#39; or &#39;^&#39; delimiters</span>
<span class="tok-c">// logical form - REGEX: &#39;/&#39; ( &#39;\\/&#39; | ~&#39;/&#39; )+ &#39;/&#39; | &#39;^&#39; ( &#39;\\^&#39; | ~&#39;^&#39; )+ &#39;^&#39;;</span>
<span class="tok-c">// The following is used to ensure REGEXes don&#39;t get mixed up with paths, which use &#39;/&#39; chars</span>

<span class="tok-nl">SLASH_REGEX</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-no">SLASH_REGEX_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-p">;</span>
<span class="tok-k">fragment</span><span class="tok-w"> </span><span class="tok-nl">SLASH_REGEX_CHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">~</span><span class="tok-p">[</span><span class="tok-o">/</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">ESCAPE_SEQ</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;\\</span><span class="tok-o">/</span><span class="tok-err">&#39;</span><span class="tok-p">;</span>

<span class="tok-nl">CARET_REGEX</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-n">CARET_REGEX_CHAR</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-sc">&#39;^&#39;</span><span class="tok-p">;</span>
<span class="tok-n">fragment</span><span class="tok-w"> </span><span class="tok-n">CARET_REGEX_CHAR</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">~[^</span><span class="tok-err">\</span><span class="tok-n">n</span><span class="tok-err">\</span><span class="tok-n">r</span><span class="tok-o">]</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-n">ESCAPE_SEQ</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-err">&#39;\\</span><span class="tok-o">^</span><span class="tok-err">&#39;</span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_rules_syntax"><a class="anchor" href="#_rules_syntax"></a>C.4. Rules Syntax</h3>
<div class="paragraph">
<p>The following grammar defines the syntax that may appear in the <code>rules</code> section of an archetype and also the assertions in Archetype slots.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">//  description: Antlr4 grammar for openEHR Rules core syntax.</span>
<span class="tok-c">//  author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">//  contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">//  support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">//  copyright:   Copyright (c) 2016- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//  license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">base_expressions</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">cadl2_primitives</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-nl">odin_values</span><span class="tok-err">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  ======================= Top-level _objects ========================</span>
<span class="tok-c">//</span>

<span class="tok-err">statement_block</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">statement</span><span class="tok-o">+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// ------------------------- statements ---------------------------</span>
<span class="tok-nl">statement</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">declaration</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">assignment</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">assertion</span><span class="tok-p">;</span>

<span class="tok-nl">declaration</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">variable_declaration</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constant_declaration</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">variable_declaration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">constant_declaration</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">constant_name</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">SYM_EQ</span><span class="tok-w"> </span><span class="tok-nv">primitive_object</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">assignment</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">binding</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">local_assignment</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// The following is the means of binding a data context path to a local variable</span>
<span class="tok-c">// TODO: remove this rule when proper external bindings are supported</span>
<span class="tok-nl">binding</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">local_assignment</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span><span class="tok-w"> </span><span class="tok-no">SYM_ASSIGNMENT</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">assertion</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// -------------------------- _expressions --------------------------</span>
<span class="tok-c">//</span>
<span class="tok-nl">expression</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// _expressions evaluating to boolean values, using standard precedence</span>
<span class="tok-c">// The equality_binop ones are not strictly necessary, but allow the use</span>
<span class="tok-c">// of boolean_leaf = true, which some people like</span>
<span class="tok-c">//</span>
<span class="tok-nl">boolean_expr</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_NOT</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_AND</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_XOR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_OR</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-no">SYM_IMPLIES</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span><span class="tok-w"> </span><span class="tok-nv">equality_binop</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_leaf</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Atomic Boolean-valued expression elements</span>
<span class="tok-c">// TODO: SYM_EXISTS alternative to be replaced by defined() predicate</span>
<span class="tok-nl">boolean_leaf</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">boolean_literal</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">for_all_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">there_exists_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_EXISTS</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">sub_path_local_variable</span><span class="tok-w"> </span><span class="tok-o">)</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">relational_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">equality_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constraint_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_literal</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_TRUE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">//  Universal and existential quantifier</span>
<span class="tok-c">// TODO: &#39;in&#39; probably isn&#39;t needed in the long term</span>
<span class="tok-nl">for_all_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_FOR_ALL</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;in&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">there_exists_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_THERE_EXISTS</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;:&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;in&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">boolean_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// Constraint expressions</span>
<span class="tok-c">// This provides a way of using one operator (matches) to compare a</span>
<span class="tok-c">// value (LHS) with a value range (RHS). As per ADL, the value range</span>
<span class="tok-c">// for ordered types like Integer, Date etc may be a single value,</span>
<span class="tok-c">// a list of values, or a list of intervals, and in future, potentially</span>
<span class="tok-c">// other comparators, including functions (e.g. divisible_by_N).</span>
<span class="tok-c">//</span>
<span class="tok-c">// For non-ordered types like String and Terminology_code, the RHS</span>
<span class="tok-c">// is in other forms, e.g. regex for Strings.</span>
<span class="tok-c">//</span>
<span class="tok-c">// The matches operator can be used to generate a Boolean value that</span>
<span class="tok-c">// may be used within an expression like any other Boolean (hence it</span>
<span class="tok-c">// is a booleanLeaf).</span>
<span class="tok-c">// TODO: non-primitive objects might be supported on the RHS in future.</span>
<span class="tok-nl">constraint_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-no">SYM_MATCHES</span><span class="tok-w">  </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;{&#39;</span><span class="tok-w"> </span><span class="tok-nv">c_inline_primitive_object</span><span class="tok-w"> </span><span class="tok-s1">&#39;}&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">CONTAINED_REGEXP</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// _expressions evaluating to arithmetic values, using standard precedence</span>
<span class="tok-c">//</span>
<span class="tok-nl">arithmetic_expr</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-err">&lt;</span><span class="tok-nv">assoc</span><span class="tok-o">=</span><span class="tok-nv">right</span><span class="tok-err">&gt;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;^&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;*&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;%&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_leaf</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">arithmetic_leaf</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">value_ref</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Equality expression between any arithmetic value; precedence is</span>
<span class="tok-c">// lowest, so only needed between leaves, since () will be needed for</span>
<span class="tok-c">// larger expressions anyway</span>
<span class="tok-c">//</span>
<span class="tok-nl">equality_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">equality_binop</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">equality_binop</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_EQ</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_NE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// Relational expressions of arithmetic operands generating Boolean values</span>
<span class="tok-c">//</span>
<span class="tok-nl">relational_expr</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-nv">relational_binop</span><span class="tok-w"> </span><span class="tok-nv">arithmetic_expr</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">relational_binop</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-no">SYM_GT</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-c">//</span>
<span class="tok-c">// instances references: data references, variables, and function calls.</span>
<span class="tok-c">// TODO: Remove bound_path from this rule when external binding supported</span>
<span class="tok-c">//</span>
<span class="tok-nl">value_ref</span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">function_call</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">bound_path</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">sub_path_local_variable</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">local_variable</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">constant_name</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">local_variable</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-c">// TODO: change to [] form, e.g.     book_list [{title.contains(&quot;Quixote&quot;)}]</span>
<span class="tok-nl">sub_path_local_variable</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">VARIABLE_WITH_PATH</span><span class="tok-p">;</span>

<span class="tok-c">// TODO: Remove this rule when external binding supported</span>
<span class="tok-nl">bound_path</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">constant_name</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">function_call</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">function_args</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">function_args</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">expression</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">type_id</span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">type_id</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_odin_structures"><a class="anchor" href="#_odin_structures"></a>C.5. ODIN structures</h3>
<div class="paragraph">
<p>The following grammar defines the syntax for ODIN structures.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// description: Antlr4 grammar for Object Data Instance Notation (ODIN)</span>
<span class="tok-c">// author:      Thomas Beale &lt;thomas.beale@openehr.org&gt;</span>
<span class="tok-c">// contributors:Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">// support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">// copyright:   Copyright (c) 2015- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">// license:     Apache 2.0 License &lt;http://www.apache.org/licenses/LICENSE-2.0.html&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">odin</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">odin_values;</span>

<span class="tok-c">//</span>
<span class="tok-c">// -------------------------- Parse Rules --------------------------</span>
<span class="tok-c">//</span>

<span class="tok-err">odin_text</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">attr_vals</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">object_value_block</span>
<span class="tok-w">	</span><span class="tok-p">;</span>

<span class="tok-nl">attr_vals</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">attr_val</span><span class="tok-w"> </span><span class="tok-s1">&#39;;&#39;</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">attr_val</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">odin_object_key</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">object_block</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">odin_object_key</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UNDERSCORE_ID</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">rm_attribute_id</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">object_block</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">object_value_block</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">object_reference_block</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">object_value_block</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;(&#39;</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;)&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-nv">primitive_object</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">attr_vals</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">keyed_object</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">EMBEDDED_URI</span><span class="tok-p">;</span>

<span class="tok-nl">keyed_object</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;[&#39;</span><span class="tok-w"> </span><span class="tok-nv">key_id</span><span class="tok-w"> </span><span class="tok-s1">&#39;]&#39;</span><span class="tok-w"> </span><span class="tok-s1">&#39;=&#39;</span><span class="tok-w"> </span><span class="tok-nv">object_block</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">key_id</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">string_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">object_reference_block</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">odin_path_list</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">odin_path_list</span><span class="tok-w">  </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">odin_path</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">odin_path</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">odin_path</span><span class="tok-w">       </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-s1">&#39;/&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">ADL_PATH</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">rm_type_id</span><span class="tok-w">      </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_UC_ID</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;&lt;&#39;</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">rm_type_id</span><span class="tok-w"> </span><span class="tok-o">)*</span><span class="tok-w"> </span><span class="tok-s1">&#39;&gt;&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">rm_attribute_id</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ALPHA_LC_ID</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_odin_value_types"><a class="anchor" href="#_odin_value_types"></a>C.6. ODIN value types</h3>
<div class="paragraph">
<p>The following grammar defines the syntax for the terminal types in ADL, which are derived from ODIN.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-c">//</span>
<span class="tok-c">// grammar defining ODIN terminal value types, including atoms, lists and intervals</span>
<span class="tok-c">// author:      Pieter Bos &lt;pieter.bos@nedap.com&gt;</span>
<span class="tok-c">// support:     openEHR Specifications PR tracker &lt;https://openehr.atlassian.net/projects/SPECPR/issues&gt;</span>
<span class="tok-c">// copyright:   Copyright (c) 2018- openEHR Foundation &lt;http://www.openEHR.org&gt;</span>
<span class="tok-c">//</span>

<span class="tok-k">grammar</span><span class="tok-w"> </span><span class="tok-nc">odin_values</span><span class="tok-p">;</span>
<span class="tok-nl">import</span><span class="tok-w"> </span><span class="tok-err">base_lexer;</span>

<span class="tok-c">//</span>
<span class="tok-c">// ========================= Parser ============================</span>
<span class="tok-c">//</span>

<span class="tok-err">primitive_object</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">primitive_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">primitive_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">primitive_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">string_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">string_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">integer_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">boolean_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">character_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">term_code_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_list_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_list_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">primitive_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-nv">integer_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span>
<span class="tok-w">    </span><span class="tok-p">;</span>

<span class="tok-nl">string_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">STRING</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">string_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">string_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">integer_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-no">INTEGER</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">integer_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">integer_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">integer_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">integer_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">integer_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">real_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;+&#39;</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;-&#39;</span><span class="tok-w"> </span><span class="tok-o">)?</span><span class="tok-w"> </span><span class="tok-no">REAL</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">real_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">real_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">real_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">real_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">real_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">boolean_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_TRUE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_FALSE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">boolean_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">boolean_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">character_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">CHARACTER</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">character_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">character_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">date_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DATE</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">date_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">time_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_TIME</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">time_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">time_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">time_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">time_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">date_time_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DATE_TIME</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">date_time_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">date_time_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">duration_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">ISO8601_DURATION</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">duration_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">duration_interval_value</span><span class="tok-w"> </span><span class="tok-p">:</span>
<span class="tok-w">      </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;..&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">relop</span><span class="tok-o">?</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-no">SYM_PLUS_OR_MINUS</span><span class="tok-w"> </span><span class="tok-nv">duration_value</span><span class="tok-w"> </span><span class="tok-s1">&#39;|&#39;</span>
<span class="tok-w">    </span><span class="tok-p">;</span>
<span class="tok-nl">duration_interval_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">duration_interval_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">term_code_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">TERM_CODE_REF</span><span class="tok-w"> </span><span class="tok-p">;</span>
<span class="tok-nl">term_code_list_value</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-o">(</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-nv">term_code_value</span><span class="tok-w"> </span><span class="tok-o">)+</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-s1">&#39;,&#39;</span><span class="tok-w"> </span><span class="tok-no">SYM_LIST_CONTINUE</span><span class="tok-w"> </span><span class="tok-o">)</span><span class="tok-w"> </span><span class="tok-p">;</span>

<span class="tok-nl">relop</span><span class="tok-w"> </span><span class="tok-p">:</span><span class="tok-w"> </span><span class="tok-no">SYM_GT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LT</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_LE</span><span class="tok-w"> </span><span class="tok-o">|</span><span class="tok-w"> </span><span class="tok-no">SYM_GE</span><span class="tok-w"> </span><span class="tok-p">;</span></code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_base_lexer"><a class="anchor" href="#_base_lexer"></a>C.7. Base Lexer</h3>
<div class="paragraph">
<p>The following grammar defines common lexical entities.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="antlr-java"><span></span><span class="tok-nl">Unresolved</span><span class="tok-w"> </span><span class="tok-err">directive</span><span class="tok-w"> </span><span class="tok-err">in</span><span class="tok-w"> </span><span class="tok-err">masterAppC-syntax_spec.adoc</span><span class="tok-w"> </span><span class="tok-err">-</span><span class="tok-w"> </span><span class="tok-err">include</span><span class="tok-p">::</span><span class="tok-err">/</span><span class="tok-nv">root</span><span class="tok-err">/</span><span class="tok-nv">openEHR</span><span class="tok-err">-</span><span class="tok-nv">specifications</span><span class="tok-err">/</span><span class="tok-nv">adl</span><span class="tok-err">-</span><span class="tok-nv">antlr</span><span class="tok-err">/</span><span class="tok-nv">src</span><span class="tok-err">/</span><span class="tok-nv">main</span><span class="tok-err">/</span><span class="tok-nv">antlr</span><span class="tok-c">//adl/base_lexer.g4[]</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_references"><a class="anchor" href="#_references"></a>References</h2>
<div class="sectionbody">
<div class="paragraph">
<p><a id="Beale2000"></a>Beale, T. (2000). Archetypes: Constraint-based Domain Models for Future-proof Information Systems. Retrieved from <a href="https://www.openehr.org/publications/archetypes/archetypes_beale_web_2000.pdf" class="bare">https://www.openehr.org/publications/archetypes/archetypes_beale_web_2000.pdf</a></p>
</div>
<div class="paragraph">
<p><a id="Beale2002"></a>Beale, T. (2002). Archetypes: Constraint-based Domain Models for Future-proof Information Systems. In K. Baclawski &amp; H. Kilov (Eds.), <em>Eleventh OOPSLA Workshop on Behavioral Semantics: Serving the Customer</em> (pp. 16–32). Northeastern University, Boston. Retrieved from <a href="https://www.openehr.org/publications/archetypes/archetypes_beale_oopsla_2002.pdf" class="bare">https://www.openehr.org/publications/archetypes/archetypes_beale_oopsla_2002.pdf</a></p>
</div>
<div class="paragraph">
<p><a id="Beale2003"></a>Beale, T. (2003). Review of OCL 2.0. Retrieved from <a href="https://wolandscat.net/review-of-ocl-2-0" class="bare">https://wolandscat.net/review-of-ocl-2-0</a></p>
</div>
<div class="paragraph">
<p><a id="GeHR_AUS"></a>Beale, T., &amp; Heard, S. (2000). <em>The Good Electronic Health Record (GeHR) (Australia)</em>. Australia: GEHR Foundation. Retrieved from <a href="https://www.openehr.org/resources/related_projects" class="bare">https://www.openehr.org/resources/related_projects</a></p>
</div>
<div class="paragraph">
<p><a id="Genesereth_Fikes_Gruber1992"></a>Genesereth, M. R., Fikes, R. E., &amp; Gruber, T. R. (1992). Knowledge Interchange Format Version 3.0 Reference Manual.</p>
</div>
<div class="paragraph">
<p><a id="Hein2002"></a>Hein, J. L. (2002). <em>Discrete Structures, Logic and Computability</em> (Second.). Jones and Bartlett.</p>
</div>
<div class="paragraph">
<p><a id="Kilov1994"></a>Kilov, H., &amp; Ross, J. (1994). <em>Information Modelling - an object-oriented approach</em>. Prentice Hall.</p>
</div>
<div class="paragraph">
<p><a id="Martin2003"></a>Martin, P. (2003). <em>Translations between UML, OWL, KIF and the WebKB-2 languages (For-Taxonomy, Frame-CG, Formalized English)</em>. Retrieved from <a href="http://www.webkb.org/doc/model/comparisons.html" class="bare">http://www.webkb.org/doc/model/comparisons.html</a></p>
</div>
<div class="paragraph">
<p><a id="Eiffel"></a>Meyer, B. (1992). <em>Eiffel the Language</em> (Second.). Prentice Hall.</p>
</div>
<div class="paragraph">
<p><a id="Object_Z"></a>Smith, G. (2000). <em>The Object Z Specification Language</em>. Kluwer Academic Publishers. Retrieved from <a href="http://www.itee.uq.edu.au/ smith/objectz.html" class="bare">http://www.itee.uq.edu.au/ smith/objectz.html</a></p>
</div>
<div class="paragraph">
<p><a id="Sowa2000"></a>Sowa, J. F. (2000). <em>Knowledge Representation: Logical, philosophical and Computational Foundations</em>. California: Brooks/Cole.</p>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2024-02-19 14:36:30 UTC
</div>
</div>
</body>
</html>